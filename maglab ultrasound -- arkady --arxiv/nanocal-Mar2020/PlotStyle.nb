(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    646238,      16070]
NotebookOptionsPosition[    645740,      16055]
NotebookOutlinePosition[    646078,      16070]
CellTagsIndexPosition[    646035,      16067]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]", "Subsection",
   FontSize->36], 
  StyleBox["\[IndentingNewLine]", "Subsection",
   FontSize->36], 
  StyleBox[
   RowBox[{
    StyleBox[
     RowBox[{"(", 
      StyleBox["*", "Subsection",
       FontSize->36]}]], 
    RowBox[{"physical", " ", "constants"}], " ", "*)"}], "Subsection",
   FontSize->36], 
  StyleBox["\[IndentingNewLine]", "Subsection",
   FontSize->36], 
  StyleBox["\[IndentingNewLine]", "Subsection",
   FontSize->36], 
  StyleBox["\[IndentingNewLine]", "Subsection",
   FontSize->36], 
  RowBox[{
   RowBox[{
    RowBox[{"muBohr", " ", "=", " ", 
     RowBox[{"5.79", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     SubscriptBox["\[Mu]", "B"], "=", 
     RowBox[{"5.79", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]], " ", 
      RowBox[{"meV", "/", "T"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muBohrJ", " ", "=", " ", "5.59"}], "  ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"J", "/", "mol"}], " ", "T"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kBoltz", " ", "=", " ", 
     RowBox[{"8.62", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     SubscriptBox["k", "B"], "=", 
     RowBox[{"8.62", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]], " ", 
      RowBox[{"meV", "/", "K"}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kBoltzJ", " ", "=", " ", "8.32"}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"J", "/", "mol"}], " ", "K"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muBdkB", " ", "=", " ", 
     RowBox[{"muBohr", "/", "kBoltz"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"color", " ", ",", " ", 
      RowBox[{"ticks", " ", "and", " ", "stuff"}]}], " ", "*)"}], "Subsection",
    FontSize->36], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"table", "[", 
      RowBox[{
       RowBox[{"list_", "?", "ArrayQ"}], ",", " ", "expr_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{"expr", ",", "list"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"acolors", "=", " ", 
     RowBox[{"<|", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[1., 0., 0.], RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               FrameStyle->RGBColor[0.6666666666666667, 0., 0.],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[1., 0., 0.]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[1., 0., 0.]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[1., 0., 0.],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.7693211457759037, 0.9329096245338091, 0.], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.5128807638506026, 0.6219397496892061, 0.],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.7693211457759037, 0.9329096245338091, 0.]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.7693211457759037, 0.9329096245338091, 0.]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.7693211457759037, 0.9329096245338091, 0.],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0., 0.9869982116273414, 0.], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               FrameStyle->RGBColor[0., 0.6579988077515609, 0.],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0., 0.9869982116273414, 0.]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0., 0.9869982116273414, 0.]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0., 0.9869982116273414, 0.],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0., 0.5290563144409309, 0.6732987560204329], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0., 0.3527042096272873, 0.4488658373469553],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0., 0.5290563144409309, 0.6732987560204329]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0., 0.5290563144409309, 0.6732987560204329]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0., 0.5290563144409309, 0.6732987560204329],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.20020578561582728`, 0., 1.], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.13347052374388485`, 0., 0.6666666666666667],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.20020578561582728, 0., 1.]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.20020578561582728`, 0., 1.]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.20020578561582728`, 0., 1.],
           Editable->False,
           Selectable->False]}], "}"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"t", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.898039, 0.105882, 0.168627], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.5986926666666668, 0.07058800000000001, 0.112418],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.898039, 0.105882, 0.168627]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.898039, 0.105882, 0.168627]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.898039, 0.105882, 0.168627],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0, 0.313725, 0.588235], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               FrameStyle->RGBColor[0., 0.20915, 0.39215666666666665`],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0, 0.313725, 0.588235]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0, 0.313725, 0.588235]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0, 0.313725, 0.588235],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.34902, 0.117647, 0.345098], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.23268, 0.07843133333333334, 0.23006533333333334`],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.34902, 0.117647, 0.345098]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.34902, 0.117647, 0.345098]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.34902, 0.117647, 0.345098],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.160784, 0.654902, 0.262745], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.10718933333333334`, 0.43660133333333334`, 
                 0.17516333333333334`],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.160784, 0.654902, 0.262745]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.160784, 0.654902, 0.262745]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.160784, 0.654902, 0.262745],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.278431, 0.282353, 0.290196], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.18562066666666666`, 0.18823533333333337`, 
                 0.19346400000000002`],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.278431, 0.282353, 0.290196]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.278431, 0.282353, 0.290196]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.278431, 0.282353, 0.290196],
           Editable->False,
           Selectable->False], ",", " ", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0, 0.611765, 0.913725], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0., 0.40784333333333334`, 0.6091500000000001],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0, 0.611765, 0.913725]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0, 0.611765, 0.913725]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0, 0.611765, 0.913725],
           Editable->False,
           Selectable->False], ",", " ", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.0784314, 0.509804, 0.211765], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.052287600000000004`, 0.33986933333333336`, 
                 0.14117666666666667`],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.0784314, 0.509804, 0.211765]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.0784314, 0.509804, 0.211765]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.0784314, 0.509804, 0.211765],
           Editable->False,
           Selectable->False], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             RowBox[{
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.792157, 0.266667, 0.0941176], 
                 RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.5281046666666667, 0.177778, 0.06274506666666667],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None], "\[InvisibleSpace]"}],
             "RGBColor[0.792157, 0.266667, 0.0941176]"],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.792157, 0.266667, 0.0941176]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.792157, 0.266667, 0.0941176],
           Editable->False,
           Selectable->False]}], "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"fieldcolorass", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"70", "\[Rule]", "  ", 
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             Frame->True,
             FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 
                1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}],
             PlotRangePadding->None],
            "RGBColor[1, 0, 0]"],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[1, 0, 0],
          Editable->False,
          Selectable->False]}], ",", "  ", 
        RowBox[{"65", "\[Rule]", " ", 
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[0., 0.46, 0.9], RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             Frame->True,
             FrameStyle->RGBColor[0., 0.3066666666666667, 0.6000000000000001],
             
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 
                1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}],
             PlotRangePadding->None],
            "RGBColor[0., 0.46, 0.9]"],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = 
               RGBColor[0., 0.46, 0.9]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[0., 0.46, 0.9],
          Editable->False,
          Selectable->False]}], ",", " ", 
        RowBox[{"60", "\[Rule]", " ", 
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[0.1, 0.73, 1.], RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             Frame->True,
             
             FrameStyle->RGBColor[
              0.06666666666666668, 0.4866666666666667, 0.6666666666666667],
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 
                1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}],
             PlotRangePadding->None],
            "RGBColor[0.1, 0.73, 1.]"],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = 
               RGBColor[0.1, 0.73, 1.]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[0.1, 0.73, 1.],
          Editable->False,
          Selectable->False]}], ",", " ", 
        RowBox[{"55", "\[Rule]", " ", 
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[0., 0.79, 0.66], RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             Frame->True,
             
             FrameStyle->RGBColor[
              0., 0.5266666666666667, 0.44000000000000006`],
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 
                1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}],
             PlotRangePadding->None],
            "RGBColor[0., 0.79, 0.66]"],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = 
               RGBColor[0., 0.79, 0.66]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[0., 0.79, 0.66],
          Editable->False,
          Selectable->False]}], ",", " ", 
        RowBox[{"50", "\[Rule]", " ", 
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[1., 0.7000000000000001, 0.17], 
               RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             Frame->True,
             
             FrameStyle->RGBColor[
              0.6666666666666667, 0.46666666666666673`, 0.11333333333333334`],
             
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 
                1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}],
             PlotRangePadding->None],
            "RGBColor[1., 0.7000000000000001, 0.17]"],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = 
               RGBColor[1., 0.7000000000000001, 0.17]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[1., 0.7000000000000001, 0.17],
          Editable->False,
          Selectable->False]}]}], "|>"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorinterp", "[", "ass_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"With", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ff", "=", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Keys", "[", "#", "]"}], ",", " ", 
               RowBox[{"Values", "[", "#", "]"}]}], "}"}], "&"}], "/@", " ", 
            RowBox[{"(", 
             RowBox[{"ass", " ", "//", "Normal"}], " ", ")"}]}], ")"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", " ", 
         RowBox[{"ff", ",", "#"}], "]"}]}], " ", "\[IndentingNewLine]", "]"}],
       "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setup", "[", "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"datafolder", "=", "  ", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "datafolder", "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mapto", "[", " ", "r_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Values", "[", "r", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", 
          RowBox[{
           RowBox[{"Keys", "[", "r", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"Values", "[", "r", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Values", "[", "r", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", "r", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Keys", "[", "r", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]]}]}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vcol", "[", "\[Lambda]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], "[", 
      "\[Lambda]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"table", "[", 
      RowBox[{"range_", ",", "f_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"f", ",", "range"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"alen", "[", "arr_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Dimensions", "[", "arr", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"range", "[", 
      RowBox[{"from_", ",", "to_", ",", "N_"}], "]"}], ":=", " ", 
     RowBox[{"Range", "[", " ", 
      RowBox[{"from", ",", " ", "to", ",", 
       FractionBox[
        RowBox[{"to", "-", "from"}], 
        RowBox[{"N", "-", "1"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linrange", "[", 
      RowBox[{"from_", ",", "to_", ",", "N_"}], "]"}], ":=", "  ", 
     RowBox[{"Range", "[", 
      RowBox[{"from", ",", "to", ",", 
       FractionBox[
        RowBox[{"to", "-", "from"}], "N"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logrange", "[", 
      RowBox[{"from_", ",", "to_", ",", "N_"}], "]"}], ":=", " ", 
     RowBox[{"Exp", "[", " ", 
      RowBox[{"linrange", "[", 
       RowBox[{
        RowBox[{"Log", "[", "from", "]"}], ",", 
        RowBox[{"Log", "[", "to", "]"}], ",", "N"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"invrange", "[", 
      RowBox[{"from_", ",", "to_", ",", "N_"}], "]"}], ":=", " ", 
     RowBox[{"1", "/", " ", 
      RowBox[{"linrange", "[", 
       RowBox[{
        RowBox[{"1", "/", "to"}], ",", " ", 
        RowBox[{"1", "/", "from"}], ",", "N"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lrange", "[", 
      RowBox[{"from_", ",", "to_", ",", "N_"}], "]"}], ":=", " ", 
     RowBox[{"Exp", "[", " ", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Log", "[", "from", "]"}], ",", 
        RowBox[{"Log", "[", "to", "]"}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Log", "[", "to", "]"}], "-", 
          RowBox[{"Log", "[", "from", "]"}]}], "N"]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vcolors", "[", "nn_", "]"}], ":=", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], "[", 
        "\[Lambda]", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", " ", 
         RowBox[{"invrange", "[", 
          RowBox[{"450", ",", " ", "650", ",", " ", 
           RowBox[{"nn", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange\[CenterEllipsis]int", "[", " ", 
      RowBox[{"x0_", ",", " ", "from_", ",", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xx", "=", 
         RowBox[{"Floor", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{"xx", ",", "\[IndentingNewLine]", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "<", "from"}]}], ",", " ", "from", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "to"}]}], ",", " ", "to", ",", " ", 
          "\[IndentingNewLine]", "__", ",", "xx"}], " ", 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange\[CenterEllipsis]int", "[", " ", 
      RowBox[{"from_", ",", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"inrange\[CenterEllipsis]int", "[", " ", 
       RowBox[{"#", ",", "from", ",", " ", "to"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange\[CenterEllipsis]int", "[", " ", 
      RowBox[{"from_", "\[Rule]", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"inrange\[CenterEllipsis]int", "[", " ", 
       RowBox[{"#", ",", "from", ",", " ", "to"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange", "[", " ", 
      RowBox[{"x0_", ",", " ", "from_", ",", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"x0", ",", "\[IndentingNewLine]", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", "<", "from"}]}], ",", " ", "from", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "to"}]}], ",", " ", "to", ",", " ", 
         "\[IndentingNewLine]", "__", ",", "x0"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange", "[", " ", 
      RowBox[{"from_", ",", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"inrange", "[", " ", 
       RowBox[{"#", ",", "from", ",", " ", "to"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inrange", "[", " ", 
      RowBox[{"from_", "\[Rule]", " ", "to_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"inrange", "[", " ", 
       RowBox[{"#", ",", "from", ",", " ", "to"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "strings", " ", "*)"}], "Subsection",
    FontSize->36], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"<<", "ToMatlabString"}], ".", "m"}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Example", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<H0= \>\"", "<>", " ", 
        RowBox[{"ToMatlab", "[", "H0", "]"}], "<>", "\[IndentingNewLine]", 
        "\"\<\\n...daH= \>\"", "<>", 
        RowBox[{"ToMatlab", "[", "d\[Alpha]H", "]"}], "<>", 
        "\[IndentingNewLine]", "\"\<\\n...dadaH= \>\"", "<>", 
        RowBox[{"ToMatlab", "[", "d\[Alpha]d\[Alpha]H", "]"}]}]}]}], "     ", 
     "//", " ", "fixToMatlab"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "*)"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fixToMatlab", "[", "str_", "]"}], ":=", " ", 
     RowBox[{"StringReplace", "[", " ", 
      RowBox[{"str", ",", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<sqrt(-1)\>\"", ".."}], "\[Rule]", " ", "\"\<i\>\""}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<0.E-323\>\"", ".."}], "\[Rule]", " ", "\"\<0\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<0.2E1\>\"", "\[Rule]", "\"\<2\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<0.1E1\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<b1\>\"", "\[Rule]", " ", "\"\<b(1)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<b2\>\"", "\[Rule]", " ", "\"\<b(2)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<b3\>\"", "\[Rule]", " ", "\"\<b(3)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<g1\>\"", "\[Rule]", " ", "\"\<g(1)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<g2\>\"", "\[Rule]", " ", "\"\<g(2)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<g3\>\"", "\[Rule]", " ", "\"\<g(3)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<G1\>\"", "\[Rule]", " ", "\"\<G(1)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<G2\>\"", "\[Rule]", " ", "\"\<G(2)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<G3\>\"", "\[Rule]", " ", "\"\<G(3)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<n1\>\"", "\[Rule]", " ", "\"\<n(1)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<n2\>\"", "\[Rule]", " ", "\"\<n(2)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<n3\>\"", "\[Rule]", " ", "\"\<n(3)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<jj0\>\"", "\[Rule]", " ", "\"\<jj(1)\>\""}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<jj1\>\"", "\[Rule]", " ", "\"\<jj(2)\>\""}], ",", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<.^\>\"", "\[Rule]", "\"\<^\>\""}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "}"}]}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"floor", "[", "x_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Floor", "[", 
       RowBox[{"#", ",", "x"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"floor", "[", "]"}], ":=", " ", 
     RowBox[{"floor", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importtextfile", "[", 
      RowBox[{"name_", ",", " ", "opts_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "optslocal", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"optslocal", "=", " ", 
         RowBox[{"<|", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<headerlines\>\"", "\[Rule]", " ", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<separator\>\"", "\[Rule]", "  ", 
            RowBox[{"RegularExpression", "[", "\"\<[; \\t]+\>\"", "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<lineseparator\>\"", "\[Rule]", " ", 
            RowBox[{"RegularExpression", "[", "\"\<[\\n\\r]+\>\"", "]"}]}], 
           ",", " ", "\[IndentingNewLine]", 
           RowBox[{"\"\<cols\>\"", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
          "|>"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"optslocal", "[", "#", "]"}], "=", 
            RowBox[{"opts", "[", "#", "]"}]}], ")"}], "&"}], " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"opts", "//", "Keys"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", 
              RowBox[{"optslocal", "[", "\"\<separator\>\"", "]"}]}], "]"}], "//",
             "ToExpression"}], ")"}], "&"}], "   ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Import", "[", "name", "]"}], "//", 
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{"#", ",", " ", 
                RowBox[{"optslocal", "[", "\"\<lineseparator\>\"", "]"}]}], 
               "]"}], "&"}]}], " ", ")"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"optslocal", "[", "\"\<headerlines\>\"", "]"}], ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importtextfile", "[", "name_", "]"}], ":=", 
     RowBox[{"importtextfile", "[", 
      RowBox[{"name", ",", " ", 
       RowBox[{"<|", " ", "|>"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tostr", "[", "s_", " ", "]"}], " ", ":=", " ", 
     RowBox[{"ToString", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"strtrim", " ", "[", " ", "pat_", " ", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"StringTrim", "[", " ", 
       RowBox[{"#", ",", " ", "pat"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"strrep", "[", 
      RowBox[{
       RowBox[{"str_", "?", "StringQ"}], ",", " ", 
       RowBox[{"pat_", "?", "StringQ"}], ",", " ", 
       RowBox[{"rep_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{"StringReplace", "[", " ", 
      RowBox[{"str", ",", " ", 
       RowBox[{
        RowBox[{"RegularExpression", "[", "pat", "]"}], "\[Rule]", " ", 
        "rep"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"strrep", "[", " ", 
      RowBox[{"pat_", ",", " ", "rep_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"strrep", "[", 
       RowBox[{"#", ",", " ", "pat", ",", " ", "rep"}], "]"}], "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"strrep", "[", " ", 
      RowBox[{"pat_", "\[Rule]", "  ", "rep_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"strrep", "[", 
       RowBox[{"#", ",", " ", "pat", ",", " ", "rep"}], "]"}], "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trimsuffix", "[", 
      RowBox[{
       RowBox[{"str_:", "StringQ"}], ",", " ", 
       RowBox[{"suffix_:", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "//", 
        RowBox[{"StringMatchQ", "[", " ", 
         RowBox[{"RegularExpression", "[", 
          RowBox[{"\"\<.+?\>\"", "<>", "suffix", "<>", "\"\<$\>\""}], "]"}], 
         "]"}]}], " ", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"str", "//", 
        RowBox[{"StringReplace", "[", " ", 
         RowBox[{
          RowBox[{"RegularExpression", "[", 
           RowBox[{"\"\<(.+?)\>\"", "<>", "suffix", "<>", "\"\<$\>\""}], 
           "]"}], "\[Rule]", " ", "\"\<$1\>\""}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", "str"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trimsuffix", "[", " ", 
      RowBox[{"suffix_:", "StringQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"trimsuffix", "[", 
       RowBox[{"#", ",", " ", "suffix"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"enssuffix", "[", " ", 
      RowBox[{"suffix_:", "StringQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"trimsuffix", "[", 
        RowBox[{"#", ",", " ", "suffix"}], "]"}], "<>", " ", 
       RowBox[{"StringDelete", "[", 
        RowBox[{"suffix", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<[\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<]\>\""}], " ", 
          "}"}]}], " ", "]"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trimprefix", "[", 
      RowBox[{
       RowBox[{"str_:", "StringQ"}], ",", " ", 
       RowBox[{"prefix_:", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "//", 
        RowBox[{"StringMatchQ", "[", " ", 
         RowBox[{"RegularExpression", "[", 
          RowBox[{"\"\<^\>\"", "<>", "prefix", "<>", "\"\<.+\>\""}], "]"}], 
         "]"}]}], " ", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"str", "//", 
        RowBox[{"StringReplace", "[", " ", 
         RowBox[{
          RowBox[{"RegularExpression", "[", 
           RowBox[{"\"\<^\>\"", "<>", "prefix", "<>", "\"\<(.+)\>\""}], "]"}],
           "\[Rule]", " ", "\"\<$1\>\""}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", "str"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trimprefix", "[", " ", 
      RowBox[{"prefix_:", "StringQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"trimprefix", "[", 
       RowBox[{"#", ",", " ", "prefix"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fnameappend", " ", "[", 
      RowBox[{
       RowBox[{"name1_:", "StringQ"}], ",", " ", 
       RowBox[{"name2_:", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"name1", " ", "//", 
        RowBox[{"trimsuffix", "[", "\"\</+\>\"", "]"}]}], ")"}], "<>", 
      "\"\</\>\"", " ", "<>", 
      RowBox[{"(", 
       RowBox[{"name2", "//", 
        RowBox[{"trimprefix", "[", "\"\</+\>\"", "]"}]}], ")"}]}]}], " ", 
    ";"}], "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fnameappend", " ", "[", 
      RowBox[{"name_:", "StringQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"fnameappend", "[", 
       RowBox[{"#", " ", ",", " ", "name"}], "]"}], " ", "&"}]}], ";"}], "  ",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"indices", "[", "arr_", "]"}], ":=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"Length", "[", "arr", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"joinpath", "[", " ", 
      RowBox[{"parts_", "?", "ArrayQ"}], " ", "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\</\>\"", "<>", 
          RowBox[{"(", 
           RowBox[{"#", "//", 
            RowBox[{"strtrim", "[", "\"\</\>\"", "]"}]}], ")"}]}], " ", ")"}],
         "&"}], "/@", " ", "parts"}], " ", "//", "StringJoin"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"joinpath", "[", " ", 
      RowBox[{
       RowBox[{"part1_", "?", "StringQ"}], ",", " ", 
       RowBox[{"part2_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{"joinpath", "[", 
      RowBox[{"{", 
       RowBox[{"part1", ",", "part2"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expo", "[", 
      RowBox[{"folder_", ",", " ", "name_", " ", ",", " ", "obj_"}], " ", 
      "]"}], ":=", " ", 
     RowBox[{"Export", "[", " ", 
      RowBox[{
       RowBox[{"joinpath", "[", 
        RowBox[{"folder", ",", "name"}], "]"}], ",", " ", "obj"}], "]"}]}], 
    ";"}], "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expo", "[", "folder_", " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"expo", "[", 
       RowBox[{"folder", ",", " ", "\"\<aaa.pdf\>\"", ",", " ", "#"}], " ", 
       "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expo", "[", 
      RowBox[{"folder_", ",", " ", "name_"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"expo", "[", 
       RowBox[{"folder", ",", " ", "name", ",", " ", "#"}], " ", "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"datafile", " ", "syntactic", " ", "sugar"}], " ", "*)"}], 
    "Subsection"], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"datafilename", "[", "str_", " ", "]"}], ":=", " ", 
     RowBox[{"datafolder", "//", 
      RowBox[{"fnameappend", "[", " ", 
       RowBox[{"str", "//", 
        RowBox[{"enssuffix", "[", "\"\<[\\.]dat\>\"", "]"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importdata", "[", 
      RowBox[{"name_", ",", " ", "nn_"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"datafilename", "[", "name", "]"}], ",", " ", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"nn", ";;", 
         RowBox[{"-", "1"}]}], ",", "All"}], "]"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importdata", "[", "name_", "]"}], ":=", "  ", 
     RowBox[{"importdata", "[", 
      RowBox[{"name", ",", " ", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"topdf", "[", 
      RowBox[{
       RowBox[{"name_", "?", "StringQ"}], ",", "what_"}], "]"}], ":=", "  ", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"datafolder", "<>", "name"}], ",", "what", ",", "\"\<PDF\>\"", 
       ",", " ", 
       RowBox[{"\"\<AllowRasterization\>\"", "\[Rule]", " ", "Automatic"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"topdf", "[", 
      RowBox[{"name_", "?", "StringQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"topdf", "[", 
       RowBox[{"name", ",", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[CenterEllipsis]show\[CenterEllipsis]default\[CenterEllipsis]options", 
     "=", " ", 
     RowBox[{"{", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"show", "[", "opts__", " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
           "opts", ",", " ", 
            "\[CenterEllipsis]show\[CenterEllipsis]default\[CenterEllipsis]\
options"}], "}"}], "]"}]}]}], " ", "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matr", ":=", " ", 
     RowBox[{
      RowBox[{"MatrixForm", "[", "#", "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"poor\[CenterEllipsis]man\[CenterEllipsis]legend", "[", " ", 
      RowBox[{"arr_", ",", "  ", "argopts_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"opts", ",", "ycoord"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opts", " ", "=", " ", 
         RowBox[{"<|", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<font\>\"", "\[Rule]", " ", "\"\<Menlo\>\""}], ",", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"\"\<fontsize\>\"", "\[Rule]", "13"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<colorbounds\>\"", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "200"}], "}"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<colorfunc\>\"", "\[Rule]", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"colorrange", "[", 
                RowBox[{"colors", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "200"}], "}"}]}], " ", "]"}], "[", "#", 
               "]"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<textfunc\>\"", "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"#", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<title\>\"", "\[Rule]", "\"\< \>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<titleoffset\>\"", "\[Rule]", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<titlexoffset\>\"", "\[Rule]", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<titlecolor\>\"", "\[Rule]", " ", 
            InterpretationBox[
             ButtonBox[
              TooltipBox[
               GraphicsBox[{
                 {GrayLevel[0], RectangleBox[{0, 0}]}, 
                 {GrayLevel[0], RectangleBox[{1, -1}]}, 
                 {GrayLevel[0], RectangleBox[{0, -1}, {2, 1}]}},
                AspectRatio->1,
                Frame->True,
                FrameStyle->GrayLevel[0.],
                FrameTicks->None,
                
                ImageSize->
                 Dynamic[{
                  Automatic, 
                   1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                PlotRangePadding->None],
               "GrayLevel[0]"],
              Appearance->None,
              BaseStyle->{},
              BaselinePosition->Baseline,
              ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                If[
                 Not[
                  AbsoluteCurrentValue["Deployed"]], 
                 SelectionMove[Typeset`box$, All, Expression]; 
                 FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                 FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[0]; 
                 FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                 MathLink`CallFrontEnd[
                   FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
              DefaultBaseStyle->{},
              Evaluator->Automatic,
              Method->"Preemptive"],
             GrayLevel[0],
             Editable->False,
             Selectable->False]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<xx\>\"", "\[Rule]", "55"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<yy\>\"", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"5", ",", "35"}], "}"}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<prefix\>\"", "\[Rule]", " ", "\"\<\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<suffix\>\"", "\[Rule]", " ", "\"\<\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<spacing\>\"", "\[Rule]", " ", "\"\<propo\>\""}]}], 
          " ", 
          RowBox[{"(*", " ", "\"\<equal\>\"", " ", "*)"}], " ", 
          "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"opts", "[", "#", "]"}], "=", " ", 
            RowBox[{"argopts", "[", "#", "]"}]}], ")"}], "&"}], "/@", " ", 
         RowBox[{"Keys", "[", "argopts", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"ycoord", " ", "=", " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"StringQ", "[", 
            RowBox[{"opts", "[", "\"\<spacing\>\"", "]"}], "]"}], ",", " ", 
           "\[IndentingNewLine]", "  ", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"opts", "[", "\"\<spacing\>\"", "]"}], "\[Equal]", 
              "\"\<propo\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{"torange", "[", 
              RowBox[{"\"\<propo\>\"", ",", 
               RowBox[{
                RowBox[{"opts", "[", "\"\<yy\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"opts", "[", "\"\<yy\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "arr"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"torange", "[", 
              RowBox[{"\"\<equal\>\"", ",", 
               RowBox[{
                RowBox[{"opts", "[", "\"\<yy\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"opts", "[", "\"\<yy\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "arr"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"opts", "[", "\"\<spacing\>\"", "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Text", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"opts", "[", "\"\<title\>\"", "]"}], " ", "//", 
               RowBox[{"chai", "[", "\[IndentingNewLine]", 
                RowBox[{"<|", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<fontsize\>\"", "\[Rule]", " ", 
                   RowBox[{"opts", "[", "\"\<fontsize\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<font\>\"", "\[Rule]", " ", 
                   RowBox[{"opts", "[", "\"\<font\>\"", "]"}]}], " ", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<color\>\"", "\[Rule]", " ", 
                   RowBox[{"opts", "[", "\"\<titlecolor\>\"", "]"}]}]}], 
                 "\[IndentingNewLine]", "|>"}], "\[IndentingNewLine]", 
                "]"}]}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"opts", "[", "\"\<xx\>\"", "]"}], "+", 
                 RowBox[{"opts", "[", "\"\<titlexoffset\>\"", "]"}]}], ",", 
                " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"opts", "[", "\"\<yy\>\"", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"opts", "[", "\"\<titleoffset\>\"", "]"}]}]}], 
               "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"opts", "[", "\"\<prefix\>\"", "]"}], "<>", 
                  RowBox[{"ToString", "[", " ", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"opts", "[", "\"\<textfunc\>\"", "]"}], ")"}], 
                    "[", "T", "]"}], ",", "4", ",", 
                    RowBox[{"NumberSigns", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<-\>\"", ",", "\"\< \>\""}], "}"}]}]}], "]"}],
                    "]"}], " ", "<>", " ", 
                  RowBox[{"opts", "[", "\"\<suffix\>\"", "]"}]}], "//", 
                 RowBox[{"chai", "[", "\[IndentingNewLine]", 
                  RowBox[{"<|", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\"\<fontsize\>\"", "\[Rule]", " ", 
                    RowBox[{"opts", "[", "\"\<fontsize\>\"", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<font\>\"", "\[Rule]", " ", 
                    RowBox[{"opts", "[", "\"\<font\>\"", "]"}]}], " ", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<color\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"opts", "[", "\"\<colorfunc\>\"", "]"}], ")"}], 
                    "[", "T", "]"}]}]}], " ", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"\"\<color\>\"", "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"colorrange", "[", 
                    RowBox[{"colors", ",", 
                    RowBox[{"opts", "[", "\"\<colorbounds\>\"", "]"}]}], " ", 
                    "]"}], "[", "T", "]"}]}], " ", "*)"}], 
                   "\[IndentingNewLine]", "|>"}], "\[IndentingNewLine]", 
                  "]"}]}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{"{", " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"opts", "[", "\"\<xx\>\"", "]"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ycoord", "[", "T", "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"T", ",", "arr"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "//", "Flatten"}], "//", 
         "Graphics"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "poor\[CenterEllipsis]man\[CenterEllipsis]legend", "[", "   ", 
      "argopts_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"poor\[CenterEllipsis]man\[CenterEllipsis]legend", "[", " ", 
       RowBox[{"#", ",", "  ", "argopts"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"With", "[", " ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"arr", "=", 
        RowBox[{
         RowBox[{"Keys", "[", "foo", "]"}], "//", "Sort"}]}], "}"}], " ", ",",
       " ", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"Text", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tee", "[", 
            RowBox[{
             RowBox[{"ToString", "[", " ", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"T", ",", "4", ",", 
                RowBox[{"NumberSigns", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<-\>\"", ",", "\"\< \>\""}], "}"}]}]}], "]"}], 
              "]"}], ",", "13", ",", 
             RowBox[{"font", "\[Rule]", " ", "\"\<Menlo\>\""}], " ", ",", 
             RowBox[{"color", "\[Rule]", " ", 
              RowBox[{
               RowBox[{"colorrange", "[", 
                RowBox[{"colors", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "200"}], "}"}]}], "]"}], "[", "T", 
               "]"}]}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"55", ",", " ", 
             RowBox[{
              RowBox[{"torange", "[", 
               RowBox[{"5", ",", "35", ",", "arr"}], "]"}], "[", "T", "]"}]}],
             "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "arr"}], "}"}]}], "]"}], "//", "Graphics"}]}], 
     " ", "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"show", "[", " ", "opts__", " ", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"Show", "@@", 
        RowBox[{"{", 
         RowBox[{"#", ",", " ", 
          RowBox[{"Sequence", "[", "opts", "]"}]}], "}"}]}], "&"}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"show", "[", " ", 
       RowBox[{"opts_", "?", "ArrayQ"}], " ", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"Show", "@@", 
        RowBox[{"{", 
         RowBox[{"#", ",", " ", 
          RowBox[{"Sequence", "@@", "opts"}]}], "}"}]}], "&"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listplot", "[", " ", 
       RowBox[{"opts_", "?", "ArrayQ"}], " ", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"Sequence", "@@", "opts"}]}], "]"}], "&"}]}], " ", ";"}], 
    " ", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[CenterEllipsis]listplot\[CenterEllipsis]default\[CenterEllipsis]\
options", "=", " ", 
     RowBox[{"{", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PlotStyle", " ", "\[Rule]", " ", "Red"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotMarkers", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "5"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", "Thin"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"listplot", "[", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{
        "Sequence", "@@", 
         "\[CenterEllipsis]listplot\[CenterEllipsis]default\[CenterEllipsis]\
options"}]}], "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"listplot", "[", "opts__", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
           "opts", ",", " ", 
            "\[CenterEllipsis]listplot\[CenterEllipsis]default\
\[CenterEllipsis]options"}], "}"}], "]"}]}]}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"text", "[", 
      RowBox[{
       RowBox[{"str_", "?", "StringQ"}], ",", " ", 
       RowBox[{"pos_", "?", "ArrayQ"}]}], "]"}], ":=", 
     RowBox[{"Text", "[", 
      RowBox[{"str", ",", "pos"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"text", "[", " ", 
      RowBox[{"pos_", "?", "ArrayQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{"#", ",", "pos"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"text", "[", 
      RowBox[{"str_", "?", "StringQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{"str", ",", "#"}], "]"}], "&"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "Arrays", " ", "*)"}], "Subsection",
    FontSize->24], 
   StyleBox[" ", "Subsection",
    FontSize->24], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"maxind", "[", 
      RowBox[{"arr_", ",", "col_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"arr", "//", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "col"}], "]"}], "]"}], "&"}]}], "//", 
        "appendind"}], "//", " ", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"#", " ", ",", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "  ", "&"}]}], "]"}], "&"}]}], 
      " ", "//", " ", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "&"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"maxind", "[", "col_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"maxind", "[", 
       RowBox[{"#", ",", "col"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"maxind", "[", "]"}], ":=", " ", 
     RowBox[{"maxind", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"minind", "[", 
      RowBox[{"arr_", ",", "col_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"arr", "//", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "col"}], "]"}], "]"}], "&"}]}], "//", 
        "appendind"}], "//", " ", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"#", " ", ",", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "  ", "&"}]}], "]"}], "&"}]}], 
      " ", "//", " ", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", "&"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"minind", "[", "col_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"minind", "[", 
       RowBox[{"#", ",", "col"}], "]"}], "&"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"minind", "[", "]"}], ":=", " ", 
     RowBox[{"minind", "[", "1", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"falling", "[", 
      RowBox[{"arr_", ",", " ", "ind_"}], "]"}], " ", ":=", " ", 
     RowBox[{"arr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"ind", ";;", 
         RowBox[{"-", "1"}]}], ",", " ", "All"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"falling", "[", "ind_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"falling", "[", 
       RowBox[{"#", ",", " ", "ind"}], "]"}], "&"}]}], " ", ";"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "[", 
      RowBox[{"arr_", ",", " ", "ind_"}], "]"}], " ", ":=", " ", 
     RowBox[{"arr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "ind"}], ",", " ", "All"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "[", "ind_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"raising", "[", 
       RowBox[{"#", ",", " ", "ind"}], "]"}], "&"}]}], " ", ";"}], "  ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    TagBox[
     RowBox[{
      RowBox[{"rot2d", "[", "\[Alpha]_", "]"}], ":=", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]},
         {
          RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"commute", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "-", 
      RowBox[{"B", ".", "A"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A_", " ", "\[Diamond]", " ", "B_"}], " ", ":=", " ", 
     RowBox[{"commute", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"symmetrize", "[", " ", "A_", "]"}], ":=", " ", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"A", "+", 
        RowBox[{"A", "\[Transpose]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toprojector", "[", " ", "v_", "]"}], " ", ":=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"v", ",", "v"}], "]"}], "  "}], 
      RowBox[{"v", ".", "v"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toprojectorn", "[", " ", "v_", "]"}], " ", ":=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"v", ",", "v"}], "]"}]}], "  ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a_", " ", "\[Therefore]", " ", "b_"}], " ", ":=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"a", ",", "b", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", "  ", 
         RowBox[{"PauliMatrix", "[", "#", "]"}]}], "&"}], " ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{"1", "\[Therefore]", "3"}], ")"}]}], "//", "Association"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", "0", "]"}], " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0"},
        {"0", "1"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"commute", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "-", 
      RowBox[{"B", ".", "A"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Generators", " ", "of", " ", "O", 
      RowBox[{
       RowBox[{"(", "3", ")"}], "--"}], "\[IndentingNewLine]", "small", " ", 
      "rotation", " ", "by", " ", "d\[Alpha]", " ", "around", " ", "vector", 
      " ", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "\[IndentingNewLine]", 
      "dV"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"\[ImaginaryI]", " ", "d\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s1", " ", "n1"}], "+", 
           RowBox[{"s2", " ", "n2"}], "+", 
           RowBox[{"s3", " ", "n3"}]}], ")"}]}]}], " ", ")"}], "V"}]}], " ", 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"so3", " ", "=", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"so3", "[", "1", "]"}], " ", "=", " ", 
     TagBox[
      RowBox[{"\[ImaginaryI]", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", 
           RowBox[{"-", "1"}]},
          {"0", "1", "0"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], "\[NoBreak]", ")"}]}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";", " ", 
    RowBox[{
     RowBox[{"so3", "[", "2", "]"}], "=", " ", 
     RowBox[{"\[ImaginaryI]", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "1"},
          {"0", "0", "0"},
          {
           RowBox[{"-", "1"}], "0", "0"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], ";", " ", 
    RowBox[{
     RowBox[{"so3", "[", "3", "]"}], "=", " ", 
     RowBox[{"\[ImaginaryI]", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", 
          RowBox[{"-", "1"}], "0"},
         {"1", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]su3", "=", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "1", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "1", "0"},
        {"1", "0", "0"},
        {"0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "2", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", 
         RowBox[{"-", "\[ImaginaryI]"}], "0"},
        {"\[ImaginaryI]", "0", "0"},
        {"0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "3", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0"},
        {"0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "4", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "1"},
        {"0", "0", "0"},
        {"1", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "5", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", "0"},
        {"\[ImaginaryI]", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "6", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0"},
        {"0", "0", "1"},
        {"0", "1", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "7", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0"},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "\[ImaginaryI]", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", " ", 
    RowBox[{
     RowBox[{"\[Lambda]su3", "[", "8", "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["3"]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", 
          RowBox[{"-", "2"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Gell", "-", 
      RowBox[{"Mann", " ", "matrices", " ", "for", " ", "SU", 
       RowBox[{
        RowBox[{"(", "4", ")"}], " ", "--"}], " ", "ignore"}]}], "Subsection"], 
    StyleBox[" ", "Subsection"], 
    StyleBox["*)", "Subsection"]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]su4", "=", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "1", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "1", "0", "0"},
        {"1", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "2", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", 
         RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
        {"\[ImaginaryI]", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "3", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "0"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "4", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "1", "0"},
        {"0", "0", "0", "0"},
        {"1", "0", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "5", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "0"},
        {"0", "0", "0", "0"},
        {"\[ImaginaryI]", "0", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "6", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", "1", "0"},
        {"0", "1", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "7", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "0"},
        {"0", "\[ImaginaryI]", "0", "0"},
        {"0", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", " ", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "8", "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["3"]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", 
          RowBox[{"-", "2"}], "0"},
         {"0", "0", "0", "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "9", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "1"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"1", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "10", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"\[ImaginaryI]", "0", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "11", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", "0", "1"},
        {"0", "0", "0", "0"},
        {"0", "1", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "12", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", "0", "0"},
        {"0", "\[ImaginaryI]", "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "13", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", "1"},
        {"0", "0", "1", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "14", "]"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0"},
        {"0", "0", "0", "0"},
        {"0", "0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", "\[ImaginaryI]", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";", " ", 
    RowBox[{
     RowBox[{"\[Lambda]su4", "[", "15", "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["6"]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0"},
         {"0", "1", "0", "0"},
         {"0", "0", "1", "0"},
         {"0", "0", "0", 
          RowBox[{"-", "3"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "n"], 
      RowBox[{"(", "\[Alpha]", ")"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]", " ", 
          RowBox[{"S", ".", "n"}]}]], "       ", "\[IndentingNewLine]", 
        "rotate", " ", "by", " ", "\[Alpha]", " ", "counterclockwize", " ", 
        "around", " ", "the", " ", "unit", " ", "vector", " ", "in", " ", 
        "the", " ", "direction", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "v\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "v\[Phi]", "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "v\[Theta]", "]"}], 
           RowBox[{"Sin", "[", "v\[Phi]", "]"}]}], ",", " ", 
          RowBox[{"Cos", "[", "v\[Theta]", "]"}]}], "}"}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "run", " ", "this", " ",
         "to", " ", 
        RowBox[{
        "generate", " ", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         " ", 
         RowBox[{"MatrixExp", "[", " ", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s1", " ", "n1"}], " ", "+", 
             RowBox[{"s2", " ", "n2"}], "+", 
             RowBox[{"s3", " ", "n3"}]}], ")"}]}], "]"}]}]}], " ", "/.", " ", 
       
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"n1", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]n", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]n", "]"}]}]}], ",", " ", 
         RowBox[{"n2", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]n", "]"}], 
           RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}], ",", " ", 
         RowBox[{"n3", "\[Rule]", " ", 
          RowBox[{"Cos", "[", "\[Theta]n", "]"}]}]}], "}"}]}], "   ", "//", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"Assumptions", "\[Rule]", 
          RowBox[{"\[Alpha]", ">", "0"}]}]}], "]"}], "&"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rotm", "[", 
       RowBox[{"\[Alpha]_", ",", "\[Theta]n_", ",", " ", "\[Phi]n_"}], "]"}], 
      ":=", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Phi]n", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]n", "]"}], "2"], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Phi]n", "]"}], "2"]}]}], ")"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]n", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Phi]n"}], "]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]n", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Theta]n"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]n", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]n", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Phi]n"}], "]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]n", "]"}], "2"], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Phi]n", "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]n", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Phi]n", "]"}], "2"]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Phi]n", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]n", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Theta]n"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]n", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Theta]n"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]n", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]n", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]n", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Theta]n"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]n", "]"}]}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              FractionBox["\[Alpha]", "2"], "]"}], "2"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Theta]n"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               FractionBox["\[Alpha]", "2"], "]"}], "2"]}]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ";"}], "  ", ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setifdoesnotexist", "[", " ", 
      RowBox[{
       RowBox[{"hash_", "?", "AssociationQ"}], ",", "key_", ",", "val_"}], 
      "]"}], ":=", " ", 
     RowBox[{"If", "[", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", " ", 
        RowBox[{"hash", ",", "key"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"hash", "[", "key", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hash", "[", "key", "]"}], "=", "val"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"setifdoesnotexist", ",", "HoldFirst"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findclosest", "[", 
      RowBox[{"arr_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "x"}], ")"}], "2"]}], 
            "}"}], "&"}], "/@", " ", 
          RowBox[{"(", 
           RowBox[{"arr", "//", " ", "appendind"}], ")"}]}], "  ", "//", " ", 
         
         RowBox[{
          RowBox[{"Sort", "[", " ", 
           RowBox[{"#", ",", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ")"}]}], "]"}], 
          "&"}]}], " ", ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findclosest2", "[", 
      RowBox[{"arr_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"arr", "[", "#", "]"}], "-", "x"}], ")"}], "2"]}], 
            "}"}], "&"}], "/@", " ", 
          RowBox[{"(", 
           RowBox[{"arr", "//", " ", "Keys"}], ")"}]}], "  ", "//", " ", 
         RowBox[{
          RowBox[{"Sort", "[", " ", 
           RowBox[{"#", ",", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ")"}]}], "]"}], 
          "&"}]}], " ", ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"position", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", 
       RowBox[{"num_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Position", "[", " ", 
         RowBox[{"arr", ",", "num"}], "]"}], "//", "Flatten"}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"position", "[", 
      RowBox[{"num_", "?", "NumericQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"position", "[", 
       RowBox[{"#", ",", "num"}], "]"}], "&"}]}], ";"}], " ", "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      StyleBox["linear", "Subsection"], 
      StyleBox[" ", "Subsection"], 
      StyleBox["regression", "Subsection"], 
      StyleBox[" ", "Subsection"], 
      StyleBox["\[IndentingNewLine]", "Subsection"], 
      RowBox[{"\[Integral]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          StyleBox["(", "Subsection"], 
          RowBox[{
           StyleBox[
            RowBox[{"y", 
             RowBox[{"(", "x", ")"}]}], "Subsection"], 
           StyleBox["-", "Subsection"], 
           StyleBox[" ", "Subsection"], 
           RowBox[{
            StyleBox[
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "n"], "Subsection"], 
            RowBox[{
             SubscriptBox[
              StyleBox["a", "Subsection"], "i"], " ", 
             SubscriptBox["f", "i"], 
             RowBox[{"(", "x", ")"}]}]}]}], ")"}], "2"], "dx"}]}]}], "  ", 
     "\[Rule]", " ", "min"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fancyregr", "[", " ", 
      RowBox[{"arr_", ",", " ", 
       RowBox[{"funcs_", "?", "ArrayQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aaa", ",", " ", "vvv", ",", " ", "nnn"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nnn", " ", "=", " ", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"aaa", " ", "=", " ", 
         RowBox[{
          FractionBox["1", "nnn"], 
          RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"funcs", "[", 
                   RowBox[{"[", "ii", "]"}], "]"}], "[", "x", "]"}], "*", 
                 RowBox[{
                  RowBox[{"funcs", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "[", "x", "]"}]}], ",", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "}"}]}], 
               " ", "]"}], ",", "\[IndentingNewLine]", " ", 
              RowBox[{"{", 
               RowBox[{"jj", ",", " ", "1", ",", " ", 
                RowBox[{"Length", "[", "funcs", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"ii", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "funcs", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vvv", " ", "=", " ", 
         RowBox[{
          FractionBox["1", "nnn"], 
          RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Sum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"funcs", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], "[", 
                RowBox[{"arr", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "*", 
               RowBox[{"arr", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "1", ",", "nnn"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{"{", 
             RowBox[{"jj", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "funcs", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Inverse", "[", "aaa", "]"}], ".", "vvv"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fancyregr", "[", " ", 
      RowBox[{"arr_", ",", " ", 
       RowBox[{"funcs_", "?", "AssociationQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "aaa", ",", " ", "ans", ",", "keys", ",", " ", "vals", ",", " ", 
         "ans1", ",", " ", "ans2", ",", " ", "err"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"keys", " ", "=", " ", 
         RowBox[{"Keys", "[", "funcs", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vals", "=", 
         RowBox[{"Values", "[", "funcs", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"ans", " ", "=", 
         RowBox[{"fancyregr", "[", 
          RowBox[{"arr", ",", " ", "vals"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ans1", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"keys", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
              RowBox[{"ans", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], " ", "/@", "  ", 
            
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"Length", "[", "keys", "]"}]}], "]"}]}], ")"}], " ", "//",
           "Association"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"err", "=", "  ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mean", "[", " ", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
                 RowBox[{"Sum", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ans", "[", 
                    RowBox[{"[", "nn", "]"}], "]"}], " ", 
                    RowBox[{
                    RowBox[{"funcs", "[", 
                    RowBox[{"keys", "[", 
                    RowBox[{"[", "nn", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"nn", ",", " ", 
                    RowBox[{"Length", "[", "keys", "]"}]}], "}"}]}], " ", 
                  "]"}]}], " ", ")"}], "2"], "&"}], " ", "/@", " ", "arr"}], 
            " ", "]"}], "//", "Sqrt"}], " ", ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ans2", " ", "=", "ans1"}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ans2", "[", "\"\<err\>\"", "]"}], " ", "=", " ", "err"}], 
        ";", "\[IndentingNewLine]", "ans2"}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fancyregrsin2theta", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], " ", ",", " ", "c0_"}], "]"}], ":=", 
     " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fit", ",", " ", "afit"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fit", "=", " ", 
         RowBox[{"fancyregr", "[", " ", 
          RowBox[{"arr", ",", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<aa\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "&"}], ")"}]}], ",", " ", 
             RowBox[{"\"\<bb\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"2", "c0", " ", "#"}], "]"}], "&"}], ")"}]}], ",", 
             " ", 
             RowBox[{"\"\<dd\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "c0", " ", "#"}], "]"}], "&"}], ")"}]}]}], 
            "|>"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fit", "[", "\"\<f\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fit", "[", "\"\<aa\>\"", "]"}], "+", 
            RowBox[{
             RowBox[{"fit", "[", "\"\<bb\>\"", "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "c0", " ", "#"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fit", "[", "\"\<dd\>\"", "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "c0", " ", "#"}], "]"}]}]}], " ", ")"}], 
          "&"}]}], "  ", ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fit", "[", "\"\<phi\>\"", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"ArcTan", "[", " ", 
            FractionBox[
             RowBox[{"fit", "[", "\"\<bb\>\"", "]"}], 
             RowBox[{"fit", "[", "\"\<dd\>\"", "]"}]], "]"}], "]"}], 
          FractionBox["1", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fit", "[", "\"\<amp\>\"", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"fit", "[", "\"\<bb\>\"", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"fit", "[", "\"\<dd\>\"", "]"}], "2"]}], "]"}], "//", 
          "Sqrt"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "fit"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fancyregrsin2theta", "[", " ", "c0_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"fancyregrsin2theta", "[", " ", 
       RowBox[{"#", ",", " ", "c0"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rot", "[", 
      RowBox[{"m_", ",", "\[Theta]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"\[Theta]", ",", " ", "\[Omega]"}], "]"}], "\[Transpose]"}], 
      ".", "m", ".", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"\[Theta]", ",", " ", "\[Omega]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rot", "[", 
      RowBox[{"\[Theta]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"rot", "[", 
       RowBox[{"#", ",", "\[Theta]", ",", " ", "\[Omega]"}], "]"}], "&"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vrot", "[", 
      RowBox[{"v_", ",", "\[Theta]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"\[Theta]", ",", " ", "\[Omega]"}], "]"}], ".", "v"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vrot", "[", 
      RowBox[{"\[Theta]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"vrot", "[", 
       RowBox[{"#", ",", "\[Theta]", ",", " ", "\[Omega]"}], "]"}], "&"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotvector", "[", 
      RowBox[{"v_", ",", "\[Alpha]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", " ", "=", " ", 
         FractionBox["\[Omega]", 
          RowBox[{"Norm", "[", "\[Omega]", "]"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", " ", 
         FractionBox[
          RowBox[{"Cross", "[", 
           RowBox[{"v", ",", "c"}], "]"}], 
          RowBox[{"Norm", "[", " ", 
           RowBox[{"Cross", "[", " ", 
            RowBox[{"v", ",", "c"}], "]"}], "]"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{"Cross", "[", 
          RowBox[{"c", ",", "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"v", ".", "c"}], ")"}]}], " ", "+", " ", 
         RowBox[{"a", " ", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
             RowBox[{"(", 
              RowBox[{"v", ".", "a"}], ")"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
             RowBox[{"(", 
              RowBox[{"v", ".", "b"}], ")"}]}]}], " ", ")"}]}], "+", "  ", 
         RowBox[{"b", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
             RowBox[{"(", 
              RowBox[{"v", ".", "a"}], ")"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
             RowBox[{"(", 
              RowBox[{"v", ".", "b"}], ")"}]}]}], " ", ")"}]}]}]}]}], "   ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->24], 
   RowBox[{
    RowBox[{
     RowBox[{"rotvector", "[", 
      RowBox[{"\[Alpha]_", ",", " ", "\[Omega]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"rotvector", "[", 
       RowBox[{"#", ",", "\[Alpha]", ",", " ", "\[Omega]"}], "]"}], "&"}]}], 
    ";"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->24], 
   RowBox[{
    RowBox[{
     RowBox[{"maplinear", "[", "ass_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ass", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", 
          RowBox[{
           RowBox[{"ass", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"ass", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"ass", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"ass", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"ass", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]]}]}], " ", "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->24], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toList", "[", "arr_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "arr", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toAlist", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrr", "=", 
         RowBox[{"Flatten", "[", "arr", "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", " ", 
            RowBox[{"arrr", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"alen", "[", "arrr", "]"}]}], "]"}]}], " ", ")"}], "//", 
        "Association"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toIlist", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrr", "=", 
         RowBox[{"Flatten", "[", "arr", "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"arrr", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", "  ", "#"}], " ", 
           "&"}], " ", "/@", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"alen", "[", "arrr", "]"}]}], "]"}]}], " ", ")"}], "//", 
        "Association"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"torange", "[", " ", 
      RowBox[{"from_", ",", "to_", ",", "arr_"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"linrange", "[", 
            RowBox[{"from", ",", "to", ",", 
             RowBox[{"Length", "[", "arr", "]"}]}], "]"}], "[", 
           RowBox[{"[", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"arr", "//", "Sort"}], "//", "toIlist"}], ")"}], "[", 
             "#", "]"}], " ", "]"}], "]"}]}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"(", 
         RowBox[{"arr", "//", "Sort"}], ")"}]}], ")"}], "//", 
      "Association"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"torange", "[", 
      RowBox[{"\"\<equal\>\"", ",", " ", "from_", ",", "to_", ",", "arr_"}], 
      "]"}], ":=", " ", 
     RowBox[{"torange", "[", " ", 
      RowBox[{"from", ",", "to", ",", "arr"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"torange", "[", 
      RowBox[{"\"\<propo\>\"", ",", "from_", ",", "to_", ",", "arr_"}], "]"}],
      ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mi", "=", 
          RowBox[{"Min", "[", "arr", "]"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"ma", "=", 
          RowBox[{"Max", "[", "arr", "]"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"arrr", "=", 
          RowBox[{"arr", "//", "Sort"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"arri", " ", "=", " ", 
          RowBox[{
           RowBox[{"arr", "//", "Sort"}], "//", "toIlist"}]}]}], 
        "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", " ", 
            RowBox[{"from", "+", " ", 
             RowBox[{
              FractionBox[
               RowBox[{"#", "-", "mi"}], 
               RowBox[{"ma", "-", "mi"}]], 
              RowBox[{"(", 
               RowBox[{"to", "-", "from"}], ")"}]}]}]}], " ", "&"}], " ", "/@",
           " ", "arrr"}], ")"}], "//", "Association"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"appendind", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"ind", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "arr", "]"}], ",", "1"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"#", ",", " ", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"arr", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ")"}]}]}], "}"}], "&"}], "/@", 
        " ", "ind"}]}], "  ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"multiply\[CenterEllipsis]array", "[", " ", 
      RowBox[{"arr_", ",", "factors_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"arr", "[", 
         RowBox[{"[", 
          RowBox[{"#", ",", "All"}], "]"}], "]"}], "factors"}], " ", "&"}], 
      " ", "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"alen", "[", "arr", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"manip\[CenterEllipsis]array", "[", " ", 
      RowBox[{"arr_", ",", "functions_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"functions", "[", 
         RowBox[{"[", "n", "]"}], "]"}], "[", 
        RowBox[{"arr", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "n"}], "]"}], "]"}], "]"}], ",", "  ", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"alen", "[", "arr", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"alen", "[", "functions", "]"}]}], "}"}]}], " ", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"manip\[CenterEllipsis]array", "[", " ", "functions_", "]"}], ":=",
      " ", 
     RowBox[{
      RowBox[{"manip\[CenterEllipsis]array", "[", " ", 
       RowBox[{"#", ",", "functions"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"USE", ":", "  ", 
     RowBox[{"manip\[CenterEllipsis]f\[CenterEllipsis]array", "[", 
      RowBox[{"arr", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "1", "]"}], "&"}], ",", " ", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"#", "[", "2", "]"}]}], "&"}]}], "}"}]}], "]"}]}], "  ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"manip\[CenterEllipsis]f\[CenterEllipsis]array", "[", " ", 
      RowBox[{"arr_", ",", "functions_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"functions", "[", 
         RowBox[{"[", "n", "]"}], "]"}], "[", 
        RowBox[{"toAlist", "[", " ", 
         RowBox[{"arr", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "All"}], "]"}], "]"}], "]"}], " ", "]"}], ",", 
       "  ", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"alen", "[", "arr", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"alen", "[", "functions", "]"}]}], "}"}]}], " ", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "manip\[CenterEllipsis]f\[CenterEllipsis]array", "[", " ", "functions_", 
      "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"manip\[CenterEllipsis]f\[CenterEllipsis]array", "[", " ", 
       RowBox[{"#", ",", "functions"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"manip\[CenterEllipsis]f\[CenterEllipsis]array", "[", " ", 
      RowBox[{"arr1_", ",", "arr2_", ",", "functions_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrr", "=", 
         RowBox[{
          RowBox[{"Join", "[", " ", 
           RowBox[{
            RowBox[{"arr1", "\[Transpose]"}], ",", " ", 
            RowBox[{"arr2", "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], 
        "}"}], ",", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"functions", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "[", 
          RowBox[{"toAlist", "[", " ", 
           RowBox[{"arrr", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "All"}], "]"}], "]"}], "]"}], " ", "]"}], ",", 
         "  ", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"alen", "[", "arr", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"alen", "[", "functions", "]"}]}], "}"}]}], " ", "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omit\[CenterEllipsis]temps", "[", " ", 
      RowBox[{"arr_", ",", " ", "condition_"}], "]"}], ":=", "   ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{"Select", "[", " ", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"alen", "[", "arr", "]"}]}], "]"}], ",", "  ", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"condition", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "]"}], "]"}], 
            "&"}]}], "]"}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"first", ",", "All"}], "]"}], "]"}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omit\[CenterEllipsis]temps", "[", " ", "condition_", "]"}], ":=",
      " ", 
     RowBox[{
      RowBox[{"omit\[CenterEllipsis]temps", "[", " ", 
       RowBox[{"#", ",", " ", "condition"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select\[CenterEllipsis]high\[CenterEllipsis]fields", "[", " ", 
      RowBox[{"arr_", ",", " ", "lowest_"}], "]"}], ":=", "   ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{
          RowBox[{"SelectFirst", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"alen", "[", "arr", "]"}]}], "]"}], "}"}], ",", 
               RowBox[{"{", " ", 
                RowBox[{"arr", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}]}], " ", 
              "]"}], "\[Transpose]"}], " ", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ">", "lowest"}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"first", ";;", 
           RowBox[{"-", "1"}]}], ",", "All"}], "]"}], "]"}]}], " ", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "arrays2", " ", "*)"}], "Subsection",
    FontSize->36], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tolist", "[", "arr_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"indices", "[", "arr", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"toalist", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrr", "=", 
         RowBox[{"Flatten", "[", "arr", "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", " ", 
            RowBox[{"arrr", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"indices", "[", "arrr", "]"}]}], " ", ")"}], "//", 
        "Association"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"funcs_", "?", "ArrayQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"funcs", "[", 
          RowBox[{"toalist", "[", "#", "]"}], "]"}], "//", "Through"}], ")"}],
        "&"}], "/@", " ", "arr"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map", "[", 
      RowBox[{"funcs_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"#", ",", " ", "funcs"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", "func_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"func", "[", 
        RowBox[{"#", "//", "toalist"}], "]"}], "&"}], " ", "/@", "arr"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map", "[", "func_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"#", ",", " ", "func"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map1", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"funcs_", "?", "ArrayQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"funcs", "[", "#", "]"}], "//", "Through"}], ")"}], "&"}], "/@",
       " ", "arr"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map1", "[", 
      RowBox[{"funcs_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"map1", "[", 
       RowBox[{"#", ",", " ", "funcs"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map2", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", "func_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"func", "[", "#", "]"}], ")"}], "&"}], "/@", " ", "arr"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"map2", "[", "func_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"map2", "[", 
       RowBox[{"#", ",", " ", "func"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omit", "[", " ", 
      RowBox[{"arr_", ",", " ", "condition_"}], "]"}], ":=", 
     RowBox[{"arr", "//", " ", 
      RowBox[{"Select", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "//", "toalist"}], "//", "condition"}], "//", "Not"}],
          ")"}], "&"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"omit", "[", " ", "condition_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"omit", "[", " ", 
       RowBox[{"#", ",", " ", "condition"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"keep", "[", " ", 
      RowBox[{"arr_", ",", " ", "condition_"}], "]"}], ":=", 
     RowBox[{"arr", "//", " ", 
      RowBox[{"Select", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "//", "toalist"}], "//", "condition"}], ")"}], " ", 
        "&"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"keep", "[", " ", "condition_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"keep", "[", " ", 
       RowBox[{"#", ",", " ", "condition"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findB", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "B_", ",", "win_"}], "]"}], ":=",
      " ", 
     RowBox[{
      RowBox[{"arr", " ", "//", " ", 
       RowBox[{"keep", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "-", "win"}], "<", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"B", "+", "win"}]}], "&"}], "]"}]}], "//", 
      RowBox[{"ilinear", "[", "\"\<average\>\"", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findB", "[", 
      RowBox[{"B_", ",", "win_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"findB", "[", 
       RowBox[{"#", ",", "B", ",", "win"}], "]"}], "&"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findB", "[", "B_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"findB", "[", 
       RowBox[{"#", ",", "B", ",", "0.2"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]partition", "[", 
      RowBox[{"n_", ",", "w_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"#", "-", "w"}]}], "]"}], ",", "  ", 
         RowBox[{"Min", "[", 
          RowBox[{"n", ",", 
           RowBox[{"#", "+", "w"}]}], "]"}]}], "}"}], "&"}], "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]trim\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_", ",", 
       RowBox[{"f_", "?", "NumberQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"TrimmedMean", "[", " ", 
        RowBox[{
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", " ", "f"}], "]"}], " ", "&"}], 
      "/@", " ", 
      RowBox[{"running\[CenterEllipsis]partition", "[", 
       RowBox[{
        RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]trim\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_", ",", 
       RowBox[{"f_", "?", "ArrayQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"TrimmedMean", "[", " ", 
        RowBox[{
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", " ", "f"}], "]"}], " ", "&"}], 
      "/@", " ", 
      RowBox[{"running\[CenterEllipsis]partition", "[", 
       RowBox[{
        RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]trim\[CenterEllipsis]mean", "[", 
      RowBox[{"w_", ",", "f_"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]trim\[CenterEllipsis]mean", "[", 
       RowBox[{"#", ",", "w", ",", "f"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "B_", ",", "timestep_"}], "]"}], 
     ":=", " ", 
     RowBox[{"Re", "[", 
      RowBox[{"LowpassFilter", "[", "  ", 
       RowBox[{"arr", " ", ",", " ", 
        RowBox[{"B", "  ", "timestep", "  ", "\[Pi]"}]}], "]"}], " ", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter", "[", 
      RowBox[{"B_", ",", "timestep_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter", "[", 
       RowBox[{"#", ",", "B", ",", "timestep"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter2", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "B_", ",", "timestep_"}], "]"}], 
     ":=", " ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"arr", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"(", 
         RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "B", ",", 
           "timestep"}], "]"}], ")"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter2", "[", 
      RowBox[{"B_", ",", "timestep_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"low\[CenterEllipsis]pass\[CenterEllipsis]filter2", "[", 
       RowBox[{"#", ",", "B", ",", "timestep"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fitfunc", "[", 
      RowBox[{"arr_", ",", " ", "func_", ",", "vars_", ",", " ", "arg_"}], 
      "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "fit", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fit", "=", " ", 
         RowBox[{"FindFit", "[", 
          RowBox[{"arr", ",", "func", ",", "vars", ",", "arg"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"func", "/.", "fit"}], ")"}], "//", "Activate"}], ")"}],
            "/.", " ", 
           RowBox[{"arg", "\[Rule]", "#"}]}], ")"}], "&"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"appendtime", "[", 
      RowBox[{"arr_", ",", " ", "timestep_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"arr", "//", "appendind"}], "//", 
      RowBox[{"map2", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "timestep"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "]"}]}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"appendtime", "[", " ", "timestep_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"appendtime", "[", 
       RowBox[{"#", ",", " ", "timestep"}], "]"}], "&"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]median", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"Median", "[", " ", 
        RowBox[{"arr", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"running\[CenterEllipsis]partition", "[", 
       RowBox[{
        RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]median", "[", "w_", "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]median", "[", 
       RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_", ",", 
       RowBox[{"f1_", "?", "NumberQ"}], ",", 
       RowBox[{"f2_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"TrimmedMean", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", " ", "f1"}], "]"}], 
          " ", "&"}], "/@", " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}], " ", ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"TrimmedMean", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", " ", "f2"}], "]"}], 
          " ", "&"}], "/@", " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
       "\[IndentingNewLine]", "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_", ",", 
       RowBox[{"f_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{"arr", ",", "w", ",", "f", ",", "f"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "w_"}], "]"}], ":=", " ", 
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{"arr", ",", "w", ",", "0.1", ",", "0.1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{
       RowBox[{"w_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"f_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
       RowBox[{"#", ",", "w", ",", "f", ",", "f"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
      RowBox[{"w_", "?", "NumberQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]mean", "[", 
       RowBox[{"#", ",", "w", ",", "0.1", ",", "0.1"}], "]"}], "&"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]slope", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", 
       RowBox[{"w_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], " ", "&"}], "/@", 
         " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}], " ", ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"slope", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}], " ", 
          "&"}], "/@", " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
       "\[IndentingNewLine]", "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]slope", "[", 
      RowBox[{"w_", "?", "NumberQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]slope", "[", 
       RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]median", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", 
       RowBox[{"w_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Median", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], " ", "&"}], "/@", 
         " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}], " ", ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Median", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}], " ", "&"}], "/@", 
         " ", 
         RowBox[{"running\[CenterEllipsis]partition", "[", 
          RowBox[{
           RowBox[{"Length", "[", "arr", "]"}], ",", "w"}], "]"}]}]}], " ", 
       "\[IndentingNewLine]", "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]median", "[", 
      RowBox[{"w_", "?", "NumberQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]arr\[CenterEllipsis]median", "[", 
       RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select", "[", 
      RowBox[{"arr_", ",", "\"\<rising\>\""}], "]"}], ":=", " ", 
     RowBox[{"arr", "[", 
      RowBox[{"[", " ", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], "//",
               "Sort"}], "//", "Normal"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "All"}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select", "[", 
      RowBox[{"arr_", ",", "\"\<lowering\>\""}], "]"}], ":=", " ", 
     RowBox[{"arr", "[", 
      RowBox[{"[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], "//",
               "Sort"}], "//", "Normal"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"-", "1"}]}], ",", " ", "All"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select", "[", "\"\<rising\>\"", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"select", "[", 
       RowBox[{"#", ",", "\"\<rising\>\""}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select", "[", "\"\<lowering\>\"", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"select", "[", 
       RowBox[{"#", ",", "\"\<lowering\>\""}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"remove", "[", 
      RowBox[{"arr_", ",", "what_"}], "]"}], ":=", " ", 
     RowBox[{"Complement", "[", 
      RowBox[{"arr", ",", "what"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"remove", "[", "what_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"remove", "[", 
       RowBox[{"#", ",", "what"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sift", "[", 
      RowBox[{"arr_", ",", "what_"}], " ", "]"}], ":=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{"arr", ",", "what"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sift", "[", "what_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sift", "[", 
       RowBox[{"#", ",", "what"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"more", " ", "arrays"}], " ", "*)"}], "Subsection",
    FontSize->36], 
   StyleBox[" ", "Subsection",
    FontSize->36], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mask\[CenterEllipsis]array", "[", " ", 
      RowBox[{"arr_", ",", " ", "mask_"}], "]"}], " ", ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"alen", "[", "arr", "]"}]}], "]"}], " ", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"mask", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"inds", ",", "All"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"for\[CenterEllipsis]zach", "[", 
      RowBox[{"hash_", ",", "rules_"}], "]"}], ":=", " ", 
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"hash", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Tail", "[", "rr", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Tail", "[", "rr", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
       RowBox[{"{", 
        RowBox[{"rr", ",", "rules"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"for\[CenterEllipsis]zach\[CenterEllipsis]subs", "[", 
      RowBox[{"hash_", ",", "rules_"}], "]"}], ":=", " ", 
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["hash", 
         RowBox[{
          RowBox[{
           RowBox[{"Tail", "[", "rr", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Tail", "[", "rr", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
       RowBox[{"{", 
        RowBox[{"rr", ",", "rules"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linear\[CenterEllipsis]fit", "[", " ", "arr_", "]"}], ":=", 
     "  ", "\[IndentingNewLine]", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"fit", "=", " ", 
         RowBox[{"Fit", "[", 
          RowBox[{"arr", ",", 
           RowBox[{"{", " ", 
            RowBox[{"1", " ", ",", " ", "x"}], " ", "}"}], ",", " ", "x"}], 
          "]"}]}], "  ", "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}], ",", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"fit", "/.", 
              RowBox[{"x", "\[Rule]", "#"}]}], "&"}], " ", "/@", " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "  ", "}"}]}], " ", 
         "]"}], "\[Transpose]"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "linear\[CenterEllipsis]fit\[CenterEllipsis]from\[CenterEllipsis]high", 
      "[", " ", 
      RowBox[{"arr_", ",", "lowerB_"}], "]"}], ":=", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"fit", "=", " ", 
         RowBox[{"Fit", "[", 
          RowBox[{
           RowBox[{
           "select\[CenterEllipsis]high\[CenterEllipsis]fields", "[", 
            RowBox[{"arr", ",", "lowerB"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{"1", " ", ",", " ", "x"}], " ", "}"}], ",", " ", "x"}], 
          "]"}]}], "  ", "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}], ",", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"fit", "/.", 
              RowBox[{"x", "\[Rule]", "#"}]}], "&"}], " ", "/@", " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "  ", "}"}]}], " ", 
         "]"}], "\[Transpose]"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "linear\[CenterEllipsis]fit\[CenterEllipsis]from\[CenterEllipsis]high\
\[CenterEllipsis]intercept", "[", " ", 
      RowBox[{"arr_", ",", "lowerB_"}], "]"}], ":=", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"fit", "=", " ", 
         RowBox[{"Fit", "[", 
          RowBox[{
           RowBox[{
           "select\[CenterEllipsis]high\[CenterEllipsis]fields", "[", 
            RowBox[{"arr", ",", "lowerB"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{"1", " ", ",", " ", "x"}], " ", "}"}], ",", " ", "x"}], 
          "]"}]}], "  ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"f0", "=", " ", 
            RowBox[{"fit", "/.", 
             RowBox[{"x", "\[Rule]", "0"}]}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"f1", "=", "  ", 
            RowBox[{"fit", "/.", 
             RowBox[{"x", "\[Rule]", "1"}]}]}]}], " ", "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"f0", ",", 
           RowBox[{"f1", "-", "f0"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select\[CenterEllipsis]high\[CenterEllipsis]temps", "[", " ", 
      RowBox[{"arr_", ",", " ", "lowest_"}], "]"}], ":=", "   ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{"Select", "[", " ", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"alen", "[", "arr", "]"}]}], "]"}], ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "\[GreaterEqual]", 
             " ", "lowest"}], "&"}]}], "]"}]}], " ", "\[IndentingNewLine]", 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"first", ",", "All"}], "]"}], "]"}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"select\[CenterEllipsis]low\[CenterEllipsis]temps", "[", " ", 
      RowBox[{"arr_", ",", " ", "highest_"}], "]"}], ":=", "   ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{"Select", "[", " ", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"alen", "[", "arr", "]"}]}], "]"}], ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "\[LessEqual]", 
             "highest"}], "&"}]}], "]"}]}], " ", "\[IndentingNewLine]", "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"first", ",", "All"}], "]"}], "]"}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"decimate", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"points_", "?", "ArrayQ"}], " ", ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"point", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"arr", "//", 
              RowBox[{"keep", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"point", "-", "win"}], "<", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", 
                 RowBox[{"point", "+", "win"}]}], "&"}], "]"}]}], ")"}], "[", 
            
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "//", "Mean"}], 
          "  ", ")"}]}], "}"}], " ", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"point", ",", " ", "points"}], "}"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"decimate", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "max", ",", " ", "points", ",", " ", "win"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"max", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"linrange", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "npoints"}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"decimate", "[", " ", 
         RowBox[{"arr", ",", " ", "points", " ", ",", " ", "win"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"decimate", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}], " ", ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "max", ",", " ", "points"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"max", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"linrange", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "npoints"}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"decimate", "[", " ", 
         RowBox[{"arr", ",", " ", "points", " ", ",", " ", "win"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"decimate", "[", "  ", 
      RowBox[{
       RowBox[{"npoints_", "?", "NumberQ"}], " ", ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"decimate", "[", " ", 
       RowBox[{"#", ",", "  ", "npoints", " ", ",", " ", "win"}], "]"}], 
      "&"}]}], " ", ";"}], 
   StyleBox["\[IndentingNewLine]", "Subsection"], 
   RowBox[{
    RowBox[{
     RowBox[{"decimate", "[", "  ", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"decimate", "[", " ", 
       RowBox[{"#", ",", "  ", "npoints"}], " ", "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pt", ",", "min", ",", "max", ",", " ", "points", ",", " ", "win", 
         ",", " ", "number", ",", " ", "total"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"max", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"linrange", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "npoints"}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"number", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"number", "[", "pt", "]"}], "++"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"total", "[", "pt", "]"}], "+=", " ", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            RowBox[{
             RowBox[{"total", "[", "#", "]"}], "/", 
             RowBox[{"number", "[", "#", "]"}]}]}], "}"}], "&"}], " ", "/@", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"points", ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"number", "[", "#", "]"}], ">", "0"}], "&"}]}], " ", 
          "]"}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate", "[", 
       RowBox[{"#", ",", " ", "npoints"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate2", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"min_", ",", "max_", ",", " ", "win_"}], "}"}]}], "]"}], ":=",
      " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pt", ",", " ", "points", ",", "  ", "number", ",", " ", "total"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"min", " ", "=", " ", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"max", " ", "=", " ", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"win", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"Range", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"number", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"number", "[", "pt", "]"}], "++"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"total", "[", "pt", "]"}], "+=", " ", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            RowBox[{
             RowBox[{"total", "[", "#", "]"}], "/", 
             RowBox[{"number", "[", "#", "]"}]}]}], "}"}], "&"}], " ", "/@", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"points", ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"number", "[", "#", "]"}], ">", "0"}], "&"}]}], " ", 
          "]"}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate2", "[", 
      RowBox[{"{", 
       RowBox[{"min_", ",", "max_", ",", " ", "win_"}], "}"}], "]"}], ":=", 
     " ", 
     RowBox[{
      RowBox[{"sdecimate2", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{"{", 
         RowBox[{"min", ",", "max", ",", " ", "win"}], "}"}]}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate2", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pt", ",", "min", ",", "max", ",", " ", "points", ",", " ", "win", 
         ",", " ", "number", ",", " ", "total"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"min", ",", " ", "max"}], "}"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", "Flatten"}], 
          " ", "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{"min", ",", " ", 
           RowBox[{"win", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"max", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"max", ",", " ", 
           RowBox[{"win", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sdecimate2", "[", 
         RowBox[{"arr", ",", " ", 
          RowBox[{"{", 
           RowBox[{"min", ",", "max", ",", " ", "win"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate2", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate2", "[", 
       RowBox[{"#", ",", " ", "npoints"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "interpolate", " ", "two", " ", "arrays", " ", "to", " ", "the", " ", 
      "same", " ", "set", " ", "of", " ", "x"}], "-", "points"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3", "[", 
      RowBox[{
       RowBox[{"arr1_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"arr2_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"min_", ",", "max_", ",", " ", "win_"}], "}"}]}], "]"}], ":=",
      " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pt", ",", " ", "points", ",", "  ", "number1", ",", "number2", ",", 
         " ", "total1", ",", " ", "total2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"min", " ", "=", " ", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"max", " ", "=", " ", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"win", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"Range", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"number1", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total1", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"number2", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total2", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"number1", "[", "pt", "]"}], "++"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"total1", "[", "pt", "]"}], "+=", " ", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr1"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"number2", "[", "pt", "]"}], "++"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"total2", "[", "pt", "]"}], "+=", " ", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr2"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            FractionBox[
             RowBox[{"total1", "[", "#", "]"}], 
             RowBox[{"number1", "[", "#", "]"}]], ",", " ", 
            FractionBox[
             RowBox[{"total2", "[", "#", "]"}], 
             RowBox[{"number2", "[", "#", "]"}]]}], "}"}], "&"}], " ", "/@", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"points", ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"number1", "[", "#", "]"}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"number2", "[", "#", "]"}], ">", "0"}]}], "&"}]}], " ", 
          "]"}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3", "[", 
      RowBox[{"{", 
       RowBox[{"min_", ",", "max_", ",", " ", "win_"}], "}"}], "]"}], ":=", 
     " ", 
     RowBox[{
      RowBox[{"sdecimate3", "[", 
       RowBox[{"#1", ",", "#2", ",", " ", 
        RowBox[{"{", 
         RowBox[{"min", ",", "max", ",", " ", "win"}], "}"}]}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3", "[", 
      RowBox[{
       RowBox[{"arr1_", "?", "ArrayQ"}], ",", 
       RowBox[{"arr2_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pt", ",", "min", ",", "max", ",", " ", "points", ",", " ", "win", 
         ",", " ", "number", ",", " ", "total"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"min", ",", " ", "max"}], "}"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"arr1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"arr2", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "}"}], "//", 
           "Flatten"}], " ", "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{"min", ",", " ", 
           RowBox[{"win", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"max", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"max", ",", " ", 
           RowBox[{"win", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sdecimate3", "[", 
         RowBox[{"arr1", ",", "arr2", ",", " ", 
          RowBox[{"{", 
           RowBox[{"min", ",", "max", ",", " ", "win"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate3", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "npoints"}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3sym", "[", 
      RowBox[{
       RowBox[{"arr1_", "?", "ArrayQ"}], ",", 
       RowBox[{"arr2_", "?", "ArrayQ"}], ",", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate3", "[", 
       RowBox[{"arr1", ",", "arr2", ",", " ", "npoints"}], "]"}], " ", "//", 
      RowBox[{"map2", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "2"]}], "}"}], "&"}], 
       "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3sym", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate3sym", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "npoints"}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3asym", "[", 
      RowBox[{
       RowBox[{"arr1_", "?", "ArrayQ"}], ",", 
       RowBox[{"arr2_", "?", "ArrayQ"}], ",", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate3", "[", 
       RowBox[{"arr1", ",", "arr2", ",", " ", "npoints"}], "]"}], " ", "//", 
      RowBox[{"map2", "[", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "2"]}], "}"}], "&"}], 
       "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdecimate3asym", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"sdecimate3asym", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "npoints"}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mdecimate", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"npoints_", "?", "NumberQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "pt", ",", "cond", ",", "min", ",", "ave", ",", "max", ",", " ", 
         "points", ",", " ", "win", ",", " ", "\[IndentingNewLine]", "number",
          ",", " ", "total", ",", " ", "total2", ",", " ", "sigm2"}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"max", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"linrange", "[", " ", 
          RowBox[{"min", ",", "max", ",", " ", "npoints"}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "npoints"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"number", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total2", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"number", "[", "pt", "]"}], "++"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"total", "[", "pt", "]"}], "+=", " ", 
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"total2", "[", "pt", "]"}], "+=", " ", 
           SuperscriptBox[
            RowBox[{"ele", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "2"]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ave", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Rule]", " ", 
              FractionBox[
               RowBox[{"total", "[", "#", "]"}], 
               RowBox[{"number", "[", "#", "]"}]]}], ")"}], "&"}], " ", "/@", 
           " ", 
           RowBox[{"Select", "[", 
            RowBox[{"points", ",", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"number", "[", "#", "]"}], ">", "0"}], "&"}]}], " ", 
            "]"}]}], " ", "//", "Association"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sigm2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Rule]", 
              SqrtBox[
               RowBox[{" ", 
                RowBox[{
                 FractionBox[
                  RowBox[{"total2", "[", "#", "]"}], 
                  RowBox[{"number", "[", "#", "]"}]], "-", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"total", "[", "#", "]"}], 
                    RowBox[{"number", "[", "#", "]"}]], ")"}], "2"]}]}]]}], 
             ")"}], "&"}], " ", "/@", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"points", ",", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"number", "[", "#", "]"}], ">", "0"}], "&"}]}], " ", 
            "]"}]}], " ", "//", "Association"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"number", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"total", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "\[Rule]", " ", "0"}], " ", ")"}], "&"}], "/@", " ",
            "points"}], " ", "//", "Association"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", " ", "=", " ", 
            RowBox[{"min", "+", 
             RowBox[{"win", " ", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ele", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "min"}], ")"}], "/", 
                "win"}], "]"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"total2", "[", "pt", "]"}], ">", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ave", "[", "pt", "]"}], "-", 
                RowBox[{"sigm2", "[", "pt", "]"}]}], "<", 
               RowBox[{"ele", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", 
               RowBox[{
                RowBox[{"ave", "[", "pt", "]"}], "+", 
                RowBox[{"sigm2", "[", "pt", "]"}]}]}]}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"number", "[", "pt", "]"}], "++"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"total", "[", "pt", "]"}], "+=", " ", 
               RowBox[{"ele", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"ele", ",", " ", "arr"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            FractionBox[
             RowBox[{"total", "[", "#", "]"}], 
             RowBox[{"number", "[", "#", "]"}]]}], "}"}], "&"}], " ", "/@", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"points", ",", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"number", "[", "#", "]"}], ">", "0"}], "&"}]}], " ", 
          "]"}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mdecimate", "[", 
      RowBox[{"npoints_", "?", "NumberQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"mdecimate", "[", 
       RowBox[{"#", ",", " ", "npoints"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sum]", " ", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "+", 
           RowBox[{"b", " ", "n"}], "+", 
           RowBox[{"c", " ", 
            RowBox[{"n", "^", "2"}]}]}], ")"}], "-", "z_n"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"0", "\[IndentingNewLine]", 
        RowBox[{"\[Sum]", " ", 
         RowBox[{"n", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", 
             RowBox[{"b", " ", "n"}], "+", 
             RowBox[{"c", " ", 
              RowBox[{"n", "^", "2"}]}]}], ")"}], "-", "z_n"}], "]"}]}]}], 
       "=", 
       RowBox[{
        RowBox[{"0", "\[IndentingNewLine]", 
         RowBox[{"\[Sum]", " ", 
          RowBox[{
           SuperscriptBox["n", "2"], "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"b", " ", "n"}], "+", 
              RowBox[{"c", " ", 
               RowBox[{"n", "^", "2"}]}]}], ")"}], "-", "z_n"}], "]"}]}]}], 
        "=", "0"}]}]}], "\[IndentingNewLine]", "*)"}], "Subsection"], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ibilinear", "[", "arr_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
        "mmm", ",", "vvv", ",", "aaa", ",", " ", "x0", ",", " ", "x1", ",", 
         " ", "x2", ",", " ", "x3", ",", " ", "x4", ",", " ", "y1", ",", " ", 
         "x1y1", ",", " ", "x2y1"}], "}"}], ",", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x0", " ", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", "Total"}], 
          " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"x2", "=", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "2"], " ", "//", 
           "Total"}], " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"x3", "=", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "3"], " ", "//", 
           "Total"}], " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"x4", "=", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "4"], " ", "//", 
           "Total"}], " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"y1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "//", "Total"}], 
          " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"x1y1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "//", "Total"}],
           " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"x2y1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "2"], 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "//", "Total"}],
           " ", ")"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"mmm", "=", " ", 
         RowBox[{"(", GridBox[{
            {"x0", "x1", "x2"},
            {"x1", "x2", "x3"},
            {"x2", "x3", "x4"}
           }], ")"}]}], ";", " ", 
        RowBox[{"vvv", " ", "=", " ", 
         RowBox[{"(", GridBox[{
            {"y1"},
            {"x1y1"},
            {"x2y1"}
           }], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"aaa", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Inverse", "[", "mmm", "]"}], ".", "vvv"}], " ", ")"}], "//",
           "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"<|", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<a\>\"", "\[Rule]", " ", 
           RowBox[{"aaa", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"\"\<b\>\"", "\[Rule]", " ", 
           RowBox[{"aaa", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"\"\<c\>\"", "\[Rule]", " ", 
           RowBox[{"aaa", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<f\>\"", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"aaa", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "#"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], 
                SuperscriptBox["#", "2"]}]}], " ", ")"}], "&"}], ")"}]}], ",",
           " ", "\[IndentingNewLine]", 
          RowBox[{"\"\<all\>\"", "\[Rule]", " ", "aaa"}]}], 
         "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ibilinear", "[", 
      RowBox[{"what_", "?", "StringQ"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ibilinear", "[", "#", "]"}], "[", "what", "]"}], ")"}], 
      "&"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["y", "n"], " ", "~", " ", "a"}], " ", "+", " ", 
        RowBox[{"b", " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["x", "n"], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"[", 
            RowBox[{
             SubscriptBox["y", "n"], " ", "-", " ", 
             RowBox[{"(", 
              RowBox[{"a", " ", "+", " ", 
               RowBox[{"b", " ", 
                SubscriptBox["x", "n"]}]}], ")"}]}], "]"}]}], "2"]}]}], " ", 
       "\[Rule]", " ", 
       RowBox[{
       "min", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"<", "1", ">"}], 
            RowBox[{"<", "x", ">"}]},
           {
            RowBox[{"<", "x", ">"}], 
            RowBox[{"<", "xx", ">"}]}
          }], ")"}], 
        RowBox[{"(", GridBox[{
           {"a"},
           {"b"}
          }], ")"}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            RowBox[{"<", "y", ">"}]},
           {
            RowBox[{"<", "xy", ">"}]}
          }], ")"}], "\[IndentingNewLine]", 
        RowBox[{"(", GridBox[{
           {"a"},
           {"b"}
          }], ")"}]}], "=", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", GridBox[{
             {
              RowBox[{"<", "1", ">"}], 
              RowBox[{"<", "x", ">"}]},
             {
              RowBox[{"<", "x", ">"}], 
              RowBox[{"<", "xx", ">"}]}
            }], ")"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"<", "y", ">"}]},
            {
             RowBox[{"<", "xy", ">"}]}
           }], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{"<", "y", ">", "<", "xx", ">", 
                 RowBox[{"-", 
                  RowBox[{"<", "x", ">", "<", "xy", ">"}]}]}]},
               {
                RowBox[{"<", "1", ">", "<", "xy", ">", 
                 RowBox[{"-", 
                  RowBox[{"<", "x", ">", "<", "y", ">"}]}]}]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.7]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
            FractionBox["1", 
             RowBox[{"<", "1", ">", "<", "xx", ">", 
              RowBox[{"-", 
               RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
          "errors", ".", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "assume"}], " ", 
          SuperscriptBox["\[Sigma]", "2"]}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           FractionBox["1", "N"], 
           RowBox[{
            SubscriptBox["\[Sum]", "n"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "n"], "-", 
               RowBox[{"(", 
                RowBox[{"a", "+", 
                 SubscriptBox["bx", "n"]}], ")"}]}], ")"}], "2"]}]}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{"<", "yy", ">", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], 
              RowBox[{"(", 
               RowBox[{"a", "<", "y", ">", 
                RowBox[{"+", "b"}], "<", "xy", ">"}], ")"}]}], "+", 
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"2", "ab"}]}], " ", "<", "x", ">", " ", 
            RowBox[{"+", " ", 
             SuperscriptBox["b", "2"]}], "<", "xx", ">", "  ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "which", " ", "is", " ", "a", " ", "scatter", " ", "of", " ", 
              SubscriptBox["y", "n"], "around", " ", "the", " ", 
              RowBox[{
              "line", ".", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "then"}], " ", "scatter", " ", "of", " ", "the", " ", "value", 
              " ", "a"}], "+", 
             RowBox[{
              SubscriptBox["bX", "0"], " ", 
              RowBox[{"(", 
               RowBox[{
               "due", " ", "to", " ", "scatter", " ", "of", " ", "a", " ", 
                "and", " ", "b"}], " ", ")"}], " ", "is", " ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
              SuperscriptBox["\[CapitalDelta]", "2"], 
              RowBox[{"(", 
               RowBox[{"a", "+", 
                SubscriptBox["bX", "0"]}], ")"}]}]}]}], " ", "=", "  ", 
           RowBox[{
            RowBox[{
             FractionBox[
              SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
             RowBox[{"(", " ", 
              RowBox[{"1", "+", " ", 
               FractionBox[
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["X", "0"], "-"}], "<", "x", ">"}], ")"}], 
                 "2"], 
                RowBox[{"<", "xx", ">", 
                 RowBox[{"-", 
                  RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}], ")"}]}], " ",
             "=", "  ", 
            RowBox[{
             FractionBox[
              SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
             FractionBox[
              RowBox[{"<", "xx", ">", " ", 
               RowBox[{
                RowBox[{"+", " ", 
                 SuperscriptBox[
                  SubscriptBox["X", "0"], "2"]}], " ", "-", 
                RowBox[{"2", 
                 SubscriptBox["X", "0"]}]}], "<", "x", ">"}], 
              RowBox[{"<", "xx", ">", 
               RowBox[{"-", 
                RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "in", " ", 
             "particular"}]}]}]}]}]}]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], 
       RowBox[{"(", "a", ")"}]}], " ", "=", "  ", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
        RowBox[{"(", " ", 
         RowBox[{"1", "+", " ", 
          FractionBox[
           RowBox[{"<", "x", 
            SuperscriptBox[">", "2"]}], 
           RowBox[{"<", "xx", ">", 
            RowBox[{"-", 
             RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}], ")"}]}], " ", "=",
        "  ", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
        FractionBox[
         RowBox[{"<", "xx", ">"}], 
         RowBox[{"<", "xx", ">", 
          RowBox[{"-", 
           RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], 
       RowBox[{"(", "b", ")"}]}], " ", "=", "  ", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
        RowBox[{"(", " ", 
         RowBox[{"1", "+", " ", 
          FractionBox[
           RowBox[{"<", "x", 
            SuperscriptBox[">", "2"]}], 
           RowBox[{"<", "xx", ">", 
            RowBox[{"-", 
             RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}], ")"}]}], " ", "=",
        "  ", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Sigma]", "2"], "N"], " ", 
        FractionBox["1", 
         RowBox[{"<", "xx", ">", 
          RowBox[{"-", 
           RowBox[{"<", "x", ">", "<", "x", ">"}]}]}]]}]}]}], ","}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"slope", "[", " ", "arr_", " ", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"N", ",", "x", ",", "y", ",", "xx", ",", "yy", ",", "xy"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xx", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xy", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        FractionBox[
         RowBox[{"xy", " ", "-", 
          RowBox[{"x", " ", "*", "  ", "y"}]}], 
         RowBox[{"xx", " ", "-", 
          RowBox[{"x", " ", "*", " ", "x"}]}]]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intercept", "[", " ", "arr_", " ", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"N", ",", "x", ",", "y", ",", "xx", ",", "yy", ",", "xy"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xx", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xy", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        FractionBox[
         RowBox[{
          RowBox[{"y", " ", "xx"}], "-", 
          RowBox[{"x", " ", "xy"}]}], 
         RowBox[{"xx", " ", "-", 
          RowBox[{"x", " ", "x"}]}]]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linav", "[", " ", "arr_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"arr", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Mean"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ilinear", "[", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "N", ",", "x", ",", "y", ",", "xx", ",", "yy", ",", "xy", ",", " ", 
         "slop", ",", " ", "inter", ",", " ", "avera", ",", " ", "pred", ",", 
         " ", "sigma2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xx", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], " ", "/", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xy", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yy", "=", 
         RowBox[{
          RowBox[{"Total", "[", " ", 
           RowBox[{
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "]"}], " ", "/",
           "N"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"slop", " ", "=", " ", 
         FractionBox[
          RowBox[{"xy", " ", "-", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{"xx", " ", "-", 
           RowBox[{"x", " ", "x"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inter", "=", 
         FractionBox[
          RowBox[{
           RowBox[{"y", " ", "xx"}], "-", 
           RowBox[{"x", " ", "xy"}]}], 
          RowBox[{"xx", " ", "-", 
           RowBox[{"x", " ", "x"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sigma2", " ", "=", " ", 
         RowBox[{"yy", "-", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"inter", " ", "y"}], "+", 
             RowBox[{"slop", " ", "xy"}]}], " ", ")"}]}], "+", 
          SuperscriptBox["inter", "2"], "+", 
          RowBox[{"2", "inter", " ", "slop", " ", "x"}], " ", "+", " ", 
          RowBox[{
           SuperscriptBox["slop", "2"], "xx"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"<|", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<slope\>\"", "\[Rule]", " ", "slop"}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"\"\<intercept\>\"", "\[Rule]", " ", "inter"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<average\>\"", " ", "\[Rule]", "   ", "y"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<averageY\>\"", " ", "\[Rule]", "   ", "y"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<averageX\>\"", " ", "\[Rule]", "   ", "x"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<delta\>\"", " ", "\[Rule]", " ", 
           RowBox[{"slop", 
            SqrtBox[
             RowBox[{"xx", "-", 
              RowBox[{"x", " ", "x"}]}]]}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<predicted\>\"", " ", "\[Rule]", " ", 
           FractionBox[
            RowBox[{
             RowBox[{"x", " ", "xy"}], "-", 
             RowBox[{"xx", " ", "y"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", " ", "xy"}], "+", 
                RowBox[{"x", " ", "y"}]}], ")"}], " ", 
              RowBox[{"arr", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
            RowBox[{
             SuperscriptBox["x", "2"], "-", "xx"}]]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<f\>\"", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"inter", " ", "+", " ", 
              RowBox[{"#", " ", "slop"}]}], " ", "&"}], " ", ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<delta2\>\"", " ", "\[Rule]", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              FractionBox["sigma2", "N"], " ", 
              RowBox[{"(", " ", 
               RowBox[{"1", "+", " ", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"#", "-", "x"}], ")"}], "2"], 
                 RowBox[{"xx", " ", "-", 
                  RowBox[{"x", " ", "x", " "}]}]]}], ")"}]}], "&"}], ")"}]}], 
          " ", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<deltaa2\>\"", " ", "\[Rule]", " ", 
           RowBox[{"(", " ", 
            RowBox[{
             FractionBox["sigma2", "N"], "  ", 
             FractionBox["xx", 
              RowBox[{"xx", " ", "-", 
               RowBox[{"x", " ", "x", " "}]}]]}], " ", ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<deltab2\>\"", " ", "\[Rule]", "  ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["sigma2", "N"], "  ", 
             FractionBox["1", 
              RowBox[{"xx", " ", "-", 
               RowBox[{"x", " ", "x", " "}]}]]}], ")"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "|>"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ilinear", "[", 
      RowBox[{"what_", "?", "StringQ"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ilinear", "[", "#", "]"}], "[", "what", "]"}], ")"}], 
      "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ilinear", "[", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ilinear", "[", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], "//", "Keys"}]}], 
    ";"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"clasterize", " ", "etc"}], " ", "*)"}], "Subsection"], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"intelligenttrim", "[", " ", 
      RowBox[{"arr_", ",", " ", 
       RowBox[{"win_", "?", "ArrayQ"}]}], " ", "]"}], ":=", 
     RowBox[{"arr", "//", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", " ", "arr", "]"}], " ", "\[GreaterEqual]", 
         "  ", 
         RowBox[{
          RowBox[{"Total", "[", "win", "]"}], "-", "1"}]}], " ", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"win", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ";;", 
            RowBox[{"-", 
             RowBox[{"win", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], "&"}], ",", 
        "  ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", " ", "arr", "]"}], " ", "\[GreaterEqual]", 
           "  ", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"win", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], "]"}]}], 
                "]"}], ",", " ", 
               RowBox[{"Max", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"win", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "]"}]}], 
                "]"}]}], "}"}], " ", "]"}], "-", "1"}]}], " ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"win", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "]"}]}], "]"}],
               ";;", 
              RowBox[{"-", 
               RowBox[{"Max", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"win", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], "]"}]}], 
                "]"}]}]}], " ", "]"}], "]"}], "&"}], ",", "  ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Median", "[", "#", "]"}], "}"}], "&"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intelligenttrim", "[", " ", 
      RowBox[{"win_", "?", "ArrayQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"intelligenttrim", "[", 
       RowBox[{"#", ",", " ", "win"}], " ", "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"clasterize", "[", 
      RowBox[{"dat_", ",", " ", "field_", ",", " ", 
       RowBox[{"win_", "?", "ArrayQ"}]}], "]"}], " ", ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dat", "//", " ", 
           RowBox[{"keep", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", " ", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "field"}], 
               " ", "]"}], "<", "0.001"}], " ", "&"}], "  ", "]"}]}], " ", "//",
           "  ", 
          RowBox[{"map", "[", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"#", "[", "2", "]"}], "&"}], " ", "}"}], " ", "]"}]}], 
         " ", "//", "Flatten"}], "//", "Sort"}], " ", "//", " ", 
       RowBox[{"intelligenttrim", "[", "win", "]"}]}], "//", " ", "Mean"}]}], 
    " ", ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"clasterize", "[", 
      RowBox[{"dat_", ",", " ", "field_", ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}]}], "]"}], " ", ":=", "  ", 
     RowBox[{"clasterize", "[", 
      RowBox[{"dat", ",", " ", "field", ",", " ", 
       RowBox[{"{", 
        RowBox[{"win", ",", "win"}], "}"}]}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"clasterize", "[", 
      RowBox[{"dat_", ",", " ", "field_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"clasterize", "[", 
      RowBox[{"dat", ",", " ", "field", ",", " ", "3"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"clasterize", "[", "dat_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"xs", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"dat", " ", "//", " ", 
            RowBox[{"map", "[", " ", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"#", "[", "1", "]"}], "&"}], " ", "}"}], " ", "]"}]}], 
           " ", "//", " ", "Flatten"}], " ", "//", " ", 
          "DeleteDuplicates"}]}], " ", "\[IndentingNewLine]", "}"}], ",", " ",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "  ", 
           RowBox[{"clasterize", "[", 
            RowBox[{"dat", ",", " ", "#", " ", ",", " ", "1"}], "]"}]}], " ", 
          "}"}], "&"}], " ", "/@", " ", "xs"}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"poormanclusterize", "[", " ", "dat_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xs", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"dat", " ", "//", " ", 
             RowBox[{"map", "[", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"#", "[", "1", "]"}], "&"}], " ", "}"}], " ", "]"}]}],
             " ", "//", " ", "Flatten"}], " ", "//", " ", 
           "DeleteDuplicates"}]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"adata", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "\[Rule]", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", ")"}], "&"}], " ", "/@",
               " ", "dat"}], " ", ")"}], " ", "//", 
            RowBox[{"DeleteDuplicatesBy", "[", " ", 
             RowBox[{
              RowBox[{"Key", "[", "#", "]"}], "&"}], "]"}]}], "//", 
           "Association"}]}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", " ", 
           RowBox[{"adata", "[", "#", "]"}]}], "  ", "}"}], "&"}], " ", "/@", 
        " ", "xs"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"running", " ", "slope"}], " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]slope", "[", " ", "win_", "]"}], " ", ":=",
      " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]slope", "[", " ", 
       RowBox[{"#", ",", " ", "win"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]slope", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", "win_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mean", "[", " ", 
          RowBox[{"arr", "[", 
           RowBox[{"[", " ", 
            RowBox[{
             RowBox[{"n", ";;", 
              RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", "1"}], 
            "]"}], "]"}], "]"}], " ", ",", "  ", "\[IndentingNewLine]", 
         RowBox[{"slope", "[", " ", 
          RowBox[{"arr", "[", 
           RowBox[{"[", " ", 
            RowBox[{
             RowBox[{"n", ";;", 
              RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", "All"}], 
            "]"}], "]"}], " ", "]"}]}], " ", "\[IndentingNewLine]", "}"}], 
       " ", ",", 
       RowBox[{"{", " ", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"alen", "[", "arr", "]"}], "-", "win"}]}], "}"}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "fancy\[CenterEllipsis]running\[CenterEllipsis]slope", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", "win_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sl", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"arr", "[", 
              RowBox[{"[", " ", 
               RowBox[{
                RowBox[{"n", ";;", 
                 RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", 
                "All"}], "]"}], "]"}], "//", "slope"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "arr", "]"}], "-", "win"}]}], "}"}]}], 
           " ", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"field", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"Total", "[", " ", 
               RowBox[{"arr", "[", 
                RowBox[{"[", " ", 
                 RowBox[{
                  RowBox[{"n", ";;", 
                   RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", 
                  "1"}], "]"}], "]"}], "]"}], " "}], "win"], ",", 
            RowBox[{"{", " ", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "arr", "]"}], "-", "win"}]}], "}"}]}], 
           " ", "]"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", " ", 
         RowBox[{
          RowBox[{"{", "field", "}"}], ",", " ", 
          RowBox[{"{", "sl", "}"}]}], "]"}], "\[Transpose]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "running\[CenterEllipsis]log\[CenterEllipsis]slope", "[", " ", "win_", 
      "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"running\[CenterEllipsis]log\[CenterEllipsis]slope", "[", " ", 
       RowBox[{"#", ",", " ", "win"}], "]"}], "&"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"running\[CenterEllipsis]log\[CenterEllipsis]slope", "[", " ", 
      RowBox[{"arr_", ",", " ", "win_"}], "]"}], " ", ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sl", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"slope", "[", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", " ", 
                RowBox[{
                 RowBox[{"n", ";;", 
                  RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", 
                 "All"}], "]"}], "]"}], " ", "]"}], "]"}], " ", ",", 
            RowBox[{"{", " ", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{
               RowBox[{"alen", "[", "arr", "]"}], "-", "win"}]}], "}"}]}], 
           " ", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"field", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"Total", "[", " ", 
               RowBox[{"arr", "[", 
                RowBox[{"[", " ", 
                 RowBox[{
                  RowBox[{"n", ";;", 
                   RowBox[{"n", "+", "win"}], ";;", "1"}], " ", ",", " ", 
                  "1"}], "]"}], "]"}], "]"}], " "}], "win"], ",", 
            RowBox[{"{", " ", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{
               RowBox[{"alen", "[", "arr", "]"}], "-", "win"}]}], "}"}]}], 
           " ", "]"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", " ", 
         RowBox[{
          RowBox[{"{", "field", "}"}], ",", " ", 
          RowBox[{"{", "sl", "}"}]}], "]"}], "\[Transpose]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
      StyleBox[
       RowBox[{"Find", " ", "optimal", " ", "phase"}],
       FontSize->36], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "n"], 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], "-", 
          "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "n"], 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], "-", 
          "A"}], ")"}]}], " ", "\[Rule]", " ", "min"}], " ", "\n", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "n"], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], "=", "A"}], 
      "\n", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", "n"], 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], "-", 
            "A"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", "n"], 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], "-", 
            "A"}], ")"}]}], " ", ",", " ", "\[Psi]"}], "]"}], "//", 
       "FullSimplify"}], "\n", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "-", 
          SubscriptBox["\[Phi]", "n"]}], "]"}], " ", 
        SubscriptBox["r", "n"], " ", 
        RowBox[{"(", 
         RowBox[{"A", "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "-", 
             SubscriptBox["\[Phi]", "n"]}], "]"}], " ", 
           SubscriptBox["r", "n"]}]}], ")"}]}], "//", "TrigExpand"}], "\n", 
      RowBox[{
       RowBox[{"2", " ", "A", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        SubscriptBox["r", "n"]}], "+", 
       RowBox[{"2", " ", "A", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        SubscriptBox["r", "n"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "n"], "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
        SubsuperscriptBox["r", "n", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        SubsuperscriptBox["r", "n", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "n"], "]"}], " ", 
        SubsuperscriptBox["r", "n", "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "n"], "]"}], "2"], " ", 
        SubsuperscriptBox["r", "n", "2"]}]}], "\n", 
      RowBox[{
       RowBox[{"2", " ", "A", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
        RowBox[{"\[LeftAngleBracket]", 
         SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "+", 
       RowBox[{"2", " ", "A", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"\[LeftAngleBracket]", 
         SubscriptBox["im", "n"], "\[RightAngleBracket]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"\[LeftAngleBracket]", 
         SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], " ", 
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          SubscriptBox["re", "n"], 
          SubscriptBox["im", "n"]}], "\[RightAngleBracket]"}]}], "+", 
       RowBox[{"2", "  ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], "  ", 
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          SubscriptBox["re", "n"], 
          SubscriptBox["im", "n"]}], "\[RightAngleBracket]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], "  ", 
        RowBox[{"\[LeftAngleBracket]", 
         SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}]}]}], 
      "\n", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "n"], 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "n"], "-", "\[Psi]"}], "]"}]}], " ", "//", 
       "TrigExpand"}], "\n", 
      RowBox[{"A", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox["im", "n"], "\[RightAngleBracket]"}]}]}]}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "A", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "+", 
         RowBox[{"2", " ", "A", " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox["im", "n"], "\[RightAngleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], " ", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            SubscriptBox["re", "n"], 
            SubscriptBox["im", "n"]}], "\[RightAngleBracket]"}]}], "+", 
         RowBox[{"2", "  ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], "  ", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            SubscriptBox["re", "n"], 
            SubscriptBox["im", "n"]}], "\[RightAngleBracket]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}], "  ", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}]}]}], 
        " ", "/.", " ", 
        RowBox[{"A", "\[Rule]", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Psi]", "]"}], "  ", 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["im", "n"], "\[RightAngleBracket]"}]}]}]}]}], " ", "//",
        "FullSimplify"}], "\n", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["im", "n"], "\[RightAngleBracket]"}], " ", 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "-", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            SubscriptBox["im", "n"], " ", 
            SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["im", "n"], "\[RightAngleBracket]"}], "2"], "-", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}], "-", 
          SuperscriptBox[
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox["re", "n"], "\[RightAngleBracket]"}], "2"], "+", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], 
         ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], "\n", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox["im", "n"], "\[RightAngleBracket]"}], " ", 
             RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}], "-", 
            RowBox[{"\[LeftAngleBracket]", 
             RowBox[{
              SubscriptBox["im", "n"], " ", 
              SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}]}], ")"}]}], 
         
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["im", "n"], "\[RightAngleBracket]"}], "2"], "-", 
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}], "-", 
           
           SuperscriptBox[
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["re", "n"], "\[RightAngleBracket]"}], "2"], "+", 
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], 
          ")"}]]}], " ", "=", " ", 
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]]}], "\n", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]], "=", " ", 
       RowBox[{
        RowBox[{"2", 
         FractionBox[
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             SubscriptBox["im", "n"], " ", 
             SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}], "-", " ", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["im", "n"], "\[RightAngleBracket]"}], " ", 
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["re", "n"], "\[RightAngleBracket]"}]}]}], 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}], "-", 
           
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}], "-", 
           
           SuperscriptBox[
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["re", "n"], "\[RightAngleBracket]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox["im", "n"], "\[RightAngleBracket]"}], "2"]}]]}], 
        "  ", "=", 
        RowBox[{"2", " ", 
         FractionBox[
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             SubscriptBox["im", "n"], " ", 
             SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}], 
           "\[RightAngleBracket]"}], 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{"\[LeftAngleBracket]", 
             SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}], 
            "\[RightAngleBracket]"}], "-", 
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{"\[LeftAngleBracket]", 
             SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}], 
            "\[RightAngleBracket]"}]}]]}]}]}], "  ", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "-", 
          SubscriptBox["\[Phi]", "n"]}], "]"}], " ", 
        SubscriptBox["r", "n"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "-", 
            SubscriptBox["\[Phi]", "n"]}], "]"}], " ", 
          SubscriptBox["r", "n"]}], ")"}]}], "//", "TrigExpand"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[LeftAngleBracket]", 
          SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], "-", 
        
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], " ", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           SubscriptBox["im", "n"], " ", 
           SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], " ", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           SubscriptBox["im", "n"], " ", 
           SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[LeftAngleBracket]", 
          SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}]}]}], 
       " ", "//", "FullSimplify"}], "\n", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"2", " ", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           SubscriptBox["im", "n"], " ", 
           SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}]}], 
          "+", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}], 
         ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             SubscriptBox["im", "n"], " ", 
             SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[LeftAngleBracket]", 
            SubsuperscriptBox["im", "n", "2"], "\[RightAngleBracket]"}]}], 
          "+", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}]}]]}], 
       "+", 
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]]}], "\n", 
      RowBox[{
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Psi]"}], "]"}]], "=", 
       RowBox[{"2", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            SubscriptBox["im", "n"], " ", 
            SubscriptBox["re", "n"]}], "\[RightAngleBracket]"}], " "}], 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["re", "n", "2"], "\[RightAngleBracket]"}], "-", 
          RowBox[{"\[LeftAngleBracket]", 
           SubsuperscriptBox["im", "n", "2"], 
           "\[RightAngleBracket]"}]}]]}]}]}], "Subsection"], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"optphase", "[", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "re", ",", " ", "im", ",", " ", "rere", ",", " ", "imim", ",", " ", 
         "reim"}], "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"re", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Re", "[", "#", "]"}], " ", "&"}], "/@", " ", "arr"}], 
           " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"im", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "#", "]"}], " ", "&"}], "/@", " ", "arr"}], 
           " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"rere", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], 
              RowBox[{"Re", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"imim", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", "#", "]"}], 
              RowBox[{"Im", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"reim", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], 
              RowBox[{"Im", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"ArcTan", "[", " ", 
          RowBox[{"2", 
           FractionBox[
            RowBox[{"reim", " ", "-", " ", 
             RowBox[{"re", "*", "im"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rere", " ", "-", " ", 
               RowBox[{"re", "*", "re"}]}], " ", ")"}], "-", " ", 
             RowBox[{"(", 
              RowBox[{"imim", "-", 
               RowBox[{"im", "*", "im"}]}], ")"}]}]]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"optphase0", "[", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "re", ",", " ", "im", ",", " ", "rere", ",", " ", "imim", ",", " ", 
         "reim"}], "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"re", "=", "0"}], ";", "  ", "\[IndentingNewLine]", 
        RowBox[{"im", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"rere", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], 
              RowBox[{"Re", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"imim", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", "#", "]"}], 
              RowBox[{"Im", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"reim", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], 
              RowBox[{"Im", "[", "#", "]"}]}], " ", "&"}], "/@", " ", "arr"}],
            " ", ")"}], "//", "Mean"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"ArcTan", "[", " ", 
          RowBox[{"2", 
           FractionBox[
            RowBox[{"reim", " ", "-", " ", 
             RowBox[{"re", "*", "im"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rere", " ", "-", " ", 
               RowBox[{"re", "*", "re"}]}], " ", ")"}], "-", " ", 
             RowBox[{"(", 
              RowBox[{"imim", "-", 
               RowBox[{"im", "*", "im"}]}], ")"}]}]]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"optphasefix", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"\[Psi]_", "?", "NumberQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"arr", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Psi]"}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"optphasefix", "[", 
      RowBox[{"\[Psi]_", "?", "NumberQ"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"optphasefix", "[", 
       RowBox[{"#", ",", " ", "\[Psi]"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"optphasefix", "[", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"optphasefix", "[", 
       RowBox[{"optphase", "[", "arr", "]"}], "]"}], "[", "arr", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->24], 
   StyleBox[
    RowBox[{"(*", " ", "plotting", " ", "*)"}], "Subsection",
    FontSize->24], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totwosigdigits", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"x", "//", 
      RowBox[{
       RowBox[{"Round", "[", " ", 
        RowBox[{"#", " ", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Piecewise", "[", " ", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.001", ",", " ", 
              RowBox[{"x", "<", "0.01"}]}], "}"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", 
              RowBox[{"0", "<", "x", "<", "1"}]}], "}"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", " ", 
              RowBox[{"1", "\[LessEqual]", " ", "x", "<", "10"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"10", "\[LessEqual]", " ", "x", "<", "100"}]}], "}"}], 
            " ", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"10", ",", " ", 
              RowBox[{"100", "\[LessEqual]", " ", "x", "<", "1000"}]}], "}"}],
             ",", " ", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"100", ",", " ", 
              RowBox[{"1000", "\[LessEqual]", " ", "x"}]}], "}"}]}], " ", 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "&"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "AssociationQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"size_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"colors_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       "func_"}], " ", "\[IndentingNewLine]", "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"tee", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "//", "func"}], ",", " ", 
                  "acc"}], "]"}], "]"}], "<>", "suffix"}], ",", " ", "size", 
              ",", " ", 
              RowBox[{"color", "\[Rule]", " ", 
               RowBox[{
                RowBox[{"colorrange", "[", 
                 RowBox[{"colors", ",", 
                  RowBox[{"(", 
                   RowBox[{"arr", "//", "Values"}], ")"}]}], "]"}], "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], " ", "]"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              FractionBox[
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "scale"]}], "}"}]}], " ", 
           "]"}], "&"}], "/@", " ", 
         RowBox[{"(", 
          RowBox[{"arr", "//", "Normal"}], ")"}]}], " ", "}"}], "//", 
       "Flatten"}], "//", "Graphics"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"size_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"colors_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       "func_"}], "\[IndentingNewLine]", "]"}], ":=", " ", 
     RowBox[{"leg", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr", " ", "//", "toAlist"}], ",", "\[IndentingNewLine]", 
       "suffix", " ", ",", " ", "\[IndentingNewLine]", "acc", " ", ",", 
       "\[IndentingNewLine]", "size", " ", ",", " ", "\[IndentingNewLine]", 
       "scale", " ", ",", "\[IndentingNewLine]", "colors", ",", 
       "\[IndentingNewLine]", "func"}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"size_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"colors_", "?", "ArrayQ"}]}], "\[IndentingNewLine]", "]"}], ":=",
      " ", 
     RowBox[{"leg", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr", " ", "//", "toAlist"}], ",", "\[IndentingNewLine]", 
       "suffix", " ", ",", " ", "\[IndentingNewLine]", "acc", " ", ",", 
       "\[IndentingNewLine]", "size", " ", ",", " ", "\[IndentingNewLine]", 
       "scale", " ", ",", "\[IndentingNewLine]", "colors", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"#", "&"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", "  ", 
     RowBox[{"leg", "[", " ", 
      RowBox[{
      "arr", ",", "\"\<\>\"", ",", " ", "1", ",", "20", ",", " ", "50", ",", 
       " ", "mycolors1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{"arr_", "?", "AssociationQ"}], "]"}], ":=", "  ", 
     RowBox[{"leg", "[", " ", 
      RowBox[{
      "arr", ",", "\"\<\>\"", ",", " ", "1", ",", "20", ",", " ", "50", ",", 
       "mycolors1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{"scale_", "?", "NumberQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "\"\<\>\"", ",", "1", ",", " ", "20", ",", " ", "scale", ",",
         "mycolors1"}], "]"}], "&"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{
       RowBox[{"scale_", "?", "NumberQ"}], ",", 
       RowBox[{"acc_", "?", "NumberQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "\"\<\>\"", ",", "acc", ",", " ", "20", ",", " ", "scale", 
        ",", "mycolors1"}], "]"}], "&"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", 
      RowBox[{
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", 
       RowBox[{"acc_", "?", "NumberQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "acc", ",", " ", "20", ",", " ", "scale", ",",
         "mycolors1"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", 
      RowBox[{
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", " ", "func_"}], "]"}], ":=", 
     "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "acc", ",", " ", "20", ",", " ", "scale", ",",
         "mycolors1", ",", "func"}], "]"}], "&"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{
       RowBox[{"suffix_", "?", "StringQ"}], ",", 
       RowBox[{"scale_", "?", "NumberQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "scale", ",", 
        "mycolors1"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{
       RowBox[{"scale_", "?", "NumberQ"}], ",", 
       RowBox[{"suffix_", "?", "StringQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "scale", ",", 
        "mycolors1"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg", "[", " ", 
      RowBox[{"suffix_", "?", "StringQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "100", ",", 
        "mycolors1"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{"arr_", "?", "AssociationQ"}], "]"}], ":=", "  ", 
     RowBox[{"leg", "[", " ", 
      RowBox[{
      "arr", ",", "\"\<\>\"", ",", " ", "1", ",", "20", ",", " ", "50", ",", 
       "mycolors2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", "  ", 
     RowBox[{"leg", "[", " ", 
      RowBox[{
      "arr", ",", "\"\<\>\"", ",", " ", "1", ",", "20", ",", " ", "50", ",", 
       " ", "mycolors2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{"scale_", "?", "NumberQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "\"\<\>\"", ",", "1", ",", " ", "20", ",", " ", "scale", ",",
         "mycolors2"}], "]"}], "&"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{
       RowBox[{"suffix_", "?", "StringQ"}], ",", 
       RowBox[{"scale_", "?", "NumberQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "scale", ",", 
        "mycolors2"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{
       RowBox[{"scale_", "?", "NumberQ"}], ",", 
       RowBox[{"suffix_", "?", "StringQ"}]}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "scale", ",", 
        "mycolors2"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg2", "[", " ", 
      RowBox[{"suffix_", "?", "StringQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg", "[", " ", 
       RowBox[{
       "#", ",", "suffix", ",", "1", ",", " ", "20", ",", " ", "100", ",", 
        "mycolors2"}], "]"}], "&"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg0", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "AssociationQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"size_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"colors_", "?", "ArrayQ"}]}], "\[IndentingNewLine]", "]"}], ":=",
      "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"tee", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"totwosigdigits", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "<>", 
               "suffix"}], ",", " ", "size", ",", " ", 
              RowBox[{"color", "\[Rule]", " ", 
               RowBox[{
                RowBox[{"colorrange", "[", 
                 RowBox[{"colors", ",", 
                  RowBox[{"(", 
                   RowBox[{"arr", "//", "Values"}], ")"}]}], "]"}], "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], " ", "]"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              FractionBox[
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "scale"]}], "}"}]}], " ", 
           "]"}], "&"}], "/@", " ", 
         RowBox[{"(", 
          RowBox[{"arr", "//", "Normal"}], ")"}]}], " ", "}"}], "//", 
       "Flatten"}], "//", "Graphics"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg0", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"suffix_", "?", "StringQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"acc_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"size_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"scale_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"colors_", "?", "ArrayQ"}]}], "\[IndentingNewLine]", "]"}], ":=",
      " ", 
     RowBox[{"leg0", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr", " ", "//", "toAlist"}], ",", "\[IndentingNewLine]", 
       "suffix", " ", ",", " ", "\[IndentingNewLine]", "acc", " ", ",", 
       "\[IndentingNewLine]", "size", " ", ",", " ", "\[IndentingNewLine]", 
       "scale", " ", ",", "\[IndentingNewLine]", "colors"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leg0", "[", " ", 
      RowBox[{"scale_", "?", "NumberQ"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"leg0", "[", " ", 
       RowBox[{
       "#", ",", "\"\<\>\"", ",", "1", ",", " ", "20", ",", " ", "scale", ",",
         "mycolors1"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   
   StyleBox[
    RowBox[{
     RowBox[{"std", "=", 
      RowBox[{
       RowBox[{"{", "}"}], "//", "Association"}]}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[" ",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}], " ", "=", " ", 
      "\"\<Regular\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[" ",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontname\>\"", "]"}], " ", "=", " ", 
      "\"\<Andale Mono\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], "\[IndentingNewLine]", 
   StyleBox[" ",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}], " ", "=", " ", 
      "\"\<Regular\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[" ",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontname\>\"", "]"}], " ", "=", " ", 
      "\"\<Calibri\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}], " ", "=", " ", 
      "\"\<Regular\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[" ",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"std", "[", "\"\<fontname\>\"", "]"}], " ", "=", " ", 
      "\"\<Source Sans Pro\>\""}], ";"}],
    FontSize->12,
    FontWeight->"SemiBold"], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "tee", "]"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<font\>\"", "\[Rule]", 
        RowBox[{"std", "[", "\"\<fontname\>\"", "]"}]}], " ", ",", "  ", 
       RowBox[{"\"\<weight\>\"", "\[Rule]", " ", 
        RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}]}], " ", ",", " ", 
       RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}], ",", "  ", 
       RowBox[{"\"\<str\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tee", "[", 
      RowBox[{"t_", ",", 
       RowBox[{"s_:", "20"}], ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"str", "=", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"StringQ", "[", "t", "]"}], ",", " ", "t", ",", "  ", 
           RowBox[{"ToString", "[", "t", "]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"str", ",", "\[IndentingNewLine]", 
         RowBox[{"FontSize", "\[Rule]", "s"}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FontFamily", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<font\>\"", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<color\>\"", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"FontWeight", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<weight\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tee", "[", " ", 
      RowBox[{
       RowBox[{"s_", "?", "NumericQ"}], " ", ",", " ", "rest__"}], "]"}], " ",
      ":=", " ", 
     RowBox[{
      RowBox[{"tee", "[", " ", 
       RowBox[{"#", ",", " ", "s", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", "rest", "}"}]}]}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"chai", "[", 
      RowBox[{
       RowBox[{"str_", "?", "StringQ"}], ",", " ", 
       RowBox[{"inopts_", "?", "AssociationQ"}]}], " ", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", " ", "opts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opts", "=", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<font\>\"", " ", "\[Rule]", " ", "\"\<Helvetica\>\""}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<fontsize\>\"", "\[Rule]", "13"}]}], 
          "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"opts", "[", "#", "]"}], "=", 
            RowBox[{"inopts", "[", "#", "]"}]}], ")"}], "&"}], "/@", " ", 
         RowBox[{"Keys", "[", "inopts", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"str", ",", "\[IndentingNewLine]", 
          RowBox[{"FontSize", "\[Rule]", 
           RowBox[{"opts", "[", "\"\<fontsize\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FontFamily", "\[Rule]", 
           RowBox[{"opts", "[", "\"\<font\>\"", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"FontColor", "\[Rule]", 
           RowBox[{"opts", "[", "\"\<color\>\"", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"chai", "[", 
      RowBox[{
       RowBox[{"num_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"inopts_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{"chai", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "num", "]"}], ",", " ", "inopts"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"chai", "[", " ", 
      RowBox[{"inopts_", "?", "AssociationQ"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"chai", "[", 
       RowBox[{"#", ",", " ", "inopts"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expand", "[", 
      RowBox[{
       RowBox[{"points_", "?", "ArrayQ"}], ",", "by_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"center", "=", 
         RowBox[{"Mean", "[", "points", "]"}]}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"center", " ", "+", " ", 
          RowBox[{"by", 
           RowBox[{"(", 
            RowBox[{"#", "-", "center"}], ")"}]}]}], "&"}], "/@", 
        "points"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"expand", "[", "by_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"expand", "[", 
       RowBox[{"#", ",", "by"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotrange", "[", "aaa_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "All"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", "All"}], "]"}], "]"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dx", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dy", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}]}]}], " ", 
          "\[IndentingNewLine]", "}"}], "&"}], "/@", " ", 
        RowBox[{"{", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Options", "[", 
             RowBox[{"aaa", ",", " ", "PlotRange"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//", "Values"}], ")"}], "}"}]}], 
       ")"}], "//", "Association"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pmlegend", "[", " ", 
      RowBox[{"hash_", ",", " ", "pos_", ",", "stepy_", ",", " ", "font_"}], 
      "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"posns", "=", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", " ", 
               RowBox[{"nn", " ", "stepy"}]}]}], " ", "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"nn", ",", "0", ",", 
              RowBox[{
               RowBox[{"alen", "[", " ", 
                RowBox[{"Normal", "[", "hash", "]"}], "]"}], "-", "1"}]}], 
             " ", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"arr", "=", " ", 
          RowBox[{"Normal", "[", "hash", "]"}]}]}], "\[IndentingNewLine]", 
        "}"}], " ", ",", "  ", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"Text", "[", " ", 
          RowBox[{
           RowBox[{"tee", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"arr", "[", 
               RowBox[{"[", "nn", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "font", ",", " ", 
             RowBox[{"color", "\[Rule]", "  ", 
              RowBox[{
               RowBox[{"arr", "[", 
                RowBox[{"[", "nn", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "]"}], ",", " ", 
           RowBox[{"posns", "[", 
            RowBox[{"[", 
             RowBox[{"nn", ",", " ", "All"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"nn", ",", "1", ",", 
           RowBox[{"alen", "[", " ", "arr", "]"}]}], "}"}]}], " ", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"showpmlegend", "[", 
      RowBox[{"hash_", ",", " ", "pos_", ",", "stepy_", ",", " ", "font_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Show", "[", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", " ", 
         RowBox[{"pmlegend", "[", 
          RowBox[{"hash", ",", " ", "pos", ",", "stepy", ",", " ", "font"}], 
          "]"}], "}"}], "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colors", "=", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.25, 0.4, 1.], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.16666666666666669`, 0.2666666666666667, 0.6666666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.25, 0.4, 1.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.25, 0.4, 1.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.25, 0.4, 1.],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.17, 0.79, 1.], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.11333333333333334`, 0.5266666666666667, 0.6666666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.17, 0.79, 1.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.17, 0.79, 1.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.17, 0.79, 1.],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.67, 0.81, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.4466666666666667, 0.54, 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.67, 0.81, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.67, 0.81, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.67, 0.81, 0.08],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.68, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.45333333333333337`, 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.68, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.68, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.68, 0.08],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.51, 0.19], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.34, 0.12666666666666668`],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.51, 0.19]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.51, 0.19]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.51, 0.19],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.05, 0.52], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.03333333333333334, 0.3466666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.05, 0.52]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.05, 0.52]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.05, 0.52],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.75, 0, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            FrameStyle->RGBColor[0.5, 0., 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.75, 0, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.75, 0, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.75, 0, 0.08],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.45, 0., 0.8], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            FrameStyle->RGBColor[0.30000000000000004`, 0., 0.5333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.45, 0., 0.8]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.45, 0., 0.8]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.45, 0., 0.8],
        Editable->False,
        Selectable->False]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colors", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.54, 0.6], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666667, 0.36000000000000004`, 0.4],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.54, 0.6]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.54, 0.6]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.54, 0.6],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.35000000000000003`, 0.37], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.6666666666666667, 0.23333333333333336`, 0.24666666666666667`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.35000000000000003, 0.37]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.35000000000000003`, 0.37]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.35000000000000003`, 0.37],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.31, 0.35000000000000003`], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.6666666666666667, 0.20666666666666667`, 0.23333333333333336`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.31, 0.35000000000000003]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.31, 0.35000000000000003`]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.31, 0.35000000000000003`],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.87, 0., 0.39], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.5800000000000001, 0., 0.26],
           FrameTicks->None,
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.87, 0., 0.39]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.87, 0., 0.39]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.87, 0., 0.39],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.77, 0., 0.5700000000000001], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.5133333333333334, 0., 0.38000000000000006`],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.77, 0., 0.5700000000000001]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.77, 0., 0.5700000000000001]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.77, 0., 0.5700000000000001],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.58, 0., 0.54], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.38666666666666666`, 0., 0.36000000000000004`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.58, 0., 0.54]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.58, 0., 0.54]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.58, 0., 0.54],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0., 0.6900000000000001, 0.8300000000000001], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.4600000000000001, 0.5533333333333335],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0., 0.6900000000000001, 0.8300000000000001]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0., 0.6900000000000001, 0.8300000000000001]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0., 0.6900000000000001, 0.8300000000000001],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0., 0.52, 0.6], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.3466666666666667, 0.4],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0., 0.52, 0.6]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0., 0.52, 0.6]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0., 0.52, 0.6],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0., 0.46, 0.4], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.3066666666666667, 0.2666666666666667],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0., 0.46, 0.4]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0., 0.46, 0.4]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0., 0.46, 0.4],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0., 0.29, 0.38], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0., 0.19333333333333333`, 0.25333333333333335`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0., 0.29, 0.38]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0., 0.29, 0.38]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0., 0.29, 0.38],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0., 0.58, 0.01], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0., 0.38666666666666666`, 0.006666666666666667],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0., 0.58, 0.01]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0., 0.58, 0.01]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0., 0.58, 0.01],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.59, 0.64, 0.], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.3933333333333333, 0.4266666666666667, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.59, 0.64, 0.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.59, 0.64, 0.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.59, 0.64, 0.],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.59, 0.81, 0.], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.3933333333333333, 0.54, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.59, 0.81, 0.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.59, 0.81, 0.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.59, 0.81, 0.],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.73, 0.86, 0.39], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.4866666666666667, 0.5733333333333334, 0.26],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.73, 0.86, 0.39]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.73, 0.86, 0.39]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.73, 0.86, 0.39],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.86, 0.39], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666667, 0.5733333333333334, 0.26],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.86, 0.39]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.86, 0.39]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.86, 0.39],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.77, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.6666666666666667, 0.5133333333333334, 0.05333333333333334],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.77, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.77, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.77, 0.08],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1., 0.51, 0.15], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666667, 0.34, 0.1],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1., 0.51, 0.15]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.51, 0.15]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.51, 0.15],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.9400000000000001, 0.37, 0.], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6266666666666667, 0.24666666666666667`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.9400000000000001, 0.37, 0.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.9400000000000001, 0.37, 0.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.9400000000000001, 0.37, 0.],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.88, 0.25, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.5866666666666667, 0.16666666666666669`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.88, 0.25, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.88, 0.25, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.88, 0.25, 0],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.05, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.03333333333333334, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.05, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1, 0.05, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.05, 0],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.18, 0.68, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.12, 0.45333333333333337`, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.18, 0.68, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.18, 0.68, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.18, 0.68, 0],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.85, 0.05, 0.75], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.5666666666666667, 0.03333333333333334, 0.5],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.85, 0.05, 0.75]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.85, 0.05, 0.75]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.85, 0.05, 0.75],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.22, 0.05, 0.89], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.14666666666666667`, 0.03333333333333334, 0.5933333333333334],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0.22, 0.05, 0.89]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.22, 0.05, 0.89]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.22, 0.05, 0.89],
        Editable->False,
        Selectable->False]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mycolors0", "=", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.25, 0.4, 1.], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.16666666666666669`, 0.2666666666666667, 0.6666666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.25, 0.4, 1.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.25, 0.4, 1.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.25, 0.4, 1.],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.17, 0.79, 1.], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.11333333333333334`, 0.5266666666666667, 0.6666666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.17, 0.79, 1.]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.17, 0.79, 1.]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.17, 0.79, 1.],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.67, 0.81, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.4466666666666667, 0.54, 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.67, 0.81, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.67, 0.81, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.67, 0.81, 0.08],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.68, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.45333333333333337`, 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.68, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.68, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.68, 0.08],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.51, 0.19], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.34, 0.12666666666666668`],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.51, 0.19]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.51, 0.19]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.51, 0.19],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[1., 0.05, 0.52], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            
            FrameStyle->RGBColor[
             0.6666666666666667, 0.03333333333333334, 0.3466666666666667],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[1., 0.05, 0.52]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[1., 0.05, 0.52]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1., 0.05, 0.52],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.75, 0, 0.08], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            FrameStyle->RGBColor[0.5, 0., 0.05333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.75, 0, 0.08]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.75, 0, 0.08]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.75, 0, 0.08],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          RowBox[{
           GraphicsBox[{
             {GrayLevel[0], RectangleBox[{0, 0}]}, 
             {GrayLevel[0], RectangleBox[{1, -1}]}, 
             {RGBColor[0.45, 0., 0.8], RectangleBox[{0, -1}, {2, 1}]}},
            AspectRatio->1,
            Frame->True,
            FrameStyle->RGBColor[0.30000000000000004`, 0., 0.5333333333333334],
            FrameTicks->None,
            
            ImageSize->
             Dynamic[{
              Automatic, 
               1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                Magnification])}],
            PlotRangePadding->None], "\[InvisibleSpace]"}],
          "RGBColor[0.45, 0., 0.8]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.45, 0., 0.8]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.45, 0., 0.8],
        Editable->False,
        Selectable->False]}], "}"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mycolors1", "=", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 0.566415, 0.664714], RectangleBox[{0, -1}, {2, 1}]}},
           
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0., 0.37761, 0.4431426666666667],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.566415`", ",", "0.664714`"}], "]"}], 
           NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0, 0.566415, 0.664714]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 0.566415, 0.664714],
        Editable->False,
        Selectable->False], ",", "  ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.854887, 0.336446, 0.291569], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.5699246666666666, 0.22429733333333335`, 0.19437933333333335`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.854887`", ",", "0.336446`", ",", "0.291569`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.854887, 0.336446, 0.291569]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.854887, 0.336446, 0.291569],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.881895, 0.449485, 0.139467], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.5879300000000001, 0.2996566666666667, 0.092978],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.881895`", ",", "0.449485`", ",", "0.139467`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.881895, 0.449485, 0.139467]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.881895, 0.449485, 0.139467],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.966567, 0.779812, 0.109377], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.644378, 0.5198746666666667, 0.07291800000000001],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.966567`", ",", "0.779812`", ",", "0.109377`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.966567, 0.779812, 0.109377]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.966567, 0.779812, 0.109377],
        Editable->False,
        Selectable->False], ",", " ", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.608347, 0.730373, 0.178897], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.4055646666666667, 0.48691533333333337`, 0.11926466666666667`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.608347`", ",", "0.730373`", ",", "0.178897`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.608347, 0.730373, 0.178897]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.608347, 0.730373, 0.178897],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.608347, 0.730373, 0.178897], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.4055646666666667, 0.48691533333333337`, 0.11926466666666667`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.608347`", ",", "0.730373`", ",", "0.178897`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.608347, 0.730373, 0.178897]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.608347, 0.730373, 0.178897],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.433936, 0.439765, 0.421118], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.2892906666666667, 0.2931766666666667, 0.28074533333333335`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.433936`", ",", "0.439765`", ",", "0.421118`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.433936, 0.439765, 0.421118]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.433936, 0.439765, 0.421118],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.205768, 0.162158, 0.365148], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.13717866666666667`, 0.10810533333333333`, 0.24343199999999998`],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.205768`", ",", "0.162158`", ",", "0.365148`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.205768, 0.162158, 0.365148]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.205768, 0.162158, 0.365148],
        Editable->False,
        Selectable->False]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   RowBox[{
    RowBox[{"mycolors2", "=", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.432639, 0.102602, 0.408576], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0.288426, 0.06840133333333334, 0.272384],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.432639`", ",", "0.102602`", ",", "0.408576`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.432639, 0.102602, 0.408576]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.432639, 0.102602, 0.408576],
        Editable->False,
        Selectable->False], ",", " ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.577691, 0.2822, 0.525032], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.3851273333333333, 0.18813333333333335`, 0.3500213333333334],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.577691`", ",", "0.2822`", ",", "0.525032`"}], "]"}], 
           NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.577691, 0.2822, 0.525032]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.577691, 0.2822, 0.525032],
        Editable->False,
        Selectable->False], ",", "  ", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.888991, 0.576989, 0.153613], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.5926606666666667, 0.38465933333333335`, 0.10240866666666668`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.888991`", ",", "0.576989`", ",", "0.153613`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.888991, 0.576989, 0.153613]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.888991, 0.576989, 0.153613],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.955764, 0.729625, 0.405722], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.637176, 0.48641666666666666`, 0.27048133333333335`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.955764`", ",", "0.729625`", ",", "0.405722`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.955764, 0.729625, 0.405722]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.955764, 0.729625, 0.405722],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.105226, 0.445869, 0.468772], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.07015066666666667, 0.297246, 0.3125146666666667],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.105226`", ",", "0.445869`", ",", "0.468772`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.105226, 0.445869, 0.468772]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.105226, 0.445869, 0.468772],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.185779, 0.660014, 0.651759], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.12385266666666667`, 0.44000933333333336`, 0.434506],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.185779`", ",", "0.660014`", ",", "0.651759`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.185779, 0.660014, 0.651759]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.185779, 0.660014, 0.651759],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.704265, 0.0521553, 0.26041], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.46951000000000004`, 0.0347702, 0.17360666666666666`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.704265`", ",", "0.0521553`", ",", "0.26041`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.704265, 0.0521553, 0.26041]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.704265, 0.0521553, 0.26041],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0.786313, 0.388251, 0.542184], 
             RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0.5242086666666668, 0.258834, 0.361456],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{"0.786313`", ",", "0.388251`", ",", "0.542184`"}], "]"}],
            NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = 
             RGBColor[0.786313, 0.388251, 0.542184]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0.786313, 0.388251, 0.542184],
        Editable->False,
        Selectable->False]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"x_", ",", "min_", ",", "max_", ",", " ", "colors_"}], "]"}], ":=",
      "  ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dd", ",", "nn", ",", " ", "delta", ",", "xx"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xx", "=", 
         RowBox[{"inrange", "[", 
          RowBox[{"x", ",", " ", "min", ",", "max"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dd", "=", 
         RowBox[{
          FractionBox[
           RowBox[{"max", "-", "min"}], 
           RowBox[{
            RowBox[{"Length", "[", "colors", "]"}], "-", "1"}]], 
          "1.00001"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nn", " ", "=", " ", 
         RowBox[{"Floor", "[", " ", 
          FractionBox[
           RowBox[{"xx", "-", "min"}], "dd"], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"delta", " ", "=", " ", 
         FractionBox[
          RowBox[{"xx", "-", "min", "-", 
           RowBox[{"nn", " ", "dd"}]}], "dd"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"colors", "[", 
             RowBox[{"[", 
              RowBox[{"nn", "+", "1"}], "]"}], "]"}], ",", " ", 
            RowBox[{"colors", "[", 
             RowBox[{"[", 
              RowBox[{"nn", "+", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
          "delta"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"x_", ",", "min_", ",", "max_"}], "]"}], ":=", "  ", 
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"x", ",", "min", ",", "max", ",", " ", "mycolors0"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange1", "[", " ", 
      RowBox[{"x_", ",", "min_", ",", "max_"}], "]"}], ":=", "  ", 
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"x", ",", "min", ",", "max", ",", " ", "mycolors1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange2", "[", " ", 
      RowBox[{"x_", ",", "min_", ",", "max_"}], "]"}], ":=", "  ", 
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"x", ",", "min", ",", "max", ",", " ", "mycolors2"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange", "[", " ", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"colorrange", "[", " ", 
       RowBox[{"#", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"MinMax", "[", "arr", "]"}]}]}], "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange1", "[", " ", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"colorrange1", "[", " ", 
       RowBox[{"#", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"MinMax", "[", "arr", "]"}]}]}], "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange2", "[", " ", 
      RowBox[{"arr_", "?", "ArrayQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"colorrange2", "[", " ", 
       RowBox[{"#", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"MinMax", "[", "arr", "]"}]}]}], "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorrange", "[", " ", 
      RowBox[{
       RowBox[{"colors_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"colorrange", "[", " ", 
       RowBox[{"#", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"MinMax", "[", "arr", "]"}]}], ",", "colors"}], "]"}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"quicklegend", "[", 
      RowBox[{
      "textfunc_", ",", "posfunc_", ",", " ", "name_", ",", " ", "namepos_", 
       ",", "  ", "arr_", ",", " ", "size_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Graphics", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tee", "[", " ", 
              RowBox[{
               RowBox[{"textfunc", "[", 
                RowBox[{"arr", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", "size", ",", " ", 
               RowBox[{"color", "\[Rule]", "  ", 
                RowBox[{
                 RowBox[{"colorrange", "[", "arr", "]"}], "[", 
                 RowBox[{"arr", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "]"}]}]}], " ", "]"}], "//", 
             RowBox[{"text", "[", " ", 
              RowBox[{"posfunc", "[", "#", "]"}], " ", "]"}]}], " ", ")"}], 
           "&"}], "/@", " ", 
          RowBox[{"indices", "[", "arr", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{"tee", "[", " ", 
           RowBox[{"name", ",", "size", ",", " ", 
            RowBox[{"color", "\[Rule]", "  ", "Black"}]}], " ", "]"}], "//", 
          RowBox[{"text", "[", " ", 
           RowBox[{"namepos", "[", 
            RowBox[{"posfunc", "[", " ", 
             RowBox[{"Length", "[", "arr", "]"}], "]"}], " ", "]"}], " ", 
           "]"}]}]}], "   ", "\[IndentingNewLine]", "}"}], "//", "Flatten"}], 
      " ", "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"quicklegend", "[", 
      RowBox[{
      "textfunc_", ",", "posfunc_", ",", " ", "name_", ",", " ", "namepos_", 
       ",", "  ", "arr_"}], "]"}], " ", ":=", " ", 
     RowBox[{"quicklegend", "[", 
      RowBox[{
      "textfunc", ",", "posfunc", ",", " ", "name", ",", " ", "namepos", ",", 
       "  ", "arr", ",", " ", "15"}], "]"}]}], " ", ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"quickasslegend", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"colorrange", "[", "arr", "]"}], "[", "#", "]"}]}], "&"}], 
       " ", "/@", " ", "arr"}], "//", "Association"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"quicklegend", "[", " ", "arr_", "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "textfunc", ",", "posfunc", ",", " ", "name", ",", " ", "namepos"}], 
        "}"}], ",", 
       RowBox[{"quicklegend", "[", 
        RowBox[{
        "textfunc", ",", "posfunc", ",", " ", "name", ",", " ", "namepos", 
         ",", "  ", "arr", ",", " ", "15"}], "]"}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"quicklegend", "[", " ", 
      RowBox[{"arr_", ",", " ", "size_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Function", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "textfunc", ",", "posfunc", ",", " ", "name", ",", " ", "namepos"}], 
        "}"}], ",", 
       RowBox[{"quicklegend", "[", 
        RowBox[{
        "textfunc", ",", "posfunc", ",", " ", "name", ",", " ", "namepos", 
         ",", "  ", "arr", ",", " ", "size"}], "]"}]}], " ", "]"}]}], " ", 
    ";"}], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"simple", " ", "ticks"}], " ", "*)"}], "Subsection",
    FontSize->36], 
   StyleBox[" ", "Subsection",
    FontSize->36], 
   StyleBox["\[IndentingNewLine]",
    FontFamily->"Avenir Next",
    FontSize->12,
    FontWeight->"SemiBold"], 
   StyleBox["\[IndentingNewLine]",
    FontSize->12,
    FontWeight->"SemiBold"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], 
   RowBox[{
    RowBox[{
     RowBox[{"ticksriffle", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_", ",", " ", "fontname_", ",", " ", "fontweight_"}], "]"}], ":=",
      " ", 
     RowBox[{"Riffle", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"func", "[", "#", "]"}], ",", 
           RowBox[{"tee", "[", 
            RowBox[{"#", ",", " ", "size", ",", " ", 
             RowBox[{"\"\<font\>\"", "\[Rule]", "fontname"}], ",", " ", 
             RowBox[{"\"\<weight\>\"", "\[Rule]", "fontweight"}]}], "]"}]}], 
          "}"}], "&"}], "/@", " ", 
        RowBox[{"Range", "[", " ", 
         RowBox[{"from", ",", "to", ",", " ", "majorstep"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"func", "[", "#", "]"}], ",", 
           RowBox[{"tee", "[", "\"\<\>\"", "]"}]}], "}"}], "&"}], "/@", " ", 
        RowBox[{"Range", "[", " ", 
         RowBox[{
          RowBox[{"from", "+", 
           FractionBox["majorstep", "2"]}], ",", 
          RowBox[{"to", "-", 
           FractionBox["majorstep", "2"]}], ",", " ", "majorstep"}], 
         "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksriffle", "[", 
      RowBox[{"func_", ",", " ", 
       RowBox[{"size_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"fontname_", "?", "StringQ"}], ",", " ", 
       RowBox[{"fontweight_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksriffle", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", "func", ",", 
        " ", "fontname", ",", " ", "fontweight"}], "]"}], "&"}]}], " ", ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksriffle", "[", 
      RowBox[{"func_", ",", " ", 
       RowBox[{"size_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"fontname_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksriffle", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", "func", ",", 
        " ", "fontname", ",", " ", 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}],
         FontSize->24]}], 
       StyleBox["]",
        FontSize->24]}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksriffle", "[", 
      RowBox[{"func_", ",", " ", 
       RowBox[{"size_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksriffle", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", "func", ",", 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontname\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[" ",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[",",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"]}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksriffle", "[", "func_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksriffle", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", "func", ",", 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontname\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[" ",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[",",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[" ",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"]}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticks", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"func", "[", "#", "]"}], ",", 
         RowBox[{"tee", "[", 
          RowBox[{"#", ",", " ", "size"}], "]"}]}], "}"}], "&"}], "/@", " ", 
      RowBox[{"Range", "[", " ", 
       RowBox[{"from", ",", "to", ",", " ", "majorstep"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksempty", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"func", "[", "#", "]"}], ",", 
         RowBox[{"tee", "[", "\"\<\>\"", "]"}]}], "}"}], "&"}], "/@", " ", 
      RowBox[{"Range", "[", " ", 
       RowBox[{"from", ",", "to", ",", " ", "majorstep"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksempty", "[", "func_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ticksempty", "[", 
      RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", "func"}], 
      "]"}], "&"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_"}], "]"}], ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ticksriffle", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func", ",", " ", 
         StyleBox[
          RowBox[{"std", "[", "\"\<fontname\>\"", "]"}],
          FontSize->12,
          FontWeight->"SemiBold"], 
         StyleBox[" ",
          FontSize->12,
          FontWeight->"SemiBold"], 
         StyleBox[",",
          FontSize->12,
          FontWeight->"SemiBold"], 
         StyleBox[
          RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}],
          FontSize->12,
          FontWeight->"SemiBold"]}], "]"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"ticksempty", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_", ",", " ", 
       RowBox[{"fontname_", "?", "StringQ"}], ",", " ", 
       RowBox[{"fontweight_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ticksriffle", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func", ",", " ", "fontname", ",", " ", "fontweight"}], "]"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"ticksempty", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{
       RowBox[{"size_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"fontname_", "?", "StringQ"}], ",", " ", 
       RowBox[{"fontweight_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", 
        RowBox[{"#", "&"}], ",", " ", "fontname", ",", " ", "fontweight"}], 
       "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{"size_", "?", "NumericQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", 
        RowBox[{"#", "&"}]}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{"func_", ",", " ", 
       RowBox[{"size_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", "func", ",", 
        " ", 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontname\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[" ",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[",",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[" ",
         FontSize->12,
         FontWeight->"SemiBold"], 
        StyleBox[
         RowBox[{"std", "[", "\"\<fontweight\>\"", "]"}],
         FontSize->12,
         FontWeight->"SemiBold"]}], 
       StyleBox[" ",
        FontSize->12,
        FontWeight->"SemiBold"], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", "func_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", "func"}],
        "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", 
      RowBox[{"func_", ",", " ", 
       RowBox[{"fontname_", "?", "StringQ"}], ",", " ", 
       RowBox[{"fontweight_", "?", "StringQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{
       "#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", "func", ",", " ",
         "fontname", ",", " ", "fontweight"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksstd", "[", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ticksstd", "[", 
       RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", 
        RowBox[{"#", "&"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection"], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"new", " ", "ticks"}], " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myintQ", "[", "num_", "]"}], ":=", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "-", 
         RowBox[{"Floor", "[", "num", "]"}]}], "\[Equal]", "0"}], ",", " ", 
       "True", ",", " ", "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mytoint", "[", "num_", "]"}], ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myintQ", "[", "num", "]"}], ",", " ", 
       RowBox[{"IntegerPart", "[", "num", "]"}], ",", " ", 
       RowBox[{"num", "//", "N"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tistep", "[", " ", 
      RowBox[{"min_", ",", "max_", ",", "n_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "step1", ",", " ", "step2", ",", "\[IndentingNewLine]", "fancy", ",", 
         " ", "\[IndentingNewLine]", "sorted", ",", "\[IndentingNewLine]", 
         "mintic", ",", " ", "maxtic"}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"step1", "=", "  ", 
         SuperscriptBox["10", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"max", "-", "min"}], ")"}], "/", "n"}], "]"}], ",", 
            " ", "1"}], "]"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fancy", " ", "=", " ", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"2", "\[Rule]", " ", "2"}], ",", " ", 
           RowBox[{"3", "\[Rule]", "5"}]}], " ", "}"}]}], " ", ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"sorted", "=", " ", 
         RowBox[{"Sort", "[", " ", 
          RowBox[{"fancy", ",", " ", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"n", " ", "-", " ", 
                FractionBox[
                 RowBox[{"(", 
                  RowBox[{"max", "-", "min"}], ")"}], 
                 RowBox[{"step1", " ", 
                  RowBox[{"Values", "[", "#1", "]"}]}]]}], " ", ")"}], "2"], 
             "<", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"n", " ", "-", " ", 
                FractionBox[
                 RowBox[{"(", 
                  RowBox[{"max", "-", "min"}], ")"}], 
                 RowBox[{"step1", " ", 
                  RowBox[{"Values", "[", "#2", "]"}]}]]}], " ", ")"}], "2"]}],
             "&"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"step2", " ", "=", 
         RowBox[{
          RowBox[{"step1", " ", "*", " ", 
           RowBox[{"Values", "[", " ", 
            RowBox[{"sorted", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "//", 
          "mytoint"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"mintic", " ", "=", " ", 
         RowBox[{
          RowBox[{"Floor", "[", " ", 
           RowBox[{"min", ",", "step2"}], "]"}], "//", "mytoint"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxtic", " ", "=", " ", 
         RowBox[{
          RowBox[{"Ceiling", "[", " ", 
           RowBox[{"max", ",", "step2"}], "]"}], "//", "mytoint"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"<|", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<min\>\"", "\[Rule]", 
           RowBox[{"(", "mintic", ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<max\>\"", "\[Rule]", 
           RowBox[{"(", "maxtic", ")"}]}], ",", "\[IndentingNewLine]", " ", 
          RowBox[{"\"\<step\>\"", "\[Rule]", 
           RowBox[{"(", "step2", ")"}]}]}], "\[IndentingNewLine]", "|>"}]}]}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ti", "[", 
      RowBox[{"min_", ",", "max_", ",", "func_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aaa", " ", "=", " ", 
         RowBox[{"tistep", "[", 
          RowBox[{"min", ",", "max", ",", "5"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"ticksstd", "[", " ", 
        RowBox[{
         RowBox[{"aaa", "[", "\"\<min\>\"", "]"}], ",", " ", 
         RowBox[{"aaa", "[", "\"\<max\>\"", "]"}], ",", 
         RowBox[{"aaa", "[", "\"\<step\>\"", "]"}], ",", " ", "15", ",", 
         "func"}], "]"}]}], " ", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ti", "[", "func_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ti", "[", 
       RowBox[{"#1", ",", "#2", ",", "func"}], "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ti", "[", 
      RowBox[{"min_", ",", "max_"}], "]"}], ":=", " ", 
     RowBox[{"ti", "[", 
      RowBox[{"min", ",", "max", ",", 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ti2", "[", 
      RowBox[{"min_", ",", "max_"}], "]"}], ":=", " ", 
     RowBox[{"ti", "[", 
      RowBox[{"min", ",", "max", ",", 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksnil", "[", 
      RowBox[{
      "from_", ",", " ", "to_", ",", "majorstep_", ",", " ", "size_", ",", 
       "func_"}], "]"}], ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ticksempty", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func"}], "]"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"ticksempty", "[", 
        RowBox[{
        "from", ",", " ", "to", ",", "majorstep", ",", " ", "size", ",", 
         "func"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksnil", "[", 
     RowBox[{"size_", "?", "NumericQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ticksnil", "[", 
      RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", 
       RowBox[{"#", "&"}]}], "]"}], "&"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksnil", "[", 
     RowBox[{"func_", ",", " ", 
      RowBox[{"size_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ticksnil", "[", 
      RowBox[{
      "#1", ",", " ", "#2", ",", "#3", ",", " ", "size", ",", "func"}], "]"}],
      "&"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksnil", "[", "func_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ticksnil", "[", 
      RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", "func"}], 
      "]"}], "&"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksnil", "[", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ticksnil", "[", 
      RowBox[{"#1", ",", " ", "#2", ",", "#3", ",", " ", "15", ",", 
       RowBox[{"#", "&"}]}], "]"}], "&"}]}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ticksboth", "]"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"size", "\[Rule]", " ", "12"}], ",", 
       RowBox[{"func", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"#", "&"}], ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticksboth", "[", 
      RowBox[{"from_", ",", " ", "to_", ",", "majorstep_", ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ticksriffle", "[", 
        RowBox[{"from", ",", "to", ",", " ", "majorstep", ",", " ", 
         RowBox[{"OptionValue", "[", "\"\<size\>\"", "]"}], ",", " ", 
         RowBox[{"OptionValue", "[", "\"\<func\>\"", "]"}]}], "]"}], ",", " ",
        "\[IndentingNewLine]", 
       RowBox[{"ticksempty", "[", 
        RowBox[{"from", ",", "to", ",", " ", 
         RowBox[{"majorstep", "/", "2"}], ",", " ", 
         RowBox[{"OptionValue", "[", "\"\<size\>\"", "]"}], ",", " ", 
         RowBox[{"OptionValue", "[", "\"\<func\>\"", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"export", "[", "aaa_", "]"}], ":=", 
     RowBox[{"Export", "[", " ", 
      RowBox[{
       RowBox[{"datafolder", "<>", "\"\</aaa.pdf\>\""}], ",", "aaa"}], 
      "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], "\[IndentingNewLine]", 
   StyleBox[
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{"smart", " ", "ticks"}], " ", "*)"}], "Subsection"],
    FontSize->72], 
   StyleBox[" ",
    FontSize->72], 
   StyleBox["\[IndentingNewLine]",
    FontSize->48], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"beststep", "[", " ", 
      RowBox[{"all_", ",", "n_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"step1", "=", "  ", 
          SuperscriptBox["10", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"Log10", "[", 
              RowBox[{"all", "/", "n"}], "]"}], ",", " ", "1"}], "]"}]]}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{"fancy", " ", "=", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "1"}], ",", " ", 
            RowBox[{"2", "\[Rule]", " ", "2"}], ",", " ", 
            RowBox[{"3", "\[Rule]", "5"}]}], " ", "}"}]}]}], " ", "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"With", "[", " ", 
        RowBox[{
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{"sorted", "=", " ", 
           RowBox[{"Sort", "[", " ", 
            RowBox[{"fancy", ",", " ", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"n", " ", "-", " ", 
                  FractionBox["all", 
                   RowBox[{"step1", " ", 
                    RowBox[{"Values", "[", "#1", "]"}]}]]}], ")"}], "2"], "<",
                " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"n", " ", "-", " ", 
                  FractionBox["all", 
                   RowBox[{"step1", " ", 
                    RowBox[{"Values", "[", "#2", "]"}]}]]}], ")"}], "2"]}], 
              "&"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"step1", " ", 
          RowBox[{"Values", "[", " ", 
           RowBox[{"sorted", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tickssetmajor", "[", " ", 
      RowBox[{"min_", ",", " ", "max_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"step", "=", 
         RowBox[{
          RowBox[{"beststep", "[", 
           RowBox[{
            RowBox[{"max", "-", "min"}], ",", "3"}], "]"}], "//", "N"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mytoint", "[", "#", "]"}], "&"}], "/@", " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Floor", "[", " ", 
              RowBox[{
               RowBox[{"min", "+", 
                RowBox[{"#", " ", "step"}]}], ",", " ", "step"}], "]"}], " ", 
             "&"}], "/@", " ", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"Round", "[", 
                FractionBox[
                 RowBox[{"max", "-", "min"}], "step"], "]"}], "+", "1"}], ",",
               "1"}], "]"}]}], " ", ")"}], " ", "//", " ", 
          RowBox[{
           RowBox[{"Select", "[", " ", 
            RowBox[{"#", " ", ",", " ", 
             RowBox[{
              RowBox[{"min", "\[LessEqual]", "#", "\[LessEqual]", "max"}], 
              "&"}]}], "]"}], "&"}]}], " ", ")"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tickssetmajor", "[", " ", "minmax_", "]"}], ":=", " ", 
     RowBox[{"tickssetmajor", "[", " ", 
      RowBox[{
       RowBox[{"minmax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"minmax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tickssetminor", "[", " ", 
      RowBox[{"min_", ",", " ", "max_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"step", "=", 
         RowBox[{
          RowBox[{"beststep", "[", 
           RowBox[{
            RowBox[{"max", "-", "min"}], ",", "3"}], "]"}], "//", "N"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mytoint", "[", "#", "]"}], "&"}], "/@", " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Floor", "[", " ", 
               RowBox[{
                RowBox[{"min", "+", 
                 RowBox[{"#", " ", "step"}]}], ",", " ", "step"}], "]"}], "+", 
              RowBox[{"step", "/", "2"}]}], " ", "&"}], "/@", " ", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"Round", "[", 
                FractionBox[
                 RowBox[{"max", "-", "min"}], "step"], "]"}], "+", "1"}], ",",
               "1"}], "]"}]}], ")"}], "//", " ", 
          RowBox[{
           RowBox[{"Select", "[", " ", 
            RowBox[{"#", " ", ",", " ", 
             RowBox[{
              RowBox[{"min", "\[LessEqual]", "#", "\[LessEqual]", "max"}], 
              "&"}]}], "]"}], "&"}]}], ")"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tickssetminor", "[", " ", "minmax_", "]"}], ":=", " ", 
     RowBox[{"tickssetminor", "[", " ", 
      RowBox[{
       RowBox[{"minmax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"minmax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myticksaux", "[", 
      RowBox[{"min_", ",", " ", "max_", ",", " ", "voice_"}], "]"}], " ", ":=", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"say", "=", 
         RowBox[{"<|", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<mute\>\"", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tee", "[", 
               RowBox[{"\"\< \>\"", ",", "13"}], "]"}], "&"}], ")"}]}], ",", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"\"\<loud\>\"", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tee", "[", 
               RowBox[{"#", ",", "13"}], "]"}], "&"}], ")"}]}]}], " ", 
          "\[IndentingNewLine]", "|>"}]}], " ", "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"say", "[", "voice", "]"}], "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.015", ",", "0."}], "}"}], ",", "Black"}], "}"}], " ",
            "&"}], "/@", " ", 
          RowBox[{"tickssetmajor", "[", " ", 
           RowBox[{"min", ",", " ", "max"}], "]"}]}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"say", "[", "\"\<mute\>\"", "]"}], "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.008", ",", "0"}], "}"}], ",", " ", "Black"}], "}"}], 
           " ", "&"}], "/@", " ", 
          RowBox[{"tickssetminor", "[", " ", 
           RowBox[{"min", ",", " ", "max"}], "]"}]}]}], "\[IndentingNewLine]",
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myticks", "[", " ", 
      RowBox[{"min_", ",", " ", "max_"}], "]"}], ":=", 
     RowBox[{"myticksaux", "[", 
      RowBox[{"min", ",", "max", ",", " ", "\"\<loud\>\""}], "]"}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myticksmute", "[", " ", 
      RowBox[{"min_", ",", " ", "max_"}], "]"}], ":=", 
     RowBox[{"myticksaux", "[", 
      RowBox[{"min", ",", "max", ",", " ", "\"\<mute\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nice", "[", "plot_", "]"}], ":=", " ", 
     RowBox[{"Show", "[", " ", 
      RowBox[{"plot", ",", "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "None"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", "\[IndentingNewLine]", 
       
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "15"}], "]"}]}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Thickness", "[", "0.00032", "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}], ",", " ", "\[IndentingNewLine]", 
       
       RowBox[{"ImageSize", "\[Rule]", "550"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"myticks", ",", "myticksmute"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"myticks", ",", "myticksmute"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plot", "[", " ", 
      RowBox[{"what_", ",", " ", "range_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Plot", "[", " ", 
       RowBox[{"what", ",", " ", "range"}], "]"}], "//", "nice"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nice1", "[", "plot_", "]"}], ":=", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prange", " ", "=", " ", 
          RowBox[{"plotrange", "[", "plot", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"imagesize", "=", "350"}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", " ", 
       RowBox[{"Show", "[", " ", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"plot", ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"expand", "[", 
                 RowBox[{
                  RowBox[{"prange", "[", "x", "]"}], ",", "1."}], "]"}], ",", 
                "  ", 
                RowBox[{"expand", "[", 
                 RowBox[{
                  RowBox[{"prange", "[", "y", "]"}], ",", "1."}], "]"}]}], 
               " ", "}"}]}]}], " ", "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", " ", 
            RowBox[{
             RowBox[{"{", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"xmajor", "=", 
                RowBox[{"0.015", " ", 
                 RowBox[{"prange", "[", "dy", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"xminor", "=", 
                RowBox[{"0.008", " ", 
                 RowBox[{"prange", "[", "dy", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"xtextoff", "=", 
                RowBox[{"0.04", " ", 
                 RowBox[{"prange", "[", "dy", "]"}]}]}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ymajor", "=", 
                RowBox[{"0.015", 
                 RowBox[{"prange", "[", "dx", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"yminor", "=", 
                RowBox[{"0.008", " ", 
                 RowBox[{"prange", "[", "dx", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ytextoff", "=", 
                RowBox[{"0.04", " ", 
                 RowBox[{"prange", "[", "dx", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"fs", "=", "16"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"fontf", "=", "\"\<Helvetica\>\""}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
                 "\[IndentingNewLine]", "Black", ",", "\[IndentingNewLine]", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Thickness", "[", "0.003", "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", " ", 
                  RowBox[{"{", " ", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], " ", 
                   "\[IndentingNewLine]", "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  StyleBox[
                   RowBox[{"X", " ", "ticks"}], "Subsection"], 
                  StyleBox[" ", "Subsection"], "*)"}], "\[IndentingNewLine]", 
                 " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "xmajor"}]}], 
                    "}"}]}], " ", "}"}], "]"}], "&"}], "/@", "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "x", "]"}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", " ", 
                    RowBox[{
                    RowBox[{"tee", "[", 
                    RowBox[{"#", ",", "fs", " ", ",", " ", 
                    RowBox[{"font", "\[Rule]", "fontf"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "-", "xtextoff"}]}], 
                    " ", "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                  "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "x", "]"}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "xminor"}]}], 
                    "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", "  ", 
                  RowBox[{"tickssetminor", "[", 
                   RowBox[{"prange", "[", "x", "]"}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "xmajor"}]}], 
                    "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "x", "]"}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "y", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "xminor"}]}], 
                    "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", "  ", 
                  RowBox[{"tickssetminor", "[", 
                   RowBox[{"prange", "[", "x", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  StyleBox[
                   RowBox[{"Y", " ", "ticks"}], "Subsection"], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "ymajor"}], ",", " ",
                     "#"}], "}"}]}], " ", "}"}], "]"}], "&"}], "/@", "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "y", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", " ", 
                    RowBox[{
                    RowBox[{"tee", "[", 
                    RowBox[{"#", ",", "fs", ",", " ", 
                    RowBox[{"font", "\[Rule]", "fontf"}]}], " ", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "-", "ytextoff"}], 
                    " ", ",", " ", "#"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], " ", "&"}], "/@",
                   "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "y", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "yminor"}], ",", " ",
                     "#"}], "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", 
                  "  ", 
                  RowBox[{"tickssetminor", "[", 
                   RowBox[{"prange", "[", "y", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "#"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "ymajor"}], ",", 
                    "#"}], "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", "  ", 
                  RowBox[{"tickssetmajor", "[", 
                   RowBox[{"prange", "[", "y", "]"}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "#"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "x", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "yminor"}], ",", 
                    "#"}], "}"}]}], " ", "}"}], "]"}], " ", "&"}], "/@", "  ", 
                  RowBox[{"tickssetminor", "[", 
                   RowBox[{"prange", "[", "y", "]"}], "]"}]}]}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"expand", "[", 
             RowBox[{
              RowBox[{"prange", "[", "x", "]"}], ",", "1.2"}], "]"}], ",", 
            "  ", 
            RowBox[{"expand", "[", 
             RowBox[{
              RowBox[{"prange", "[", "y", "]"}], ",", "1.2"}], "]"}]}], " ", 
           "}"}]}], " ", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Axes", "\[Rule]", "None"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "None"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "imagesize"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plot", "[", " ", 
      RowBox[{"what_", ",", " ", "range_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Plot", "[", " ", 
       RowBox[{"what", ",", " ", "range"}], "]"}], "//", "nice"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\n", "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], 
   StyleBox["\[IndentingNewLine]", "Subsection",
    FontSize->36], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    StyleBox["(*", "Subsection",
     FontSize->48], 
    StyleBox["\[IndentingNewLine]", "Subsection",
     FontSize->48], 
    RowBox[{
     RowBox[{
      RowBox[{
       StyleBox["poor", "Subsection",
        FontSize->48], 
       StyleBox[" ", "Subsection",
        FontSize->48], 
       StyleBox[
        RowBox[{"man", "'"}], "Subsection",
        FontSize->48], 
       StyleBox["s", "Subsection",
        FontSize->48], 
       StyleBox[" ", "Subsection",
        FontSize->48], 
       StyleBox["graph", "Subsection",
        FontSize->48], 
       StyleBox[" ", "Subsection",
        FontSize->48], 
       StyleBox["click", "Subsection",
        FontSize->48], 
       StyleBox[" ", "Subsection",
        FontSize->48], "\[IndentingNewLine]", 
       StyleBox["dat1", "Title",
        FontSize->16]}], 
      StyleBox["=", "Title",
       FontSize->16], 
      StyleBox[
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lastzero", "[", " ", 
              RowBox[{"im2", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "222"}], "]"}]}], " ", ")"}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "222"}], "]"}], "}"}], ",", "  ", 
              RowBox[{"{", "#", "}"}]}], "]"}], "\[Transpose]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"manip\[CenterEllipsis]array", "[", " ", 
           RowBox[{"#", " ", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"20", 
                RowBox[{"#", "/", "222"}]}], "&"}], ",", " ", 
              RowBox[{
               RowBox[{"350", "-", "#"}], "&"}]}], " ", "}"}]}], "]"}], 
          "&"}]}], " ", "//", 
        RowBox[{
         RowBox[{"omit\[CenterEllipsis]temps", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{
            RowBox[{"#", ">", "17"}], "&"}]}], "]"}], "&"}]}], "Title",
       FontSize->16]}], 
     StyleBox[";", "Title",
      FontSize->16], 
     StyleBox[" ", "Title",
      FontSize->16], 
     StyleBox[
      RowBox[{
       RowBox[{"dat1", "//", " ", "ListPlot"}], " ", "//", "nice"}], "Title",
      FontSize->16]}], "\[IndentingNewLine]", 
    StyleBox["*)", "Subsection",
     FontSize->36]}], "\n", 
   StyleBox[
    RowBox[{"(*", "old", "*)"}], "Subsection",
    FontSize->36], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "last\[CenterEllipsis]zero\[CenterEllipsis]simple", "[", " ", "arr_", 
      "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"list", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"toAlist", "[", " ", "arr", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", "0"}], "&"}]}], " ", "]"}], " ", "//",
            "Normal"}], " ", ")"}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", " ", 
         "0", ",", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lastzero", "[", 
      RowBox[{"x_", ",", " ", "arr_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"list", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"toAlist", "[", " ", "arr", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", "0"}], "&"}]}], " ", "]"}], " ", "//",
            "Keys"}], " ", ")"}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", "x", 
         ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"#", " ", "-", "x"}], ")"}], "2"]}], "&"}], "/@", 
               " ", "list"}], "//", "Association"}], "//", "Sort"}], "//", 
            "Keys"}], " ", ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getthecurve", "[", 
      RowBox[{"x0_", ",", "im_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dat0", ",", 
         RowBox[{"xx", "=", "x0"}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "im", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dat0", " ", "=", " ", 
         RowBox[{"0", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xx", "=", 
           RowBox[{
            RowBox[{"dat0", "[", 
             RowBox[{"[", "nn", "]"}], "]"}], "=", 
            RowBox[{"lastzero", "[", " ", 
             RowBox[{"xx", ",", 
              RowBox[{"im", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "nn"}], "]"}], "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nn", ",", "  ", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "dim"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "dat0"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", "NEW", "*)"}], "Subsection",
    FontSize->24], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"graph", " ", "click"}], " ", "*)"}], "Subsection",
    FontSize->36], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"continuous\[CenterEllipsis]segment", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "ifrom", ",", " ", "ito", ",", " ", "len", ",", " ", "val", ",", " ", 
         "xx"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xx", "=", 
         RowBox[{"x0", "//", 
          RowBox[{"inrange\[CenterEllipsis]int", "[", 
           RowBox[{"1", ",", 
            RowBox[{"win", "[", "2", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"val", "=", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "xx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ifrom", "=", "xx"}], ";", " ", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"ifrom", "\[LessEqual]", " ", 
           RowBox[{"win", "[", "1", "]"}]}], ",", " ", "1", ",", " ", 
          RowBox[{"While", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ifrom", ">", 
              RowBox[{"win", "[", "1", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"ifrom", "-", "1"}], "]"}], "]"}], "\[Equal]", 
              "val"}]}], ",", "  ", 
            RowBox[{
             RowBox[{"ifrom", "--"}], ";"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ito", "=", "xx"}], ";", " ", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"ito", "\[GreaterEqual]", " ", 
           RowBox[{"win", "[", "2", "]"}]}], ",", " ", 
          RowBox[{"win", "[", "2", "]"}], ",", " ", 
          RowBox[{"While", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ito", "<", 
              RowBox[{"win", "[", "2", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"ito", "+", "1"}], "]"}], "]"}], "\[Equal]", 
              "val"}]}], ",", " ", 
            RowBox[{
             RowBox[{"ito", "++"}], ";"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "ifrom"}], ",", 
          RowBox[{"2", "\[Rule]", "ito"}]}], "|>"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"continuous\[CenterEllipsis]segment", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", " ", 
        RowBox[{"win", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Length", "[", "arr", "]"}]}]}], "|>"}]}], "}"}], ",", 
       RowBox[{"nearest\[CenterEllipsis]zero", "[", 
        RowBox[{"x0", ",", " ", "arr", ",", " ", "win"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"continuous\[CenterEllipsis]segment", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"continuous\[CenterEllipsis]segment", "[", 
       RowBox[{"x0", ",", "#", ",", " ", "win"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"continuous\[CenterEllipsis]segment", "[", "x0_", "]"}], ":=", 
     RowBox[{
      RowBox[{"continuous\[CenterEllipsis]segment", "[", 
       RowBox[{"x0", ",", "#"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearest\[CenterEllipsis]zero", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"arr", "//", "toAlist"}], "//", 
            RowBox[{"Select", "[", " ", 
             RowBox[{
              RowBox[{"#", " ", "\[Equal]", "0"}], "&"}], " ", "]"}]}], "//", 
           "Keys"}], " ", "//", 
          RowBox[{"Select", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[GreaterEqual]", " ", 
              RowBox[{"win", "[", "1", "]"}]}], "&&", " ", 
             RowBox[{"#", "\[LessEqual]", " ", 
              RowBox[{"win", "[", "2", "]"}]}]}], "&"}], " ", "]"}]}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", "x0",
           ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", " ", "-", "x0"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"#", " ", "-", "x0"}], ")"}]}]}], "&"}], "/@", 
                " ", "list"}], "//", "Association"}], "//", "Sort"}], "//", 
             "Keys"}], " ", ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearest\[CenterEllipsis]zero", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"win", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Length", "[", "arr", "]"}]}]}], "|>"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nearest\[CenterEllipsis]zero", "[", 
        RowBox[{"x0", ",", " ", "arr", ",", " ", "win"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearest\[CenterEllipsis]zero", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"nearest\[CenterEllipsis]zero", "[", 
       RowBox[{"x0", ",", " ", "#", ",", " ", "win"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearest\[CenterEllipsis]zero", "[", 
      RowBox[{"x0_", "?", "NumericQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"nearest\[CenterEllipsis]zero", "[", 
       RowBox[{"x0", ",", " ", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"get\[CenterEllipsis]point", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xx", "=", 
          RowBox[{"x0", "//", 
           RowBox[{"inrange\[CenterEllipsis]int", "[", 
            RowBox[{
             RowBox[{"win", "[", "1", "]"}], ",", 
             RowBox[{"win", "[", "2", "]"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", "po", ",", " ", "po1"}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"po", " ", "=", " ", 
         RowBox[{"arr", "//", " ", 
          RowBox[{"nearest\[CenterEllipsis]zero", "[", 
           RowBox[{"xx", ",", " ", "win"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"po1", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr", "//", " ", 
           RowBox[{"continuous\[CenterEllipsis]segment", "[", 
            RowBox[{"po", ",", " ", "win"}], "]"}]}], " ", "//", 
          "Mean"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"get\[CenterEllipsis]point", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"arr_", "?", "ArrayQ"}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"win", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Length", "[", "arr", "]"}]}]}], "|>"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"get\[CenterEllipsis]point", "[", 
        RowBox[{"x0", ",", " ", "arr", ",", " ", "window"}], "]"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"get\[CenterEllipsis]point", "[", 
      RowBox[{"x0_", "?", "NumericQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"get\[CenterEllipsis]point", "[", 
       RowBox[{"x0", ",", " ", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"get\[CenterEllipsis]point", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"get\[CenterEllipsis]point", "[", 
       RowBox[{"x0", ",", " ", "#", ",", " ", "win"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shift", "[", "arr_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Join", "[", " ", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{"arr", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"RotateLeft", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "]"}], "}"}], " ", 
        ",", " ", "1"}], "]"}], "\[Transpose]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boxass", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boxsize", " ", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boxthres", " ", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"box", "[", 
      RowBox[{"action_", ",", "number_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Switch", "[", " ", 
      RowBox[{
      "action", ",", " ", "\[IndentingNewLine]", "\"\<setsize\>\"", ",", " ", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"boxsize", "=", "number"}], ",", "\[IndentingNewLine]", 
       "\"\<setthres\>\"", ",", " ", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"boxthres", "=", "number"}], ",", "\[IndentingNewLine]", 
       "\"\<init\>\"", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"boxass", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "number"}], "}"}], "&"}], " ", "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "boxsize"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\"\<push\>\"", ",", " ", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"boxass", "=", " ", 
         RowBox[{"shift", "[", "boxass", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"boxass", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "2"}], "]"}], "]"}], "=", 
         "number"}]}], ",", "\[IndentingNewLine]", "\"\<show\>\"", ",", " ", 
       "\[IndentingNewLine]", "\t", "boxass", ",", "\[IndentingNewLine]", 
       "\"\<test\>\"", ",", " ", "\[IndentingNewLine]", "\t ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"number", "-", 
          RowBox[{"box", "[", 
           RowBox[{"\"\<next\>\"", ",", "0"}], "]"}]}], "]"}], "<", 
        "boxthres"}], ",", " ", "\[IndentingNewLine]", "\"\<next\>\"", ",", 
       " ", "\[IndentingNewLine]", "\t ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"boxass", "//", "intercept"}], " ", ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"boxass", "//", "slope"}], ")"}], " ", "*", " ", 
         "boxsize"}]}], " ", ",", "\[IndentingNewLine]", "\"\<testpush\>\"", 
       ",", " ", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"box", "[", 
          RowBox[{"\"\<test\>\"", ",", "number"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"box", "[", "number", "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"box", "[", 
          RowBox[{"\"\<push\>\"", ",", 
           RowBox[{"box", "[", 
            RowBox[{"\"\<next\>\"", ",", "0"}], "]"}]}], " ", "]"}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ",", "\[IndentingNewLine]", "_", 
       ",", " ", "number"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"box", "[", 
      RowBox[{"action_", "?", "StringQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"box", "[", 
       RowBox[{"action", ",", " ", "0"}], "]"}], "/;", " ", 
      RowBox[{"action", "\[Equal]", "\"\<next\>\""}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"box", "[", 
      RowBox[{"action_", "?", "StringQ"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"box", "[", 
       RowBox[{"action", ",", " ", "#"}], " ", "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"box", "[", 
      RowBox[{"number_", "?", "NumericQ"}], "]"}], ":=", " ", 
     RowBox[{"box", "[", 
      RowBox[{"\"\<push\>\"", ",", " ", "number"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"box", "[", "]"}], ":=", " ", 
     RowBox[{"box", "[", 
      RowBox[{"\"\<show\>\"", ",", " ", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "graph\[CenterEllipsis]click", "]"}], "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"start", "\[Rule]", "0"}], ",", 
       RowBox[{"len", "\[Rule]", "10"}], ",", " ", 
       RowBox[{"threshold", "\[Rule]", "100"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", 
      RowBox[{
       RowBox[{"im_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"start_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"len_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"threshold_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "dat0", ",", "\[IndentingNewLine]", "next", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"xlen", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "im", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ylen", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "im", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"dim", "=", 
          RowBox[{
           RowBox[{"win", "[", "\"\<imaxx\>\"", "]"}], "-", " ", 
           RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], "+", "1"}]}]}], " ", 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dat0", " ", "=", " ", 
         RowBox[{"0", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"next", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ylen", "-", "start"}], ")"}], "//", 
          RowBox[{"inrange\[CenterEllipsis]int", "[", 
           RowBox[{
            RowBox[{"ylen", "-", " ", 
             RowBox[{"win", "[", "\"\<imaxy\>\"", "]"}]}], ",", " ", 
            RowBox[{"ylen", "-", 
             RowBox[{"win", "[", "\"\<iminy\>\"", "]"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", "\"\<setsize\>\"", "]"}], "[", "len", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", "\"\<setthres\>\"", "]"}], "[", "threshold", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", "\"\<init\>\"", "]"}], "[", "next", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"dat0", "[", 
            RowBox[{"[", 
             RowBox[{"nn", "-", 
              RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], "+", "1"}], "]"}], 
            "]"}], "=", 
           RowBox[{"next", " ", "=", 
            RowBox[{
             RowBox[{"box", "[", "\"\<testpush\>\"", "]"}], "[", "  ", 
             RowBox[{
              RowBox[{"im", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "nn"}], "]"}], "]"}], "//", 
              "\[IndentingNewLine]", 
              RowBox[{"get\[CenterEllipsis]point", "[", " ", 
               RowBox[{"next", ",", " ", 
                RowBox[{"<|", " ", 
                 RowBox[{
                  RowBox[{"1", "\[Rule]", " ", 
                   RowBox[{"ylen", "-", 
                    RowBox[{"win", "[", "\"\<imaxy\>\"", "]"}]}]}], ",", " ", 
                  
                  RowBox[{"2", "\[Rule]", " ", 
                   RowBox[{"ylen", "-", 
                    RowBox[{"win", "[", "\"\<iminy\>\"", "]"}]}]}]}], 
                 "|>"}]}], " ", "]"}]}], "]"}]}]}], " ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nn", ",", "  ", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], ",", " ", 
              RowBox[{"win", "[", "\"\<imaxx\>\"", "]"}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "dat0"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", 
      RowBox[{
       RowBox[{"im_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"start_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"len_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"threshold_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
     RowBox[{"With", "[", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"win", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"\"\<iminx\>\"", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"\"\<iminy\>\"", "\[Rule]", "1"}], ",", " ", 
           RowBox[{"\"\<imaxx\>\"", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "im", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
           RowBox[{"\"\<imaxy\>\"", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "im", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "|>"}]}], " ", "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"graph\[CenterEllipsis]click", "[", 
        RowBox[{
        "im", ",", " ", "start", ",", " ", "len", ",", " ", "threshold", ",", 
         " ", "win"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"leng_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"thres_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click", "[", 
       RowBox[{"#", ",", "x0", ",", " ", "leng", ",", " ", "thres"}], "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", 
      RowBox[{
       RowBox[{"x0_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"leng_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"thres_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"win_", "?", "AssociationQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click", "[", 
       RowBox[{
       "#", ",", "x0", ",", " ", "leng", ",", " ", "thres", ",", " ", "win"}],
        "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", " ", 
      RowBox[{
       RowBox[{"win_", "?", "AssociationQ"}], ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click", "[", 
       RowBox[{"#", ",", 
        RowBox[{"OptionValue", "[", "\"\<start\>\"", "]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<len\>\"", "]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<threshold\>\"", "]"}], ",", " ", 
        "win"}], " ", "]"}], "&"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graph\[CenterEllipsis]click", "[", " ", 
      RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click", "[", 
       RowBox[{"#", ",", 
        RowBox[{"OptionValue", "[", "\"\<start\>\"", "]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<len\>\"", "]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<threshold\>\"", "]"}]}], " ", "]"}], 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gqframe", "[", 
      RowBox[{"win_", "?", "AssociationQ"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", " ", 
      RowBox[{"{", " ", 
       RowBox[{"Line", "[", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], ",", 
            RowBox[{"win", "[", "\"\<iminy\>\"", "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"win", "[", "\"\<imaxx\>\"", "]"}], ",", 
            RowBox[{"win", "[", "\"\<iminy\>\"", "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"win", "[", "\"\<imaxx\>\"", "]"}], ",", 
            RowBox[{"win", "[", "\"\<imaxy\>\"", "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], ",", 
            RowBox[{"win", "[", "\"\<imaxy\>\"", "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"win", "[", "\"\<iminx\>\"", "]"}], ",", 
            RowBox[{"win", "[", "\"\<iminy\>\"", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], " ", "\[IndentingNewLine]", 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axaefun", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"axae", "[", "\"\<minx\>\"", "]"}], " ", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"axae", "[", "\"\<maxx\>\"", "]"}], "-", 
            RowBox[{"axae", "[", "\"\<minx\>\"", "]"}]}], ")"}], 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"axae", "[", "\"\<iminx\>\"", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"axae", "[", "\"\<imaxx\>\"", "]"}], "-", 
             RowBox[{"axae", "[", "\"\<iminx\>\"", "]"}]}], ")"}]]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"axae", "[", "\"\<miny\>\"", "]"}], " ", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"axae", "[", "\"\<maxy\>\"", "]"}], "-", 
            RowBox[{"axae", "[", "\"\<miny\>\"", "]"}]}], ")"}], 
          FractionBox[
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"axae", "[", "\"\<iminy\>\"", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"axae", "[", "\"\<imaxy\>\"", "]"}], "-", 
             RowBox[{"axae", "[", "\"\<iminy\>\"", "]"}]}], ")"}]]}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"axaefunx", "[", 
      RowBox[{
       RowBox[{"axae_", "?", "AssociationQ"}], ",", " ", 
       RowBox[{"pt_", "?", "ArrayQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"axae", "[", "\"\<minx\>\"", "]"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"axae", "[", "\"\<maxx\>\"", "]"}], "-", 
           RowBox[{"axae", "[", "\"\<minx\>\"", "]"}]}], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"axae", "[", "\"\<iminx\>\"", "]"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"axae", "[", "\"\<imaxx\>\"", "]"}], "-", 
            RowBox[{"axae", "[", "\"\<iminx\>\"", "]"}]}], ")"}]]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"axae", "[", "\"\<miny\>\"", "]"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"axae", "[", "\"\<maxy\>\"", "]"}], "-", 
           RowBox[{"axae", "[", "\"\<miny\>\"", "]"}]}], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"axae", "[", "\"\<iminy\>\"", "]"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"axae", "[", "\"\<imaxy\>\"", "]"}], "-", 
            RowBox[{"axae", "[", "\"\<iminy\>\"", "]"}]}], ")"}]]}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"axaefunx", "[", " ", 
      RowBox[{"axae_", "?", "AssociationQ"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"axaefunx", "[", 
       RowBox[{"axae", ",", " ", "#"}], "]"}], "&"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"axaecorner", "[", "which_", "]"}], ":=", 
     RowBox[{"Switch", "[", " ", 
      RowBox[{"which", ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Thick", ",", " ", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", 
               RowBox[{"-", "0.5"}]}], "}"}], ",", "0.1"}], "]"}], ",", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Thick", ",", " ", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.5"}], "}"}], ",", "0.1"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
         " ", 
         RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "0", ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Red", ",", " ", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "0.1"}], "]"}]}], "}"}], 
         ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setaxae", "[", 
      RowBox[{
      "pt1_", ",", "pt2_", ",", "minx_", ",", " ", "maxx_", ",", " ", "miny_",
        ",", " ", "maxy_"}], "]"}], " ", ":=", " ", 
     RowBox[{"<|", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<iminx\>\"", "\[Rule]", " ", 
        RowBox[{"Min", "[", " ", 
         RowBox[{
          RowBox[{"pt1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<imaxx\>\"", "\[Rule]", " ", 
        RowBox[{"Max", "[", " ", 
         RowBox[{
          RowBox[{"pt1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<iminy\>\"", "\[Rule]", " ", 
        RowBox[{"Min", "[", " ", 
         RowBox[{
          RowBox[{"pt1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<imaxy\>\"", "\[Rule]", " ", 
        RowBox[{"Max", "[", " ", 
         RowBox[{
          RowBox[{"pt1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<minx\>\"", "\[Rule]", " ", "minx"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<maxx\>\"", "\[Rule]", " ", "maxx"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<miny\>\"", "\[Rule]", " ", "miny"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<maxy\>\"", "\[Rule]", " ", "maxy"}]}], 
      "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"torad", "[", "ang_", "]"}], ":=", 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"ang", " ", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"todeg", "[", "ang_", "]"}], ":=", 
     RowBox[{"180", " ", 
      RowBox[{"ang", " ", "/", "\[Pi]"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"todegr", "[", "ang_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", " ", 
        RowBox[{"ang", " ", "/", "\[Pi]"}]}], " ", ")"}], "//", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "-", 
         RowBox[{"Round", "[", " ", 
          RowBox[{"#", ",", " ", "360"}], "]"}]}], ")"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"todegf", "[", "ang_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", " ", 
        RowBox[{"ang", " ", "/", "\[Pi]"}]}], " ", ")"}], "//", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "-", 
         RowBox[{"Floor", "[", " ", 
          RowBox[{"#", ",", " ", "360"}], "]"}]}], ")"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fixangle1", "[", "a_", "]"}], ":=", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"a", "<", 
        RowBox[{"-", "60"}]}], ",", 
       RowBox[{"a", "+", "360"}], ",", "a"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fixangle2", "[", "a_", "]"}], ":=", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"a", ">", "300"}], ",", 
       RowBox[{"a", "-", "360"}], ",", "a"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rad", "[", "ang_", "]"}], ":=", 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"ang", " ", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deg", "[", "ang_", "]"}], ":=", 
     RowBox[{"180", " ", 
      RowBox[{"ang", " ", "/", "\[Pi]"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection"], 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click\[CenterEllipsis]old", "[", 
       RowBox[{"x0_", ",", "im_"}], "]"}], ":=", " ", 
      RowBox[{"Module", "[", " ", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"dat0", ",", "\[IndentingNewLine]", 
          RowBox[{"leng", "=", "25"}], ",", "\[IndentingNewLine]", "ass", ",",
           "\[IndentingNewLine]", 
          RowBox[{"xx", "=", "x0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"dim", "=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "im", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ass", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "x0"}], "}"}], "&"}], " ", "/@", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "leng"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dat0", " ", "=", " ", 
          RowBox[{"0", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Module", "[", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xx1", ",", " ", "next"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xx1", "=", 
               RowBox[{
                RowBox[{"im", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "nn"}], "]"}], "]"}], "//", 
                RowBox[{
                "get\[CenterEllipsis]point", "[", " ", "xx", "]"}]}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"next", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ass", "//", "intercept"}], " ", ")"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ass", "//", "slope"}], ")"}], " ", "*", " ", 
                 "leng"}]}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"xx1", "-", "next"}], "]"}], ">", "40"}], ",", " ", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"xx", "=", "next"}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"xx", "=", "xx1"}]}], "\[IndentingNewLine]", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"ass", "=", 
               RowBox[{"ass", "//", "shift"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ass", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "=", "xx"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dat0", "[", 
                RowBox[{"[", "nn", "]"}], "]"}], "=", "xx"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"nn", ",", "  ", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "dim"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "dat0"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"graph\[CenterEllipsis]click", "[", "x0_", "]"}], ":=", 
      RowBox[{
       RowBox[{"graph\[CenterEllipsis]click", "[", 
        RowBox[{"x0", ",", " ", "#"}], "]"}], "&"}]}], " ", ";"}], " ", 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"vicinity", " ", "processing"}], " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   StyleBox[
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vicinity", "[", " ", 
        RowBox[{"arr_", ",", " ", "val_", ",", " ", "win_"}], "]"}], "  ", ":=",
        " ", 
       RowBox[{"Select", "[", 
        RowBox[{"arr", ",", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"val", "-", 
            RowBox[{"win", "/", "2"}]}], "<", "#", "<", 
           RowBox[{"val", "+", 
            RowBox[{"win", "/", "2"}]}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vicinities", "[", " ", 
        RowBox[{"arr_", ",", "vals_", ",", "win_"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"vicinity", "[", 
          RowBox[{"arr", ",", "#", ",", " ", "win"}], "]"}], "&"}], "/@", " ",
         "vals"}]}], " ", ";"}], " ", "\[IndentingNewLine]", "*)"}], 
    "Subsection"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]", "Subsection"], 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityind", "[", " ", 
      RowBox[{"arr_", ",", "inds_", ",", " ", "val_", ",", " ", "win_"}], 
      "]"}], "  ", ":=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{"inds", ",", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"val", "-", 
          RowBox[{"win", "/", "2"}]}], "<", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "<", 
         RowBox[{"val", "+", 
          RowBox[{"win", "/", "2"}]}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityind", "[", " ", 
      RowBox[{"arr_", ",", "val_", ",", " ", "win_"}], "]"}], "  ", ":=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "arr", "]"}]}], "]"}], ",", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"val", "-", 
          RowBox[{"win", "/", "2"}]}], "<", 
         RowBox[{"arr", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "<", 
         RowBox[{"val", "+", 
          RowBox[{"win", "/", "2"}]}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityindices", "[", " ", 
      RowBox[{"arr_", ",", "vals_", ",", "win_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "inds", "}"}], " ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "arr", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"vicinityind", "[", 
           RowBox[{"arr", ",", "inds", ",", "#", ",", " ", "win"}], "]"}], 
          "&"}], "/@", " ", "vals"}]}]}], " ", "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityind3", "[", " ", 
      RowBox[{
      "arr2_", ",", " ", "inds_", ",", " ", "valX_", ",", " ", "winX_", " ", 
       ",", " ", 
       RowBox[{"winY_", "?", "NumberQ"}]}], "]"}], "  ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds1", ",", " ", "valY"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inds1", " ", "=", " ", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"inds", ",", "  ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"valX", "-", 
              RowBox[{"winX", "/", "2"}]}], "<", 
             RowBox[{"arr2", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{"valX", "+", 
              RowBox[{"winX", "/", "2"}]}]}], "  ", "&"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"valY", " ", "=", " ", 
         RowBox[{
          RowBox[{"arr2", "[", 
           RowBox[{"[", 
            RowBox[{"inds1", ",", "2"}], "]"}], "]"}], "//", "Median"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"inds1", ",", "  ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"valY", "-", 
             RowBox[{"winY", "/", "2"}]}], "<", 
            RowBox[{"arr2", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "<", 
            RowBox[{"valY", "+", 
             RowBox[{"winY", "/", "2"}]}]}], "  ", "&"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arr2D2assoc", "[", " ", 
      RowBox[{"arr1_", ",", " ", "arr2_"}], " ", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", ")"}], " ", "&"}], "  ", "/@", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "arr1", "}"}], ",", " ", 
           RowBox[{"{", "arr2", "}"}]}], "]"}], "\[Transpose]"}], ")"}]}], "//",
       "Association"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityindices3", "[", " ", 
      RowBox[{"arr2_", ",", " ", "valsX_", ",", "winX_", ",", " ", 
       RowBox[{"winY_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "inds", ",", " ", "ind1", ",", " ", "ind2", ",", "  ", "winnyfunc"}], 
        "}"}], " ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "arr2", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ind1", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"vicinityind3", "[", 
            RowBox[{
            "arr2", ",", "inds", ",", "#", ",", " ", "winX", ",", "winY"}], 
            "]"}], "&"}], "/@", " ", "valsX"}]}]}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinityindices33", "[", " ", 
      RowBox[{
      "arr2_", ",", " ", "valsX_", ",", "winXfunc_", ",", " ", "winYfunc_"}], 
      "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", ",", " ", "ind1", ",", " ", "ind2"}], "}"}], " ", ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "arr2", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ind1", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"vicinityind3", "[", 
            RowBox[{"arr2", ",", "inds", ",", "#", ",", " ", 
             RowBox[{"winXfunc", "[", "#", "]"}], ",", 
             RowBox[{"winYfunc", "[", "#", "]"}]}], "]"}], "&"}], "/@", " ", 
          "valsX"}]}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"stepper", "[", " ", 
      RowBox[{"left_", ",", "right_", ",", " ", "zero_", ",", " ", "delta_"}],
       "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"left", " ", "+", " ", 
        RowBox[{
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"Tanh", "[", 
            FractionBox[
             RowBox[{"#", "-", "zero", " "}], 
             RowBox[{"delta", "  "}]], "]"}]}], "2"], 
         RowBox[{"(", 
          RowBox[{"right", "-", "left"}], ")"}]}]}], " ", ")"}], "&"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stepper1", "[", " ", 
      RowBox[{
       RowBox[{"left_", "?", "ArrayQ"}], ",", 
       RowBox[{"right_", "?", "ArrayQ"}], ",", " ", "zero_", ",", " ", 
       "delta_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "  ", 
         RowBox[{
          RowBox[{"BSplineFunction", "[", " ", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{"left", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"zero", "-", "delta"}], ",", " ", 
               RowBox[{"left", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{"zero", ",", " ", 
               FractionBox[
                RowBox[{
                 RowBox[{"left", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"right", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "2"]}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"zero", "+", "delta"}], ",", " ", 
               RowBox[{"right", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
             "\[IndentingNewLine]", "right"}], "\[IndentingNewLine]", "}"}], 
           "]"}], "[", 
          RowBox[{
           RowBox[{"left", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
           FractionBox[
            RowBox[{"#", " ", "-", 
             RowBox[{"left", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], 
            RowBox[{
             RowBox[{"right", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"left", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]]}], "]"}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Solve", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", " ", "+", " ", 
          RowBox[{"B", " ", 
           RowBox[{"Tanh", "[", " ", 
            FractionBox[
             RowBox[{"x1", "-", "x0"}], "d"], "]"}]}]}], "\[Equal]", "y1"}], 
        " ", "&&", " ", 
        RowBox[{
         RowBox[{"A", " ", "+", " ", 
          RowBox[{"B", " ", 
           RowBox[{"Tanh", "[", " ", 
            FractionBox[
             RowBox[{"x2", "-", "x0"}], "d"], "]"}]}]}], "\[Equal]", "y2"}]}],
        " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B"}], "}"}]}], "]"}], " ", "//", 
     RowBox[{"FullSimplify", "\n", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "\[Rule]", 
          FractionBox[
           RowBox[{
            RowBox[{"y2", " ", 
             RowBox[{"Tanh", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "x0"}], "+", "x1"}], "d"], "]"}]}], "+", 
            RowBox[{"y1", " ", 
             RowBox[{"Tanh", "[", 
              FractionBox[
               RowBox[{"x0", "-", "x2"}], "d"], "]"}]}]}], 
           RowBox[{
            RowBox[{"Tanh", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"-", "x0"}], "+", "x1"}], "d"], "]"}], "+", 
            RowBox[{"Tanh", "[", 
             FractionBox[
              RowBox[{"x0", "-", "x2"}], "d"], "]"}]}]]}], ",", 
         RowBox[{"B", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], " ", 
           RowBox[{"Cosh", "[", 
            FractionBox[
             RowBox[{"x0", "-", "x1"}], "d"], "]"}], " ", 
           RowBox[{"Cosh", "[", 
            FractionBox[
             RowBox[{"x0", "-", "x2"}], "d"], "]"}], " ", 
           RowBox[{"Csch", "[", 
            FractionBox[
             RowBox[{"x1", "-", "x2"}], "d"], "]"}]}]}]}], "}"}], "}"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stepper2", "[", " ", 
      RowBox[{
       RowBox[{"l_", "?", "ArrayQ"}], ",", 
       RowBox[{"r_", "?", "ArrayQ"}], ",", " ", "z_", ",", " ", "d_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "A", ",", " ", "B", ",", " ", "x1", ",", " ", "x2", ",", " ", "y1", 
         ",", " ", "y2", ",", " ", "x0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"A", " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"y1", "+", "y2", "+", 
               RowBox[{"y1", " ", 
                RowBox[{"Csch", "[", 
                 RowBox[{
                  FractionBox["x1", "d"], "-", 
                  FractionBox["x2", "d"]}], "]"}], " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", " ", "x0"}], "d"], "-", 
                  FractionBox["x1", "d"], "-", 
                  FractionBox["x2", "d"]}], "]"}]}], "-", 
               RowBox[{"y2", " ", 
                RowBox[{"Csch", "[", 
                 RowBox[{
                  FractionBox["x1", "d"], "-", 
                  FractionBox["x2", "d"]}], "]"}], " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", " ", "x0"}], "d"], "-", 
                  FractionBox["x1", "d"], "-", 
                  FractionBox["x2", "d"]}], "]"}]}]}], ")"}]}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "\[Rule]", 
               RowBox[{"l", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"y1", "\[Rule]", 
               RowBox[{"l", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"x2", "\[Rule]", 
               RowBox[{"r", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"y2", "\[Rule]", " ", 
               RowBox[{"r", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"x0", "\[Rule]", "z"}]}], " ", "}"}]}], " ", ")"}], "//",
           "N"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", 
             RowBox[{"Cosh", "[", 
              FractionBox[
               RowBox[{"x0", "-", "x1"}], "d"], "]"}], " ", 
             RowBox[{"Cosh", "[", 
              FractionBox[
               RowBox[{"x0", "-", "x2"}], "d"], "]"}], " ", 
             RowBox[{"Csch", "[", 
              FractionBox[
               RowBox[{"x1", "-", "x2"}], "d"], "]"}]}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "\[Rule]", 
               RowBox[{"l", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"y1", "\[Rule]", 
               RowBox[{"l", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"x2", "\[Rule]", 
               RowBox[{"r", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"y2", "\[Rule]", " ", 
               RowBox[{"r", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"x0", "\[Rule]", "z"}]}], " ", "}"}]}], ")"}], "//", 
          "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"A", " ", "+", " ", 
           RowBox[{"B", " ", 
            RowBox[{"Tanh", "[", " ", 
             FractionBox[
              RowBox[{"#", "-", "z"}], "d"], "]"}]}]}], "]"}], "&"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stepper2", "[", " ", 
      RowBox[{
       RowBox[{"l_", "?", "NumberQ"}], ",", 
       RowBox[{"r_", "?", "NumberQ"}], ",", " ", "z_", ",", " ", "d_"}], 
      "]"}], ":=", " ", 
     RowBox[{"stepper2", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "l"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"10", "z"}], ",", " ", "r"}], "}"}], ",", " ", "z", ",", " ",
        "d"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope3", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_", ",", "  ", "butYwin_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices3", "[", 
          RowBox[{"arr", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win", ",", " ", "butYwin"}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"slope", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
           "}"}], "&"}], " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope3", "[", 
      RowBox[{"win_", ",", "step_", ",", " ", "butYwin_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{
      RowBox[{"vslope3", "[", 
       RowBox[{"#", ",", "win", ",", "step", ",", "  ", "butYwin"}], "]"}], 
      "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope33", "[", 
      RowBox[{
      "arr_", ",", "winXfunc_", ",", "step_", ",", "  ", "winYfunc_"}], "]"}],
      " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vic", ",", " ", "butYwin"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices33", "[", 
          RowBox[{"arr", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "winXfunc", ",", " ", "winYfunc"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"slope", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
           "}"}], "&"}], " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope33", "[", 
      RowBox[{"winXfunc_", ",", "step_", ",", " ", "winYfunc_"}], "]"}], " ", 
     ":=", " ", 
     RowBox[{
      RowBox[{"vslope33", "[", 
       RowBox[{"#", ",", "winXfunc", ",", "step", ",", "  ", "winYfunc"}], 
       "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean33", "[", 
      RowBox[{
      "arr_", ",", "winXfunc_", ",", "step_", ",", "  ", "winYfunc_"}], "]"}],
      " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vic", ",", " ", "butYwin"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices33", "[", 
          RowBox[{"arr", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "winXfunc", ",", " ", "winYfunc"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}]}], " ", "}"}], 
          "&"}], " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean33", "[", 
      RowBox[{"winXfunc_", ",", "step_", ",", " ", "winYfunc_"}], "]"}], " ", 
     ":=", " ", 
     RowBox[{
      RowBox[{"vmean33", "[", 
       RowBox[{"#", ",", "winXfunc", ",", "step", ",", "  ", "winYfunc"}], 
       "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean1", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"arr", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"vicinityindices", "[", 
       RowBox[{"arr", ",", " ", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Min", "[", "arr", "]"}], ",", "  ", 
          RowBox[{"Max", "[", "arr", "]"}], ",", " ", "step"}], "]"}], ",", 
        "win"}], "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
         " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2", "[", 
      RowBox[{"win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmean2", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vint2", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vic", ",", "aaa1", ",", " ", "aaa2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"aaa1", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "  ", 
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], " ", ")"}], 
           "&"}], " ", "/@", "  ", "vic"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"aaa2", " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"step", "  ", 
               RowBox[{"Mean", "[", 
                RowBox[{"arr", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}]}], " ", ")"}], 
             "&"}], " ", "/@", "  ", "vic"}], " ", ")"}], "//", 
          "Accumulate"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"aaa1", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"aaa2", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "&"}], " ", "/@", 
         " ", 
         RowBox[{"Range", "[", " ", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "[", "aaa1", "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vint2", "[", 
      RowBox[{"win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vint2", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Median", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"Median", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
         " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2", "[", 
      RowBox[{"win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmedian2", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vtrimmean2", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"TrimmedMean", "[", 
             RowBox[{
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", " ", "0.05"}], 
             "]"}]}], "}"}], "&"}], " ", "/@", "  ", "vic"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vtrimmean2", "[", 
      RowBox[{"win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vtrimmean2", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2", "[", 
      RowBox[{"arr_", ",", "win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vic", " ", "=", " ", 
         RowBox[{"vicinityindices", "[", 
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"Max", "[", 
              RowBox[{"arr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
             "step"}], "]"}], ",", "win"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Median", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"slope", "[", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
           "}"}], "&"}], " ", "/@", "  ", "vic"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2", "[", 
      RowBox[{"win_", ",", "step_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vslope2", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinity\[CenterEllipsis]ind\[CenterEllipsis]eff", "[", " ", 
      RowBox[{
      "arr_", ",", "inds_", ",", "lll_", ",", " ", "val_", ",", " ", "win_"}],
       "]"}], "  ", ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ind", ",", " ", "ind1", ",", " ", "ind2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ind", " ", "=", " ", 
         RowBox[{"SelectFirst", "[", " ", 
          RowBox[{"inds", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"val", "-", 
              RowBox[{"win", "/", "2"}]}], "  ", "<", " ", 
             RowBox[{"arr", "[", 
              RowBox[{"[", "#", "]"}], "]"}], " ", "<", "  ", 
             RowBox[{"val", "+", 
              RowBox[{"win", "/", "2"}]}]}], " ", "&"}]}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ind1", "=", "ind"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ind1", "-", "1"}], ">", "0"}], "  ", "&&", "  ", 
            RowBox[{
             RowBox[{"val", "-", 
              RowBox[{"win", "/", "2"}]}], "<", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"ind1", "-", "1"}], "]"}], "]"}], "<", 
             RowBox[{"val", "+", 
              RowBox[{"win", "/", "2"}]}]}]}], " ", ")"}], ",", " ", 
          RowBox[{"ind1", "--"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ind2", "=", "ind"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ind2", "+", "1"}], "\[LessEqual]", "lll"}], "  ", "&&", 
            " ", 
            RowBox[{
             RowBox[{"val", "-", 
              RowBox[{"win", "/", "2"}]}], "<", 
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"ind2", "+", "1"}], "]"}], "]"}], "<", 
             RowBox[{"val", "+", 
              RowBox[{"win", "/", "2"}]}]}]}], " ", ")"}], " ", ",", " ", 
          RowBox[{"ind2", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ind1", ",", " ", "ind2"}], "}"}]}]}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinity\[CenterEllipsis]ind\[CenterEllipsis]eff", "[", " ", 
      RowBox[{"arr_", ",", "val_", ",", " ", "win_"}], "]"}], "  ", ":=", " ", 
     RowBox[{"vicinity\[CenterEllipsis]ind\[CenterEllipsis]eff", "[", " ", 
      RowBox[{"arr", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "arr", "]"}]}], "]"}], ",", " ", 
       RowBox[{"Length", "[", "arr", "]"}], ",", " ", "val", ",", " ", 
       "win"}], "]"}]}], "  ", ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "vicinity\[CenterEllipsis]indices\[CenterEllipsis]eff0", "[", " ", 
      RowBox[{"arr_", ",", "vals_", ",", "win_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", ",", " ", "lll"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "arr", "]"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"lll", " ", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"vicinity\[CenterEllipsis]ind\[CenterEllipsis]eff", "[", 
           RowBox[{
           "arr", ",", "inds", ",", "lll", ",", "#", ",", " ", "win"}], "]"}],
           "&"}], "/@", " ", "vals"}]}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"faster", " ", "variant"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vicinity\[CenterEllipsis]indices\[CenterEllipsis]eff", "[", " ", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"vals_", "?", "ArrayQ"}], ",", " ", "win_"}], "  ", "]"}], ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "inds", ",", " ", "lll", ",", "  ", "ind0", ",", "   ", "vind", ",", 
         "vlll"}], "\[IndentingNewLine]", "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ind0", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vind", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"inds", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "vals", "]"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"lll", " ", "=", 
         RowBox[{"Length", "[", "arr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vlll", "=", 
         RowBox[{"Length", "[", "vals", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", " ", 
         RowBox[{
          RowBox[{"vind", " ", "\[LessEqual]", " ", "vlll"}], ",", " ", 
          "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"While", "[", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ind0", "\[LessEqual]", "lll"}], " ", "&&", " ", 
              RowBox[{"!", 
               RowBox[{"(", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vals", "[", 
                   RowBox[{"[", "vind", "]"}], "]"}], "-", 
                  RowBox[{"win", "/", "2"}]}], "<", 
                 RowBox[{"arr", "[", 
                  RowBox[{"[", "ind0", "]"}], "]"}], "<", 
                 RowBox[{
                  RowBox[{"vals", "[", 
                   RowBox[{"[", "vind", "]"}], "]"}], "+", 
                  RowBox[{"win", "/", "2"}]}]}], " ", ")"}]}]}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"ind0", "++"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"inds", "[", 
             RowBox[{"[", "vind", "]"}], "]"}], "=", "ind0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vind", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Module", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ind1", ",", "ind2"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ind1", "=", 
              RowBox[{"inds", "[", 
               RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ind1", "-", "1"}], ">", "0"}], "      ", "&&", 
                 "  ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "ind", "]"}], "]"}], "-", 
                   RowBox[{"win", "/", "2"}]}], " ", "\[LessEqual]", " ", 
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"ind1", "-", "1"}], "]"}], "]"}], " ", 
                  "\[LessEqual]", " ", 
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "ind", "]"}], "]"}], "+", 
                   RowBox[{"win", "/", "2"}]}]}]}], " ", ")"}], ",", " ", 
               RowBox[{"ind1", "--"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ind2", "=", 
              RowBox[{"inds", "[", 
               RowBox[{"[", "ind", "]"}], "]"}]}], ";", " ", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ind2", "+", "1"}], "\[LessEqual]", "lll"}], "  ", "&&",
                  " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "ind", "]"}], "]"}], "-", 
                   RowBox[{"win", "/", "2"}]}], " ", "\[LessEqual]", " ", 
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{"ind2", "+", "1"}], "]"}], "]"}], " ", 
                  "\[LessEqual]", " ", 
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "ind", "]"}], "]"}], "+", 
                   RowBox[{"win", "/", "2"}]}]}]}], " ", ")"}], " ", ",", " ", 
               RowBox[{"ind2", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"ind1", ",", " ", "ind2"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ind", ",", " ", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "vlll"}], "]"}]}], "  ", "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2\[CenterEllipsis]eff", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"win_", "?", "NumberQ"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "\[IndentingNewLine]", "]"}], " ", 
     ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
          "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Mean", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "2"}], "]"}], "]"}], 
          "]"}]}], " ", "\[IndentingNewLine]", "}"}], "&"}], " ", "/@", "  ", 
      
      RowBox[{"vicinity\[CenterEllipsis]indices\[CenterEllipsis]eff", "[", 
       RowBox[{
        RowBox[{"arr", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "vals", ",", "win"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2\[CenterEllipsis]eff", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"win_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"step_", "?", "NumberQ"}]}], "\[IndentingNewLine]", "]"}], " ",
      ":=", " ", 
     RowBox[{"vmean2\[CenterEllipsis]eff", "[", 
      RowBox[{"arr", ",", "win", ",", " ", 
       RowBox[{"Range", "@@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
          "step"}], "]"}]}]}], " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"step_", "?", "NumberQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmean2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmean2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmean2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "vals"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Median", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
          "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Median", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "2"}], "]"}], "]"}], 
          "]"}]}], " ", "\[IndentingNewLine]", "}"}], "&"}], " ", "/@", "  ", 
      
      RowBox[{"vicinity\[CenterEllipsis]indices\[CenterEllipsis]eff", "[", 
       RowBox[{
        RowBox[{"arr", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "vals", ",", "win"}], 
       "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2\[CenterEllipsis]eff", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"win_", "?", "NumberQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"step_", "?", "NumberQ"}]}], "\[IndentingNewLine]", "]"}], " ",
      ":=", " ", 
     RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
      RowBox[{"arr", ",", "win", ",", " ", 
       RowBox[{"Range", "@@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
          "step"}], "]"}]}]}], " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"step_", "?", "NumberQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vmedian2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "vals"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", " ", 
       RowBox[{"win_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vic", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ";;", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
            "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"slope", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ";;", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], " ", 
          "\[IndentingNewLine]", "}"}], "&"}], " ", "/@", "  ", 
        RowBox[{"vicinity\[CenterEllipsis]indices\[CenterEllipsis]eff", "[", 
         RowBox[{
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "vals", ",", 
          "win"}], "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"arr_", "?", "ArrayQ"}], ",", 
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"step_", "?", "NumberQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
      RowBox[{"arr", ",", "win", ",", " ", 
       RowBox[{"Range", "@@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", " ", 
          "step"}], "]"}]}]}], "  ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"step_", "?", "NumberQ"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "step"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
      RowBox[{
       RowBox[{"win_", "?", "NumberQ"}], ",", 
       RowBox[{"vals_", "?", "ArrayQ"}]}], "]"}], "  ", ":=", " ", 
     RowBox[{
      RowBox[{"vslope2\[CenterEllipsis]eff", "[", 
       RowBox[{"#", ",", "win", ",", "vals"}], "]"}], "&"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->48], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox["adjust", "Subsection",
     FontSize->48], 
    StyleBox["*)", "Subsection",
     FontSize->48]}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->48], 
   StyleBox["\[IndentingNewLine]",
    FontSize->48], 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"adjustvaluesX", ",", "HoldAll"}], "]"}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   RowBox[{
    RowBox[{
     RowBox[{"adjustvaluesX", "[", " ", 
      RowBox[{"whatt_", ",", " ", "names_", " ", ",", " ", "data_"}], " ", 
      "]"}], " ", ":=", " ", 
     StyleBox["\[IndentingNewLine]", "Subsection"], 
     RowBox[{"Manipulate", "[", "  ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"aaa", ",", " ", "segs"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"DynamicModule", "[", " ", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{"mmm", ",", " ", 
             RowBox[{"active", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "  ", "//", 
                    " ", 
                    RowBox[{"map2", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"cc", "[", "\"\<B\>\"", "]"}], "]"}], "]"}], ",", 
                    " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"cc", "[", "\"\<f\>\"", "]"}], "]"}], "]"}]}], 
                    "  ", "}"}], " ", "&"}], "]"}]}], " ", "//", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"listplot", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"colorrange", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"names", "//", "Keys"}], "//", "Sort"}], ")"}], 
                    "]"}], "[", "ppp", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], " ", "//", "nice"}], ")"}], 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "//", 
                  "Flatten"}], "//", "Show"}], " ", "//", 
                RowBox[{"show", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ImageSize", "\[Rule]", "900"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"-", "20"}], ",", " ", "40"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"YYMin", ",", " ", "YYMax"}], "}"}], "1000"}]}], 
                    " ", "}"}]}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "//", 
                    "Values"}], ",", " ", 
                    RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"PlotLabel", "\[Rule]", "  ", 
                   RowBox[{"{", " ", 
                    RowBox[{"active", ",", " ", 
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}]}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], " ", "\[IndentingNewLine]", 
               ")"}], "//", "Dynamic"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                RowBox[{"(", " ", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"len", " ", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "]"}], "/", 
                    "2"}], "+", "1"}]}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"pos", "=", " ", 
                    RowBox[{
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"id", "=", 
                    RowBox[{"active", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{"act", "\[Equal]", "\"\<create\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"adjustM", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "1"}], "}"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", " ", "pos"}]}], ";", "  ", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"adjustM", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "2"}], "}"}], "]"}], "=", 
                    RowBox[{"1", "+", "pos"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"active", " ", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "2"}], "}"}]}]}], " ", 
                    "\[IndentingNewLine]", ")"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"adjustM", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", "1"}], "}"}], "]"}], "=."}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"adjustM", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", "2"}], "}"}], " ", "]"}], "=."}]}], 
                    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}], 
                 "\[IndentingNewLine]", ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<MouseDown\>\"", " ", "\[RuleDelayed]", " ", 
                RowBox[{"(", " ", 
                 RowBox[{"active", "=", 
                  RowBox[{"findclosest2", "[", 
                   RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", ")"}]}], 
               ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"\"\<MouseDragged\>\"", " ", "\[RuleDelayed]", " ", 
                RowBox[{"(", "  ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", "active", 
                   "]"}], " ", "=", 
                  RowBox[{
                   RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], " ", ")"}]}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Method", "\[Rule]", " ", "\"\<Preemptive\>\""}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ppp", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"names", "//", "Keys"}], "//", "Sort"}], ")"}], ",", " ", 
         RowBox[{"ControlType", "\[Rule]", "Setter"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"act", ",", " ", "\"\<create\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<delete\>\"", ",", " ", "\"\<create\>\""}], "}"}], " ", 
         ",", "  ", 
         RowBox[{"ControlType", "\[Rule]", "Setter"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"YYMin", ",", " ", "67"}], "}"}], ",", " ", "66", ",", " ", 
         "75"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"YYMax", ",", " ", "73"}], "}"}], ",", " ", "66", ",", " ", 
         "75"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"adjustvaluesY", ",", "HoldAll"}], "]"}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->36], 
   RowBox[{
    RowBox[{
     RowBox[{"adjustvaluesY", "[", " ", 
      RowBox[{"whatt_", ",", " ", "names_", " ", ",", " ", "data_"}], " ", 
      "]"}], " ", ":=", " ", 
     RowBox[{"Manipulate", "[", "  ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"aaa", ",", " ", "segs"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"DynamicModule", "[", " ", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{"mmm", ",", " ", 
             RowBox[{"active", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "  ", "//", 
                    " ", 
                    RowBox[{"map2", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"cc", "[", "\"\<B\>\"", "]"}], "]"}], "]"}], ",", 
                    " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"cc", "[", "\"\<f\>\"", "]"}], "]"}], "]"}]}], 
                    "  ", "}"}], " ", "&"}], "]"}]}], " ", "//", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"listplot", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "40"}], ",", "40"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"67", ",", "78"}], "}"}], "1000"}]}], "}"}]}], 
                    " ", ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"colorrange", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"names", "//", "Keys"}], "//", "Sort"}], ")"}], 
                    "]"}], "[", "ppp", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], " ", "//", "nice"}], ")"}], 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "//", 
                  "Flatten"}], "//", "Show"}], " ", "//", 
                RowBox[{"show", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ImageSize", "\[Rule]", "900"}], ",", 
                  "\[IndentingNewLine]", "\t", 
                  RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"-", "20"}], ",", " ", "40"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Ymin", ",", " ", "Ymax"}], "}"}], "1000"}]}], 
                    " ", "}"}]}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", "   ", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "//", 
                    "Values"}], ")"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"PlotLabel", "\[Rule]", "  ", 
                   RowBox[{"{", " ", 
                    RowBox[{"active", ",", " ", 
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}]}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], " ", "\[IndentingNewLine]", 
               ")"}], "//", "Dynamic"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                RowBox[{"(", " ", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"len", " ", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "]"}], "/", 
                    "2"}], "+", "1"}]}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"pos", "=", " ", 
                    RowBox[{
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"id", "=", 
                    RowBox[{"active", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{"act", "\[Equal]", "\"\<create\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "1"}], "}"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"-", "100"}], "+", " ", "pos"}]}], ";", "  ", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "2"}], "}"}], "]"}], "=", 
                    RowBox[{"100", "+", "pos"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"active", " ", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "2"}], "}"}]}]}], " ", 
                    "\[IndentingNewLine]", ")"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", "1"}], "}"}], "]"}], "=."}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", "2"}], "}"}], " ", "]"}], "=."}]}], 
                    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}], 
                 "\[IndentingNewLine]", ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<MouseDown\>\"", " ", "\[RuleDelayed]", " ", 
                RowBox[{"(", " ", 
                 RowBox[{"active", "=", 
                  RowBox[{"findclosest2", "[", 
                   RowBox[{
                    RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ")"}]}], 
               ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"\"\<MouseDragged\>\"", " ", "\[RuleDelayed]", " ", 
                RowBox[{"(", "  ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"whatt", "[", 
                    RowBox[{"names", "[", "ppp", "]"}], "]"}], "[", "active", 
                   "]"}], " ", "=", 
                  RowBox[{
                   RowBox[{"MousePosition", "[", 
                    RowBox[{"\"\<Graphics\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], " ", ")"}]}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Method", "\[Rule]", " ", "\"\<Preemptive\>\""}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ppp", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"names", "//", "Keys"}], "//", "Sort"}], ")"}], ",", " ", 
         RowBox[{"ControlType", "\[Rule]", "Setter"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"act", ",", " ", "\"\<create\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<delete\>\"", ",", " ", "\"\<create\>\""}], "}"}], " ", 
         ",", "  ", 
         RowBox[{"ControlType", "\[Rule]", "Setter"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ymin", ",", " ", "69"}], "}"}], ",", " ", "67", ",", 
         "73"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ymax", ",", " ", "72"}], "}"}], ",", " ", "67", ",", " ", 
         "73"}], "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.636141159354583*^9, 3.6361411638564653`*^9}, {
   3.636733168221966*^9, 3.636733170377927*^9}, {3.636735590135631*^9, 
   3.63673559349148*^9}, {3.6367361307630653`*^9, 3.63673617255357*^9}, {
   3.636750684909218*^9, 3.6367507421504917`*^9}, {3.636763463303238*^9, 
   3.636763540083682*^9}, {3.636763633073286*^9, 3.6367636398270884`*^9}, {
   3.636765774725658*^9, 3.636765777043282*^9}, {3.636765811249325*^9, 
   3.6367658639991693`*^9}, {3.6368086255358*^9, 3.636808723072221*^9}, {
   3.636811532547287*^9, 3.636811563415558*^9}, {3.636811601103195*^9, 
   3.636811709816429*^9}, 3.636812641488896*^9, 3.6368130138269377`*^9, {
   3.636823573304523*^9, 3.636823599522502*^9}, {3.63682365409182*^9, 
   3.636823692398512*^9}, {3.636823883376285*^9, 3.6368239154138727`*^9}, {
   3.636823994258296*^9, 3.6368240188096457`*^9}, {3.6368241363739243`*^9, 
   3.636824156529388*^9}, 3.6368243879045963`*^9, {3.636824425543172*^9, 
   3.636824446093759*^9}, {3.6368244852224894`*^9, 3.6368244858750353`*^9}, {
   3.636824516372631*^9, 3.636824621789115*^9}, {3.636824694835423*^9, 
   3.6368246956190157`*^9}, {3.636824941360629*^9, 3.6368258063242207`*^9}, {
   3.636825849002069*^9, 3.636825862930601*^9}, {3.6368259125451508`*^9, 
   3.636825955012199*^9}, {3.6368260114989023`*^9, 3.636826128607712*^9}, {
   3.636826173780971*^9, 3.636826189075193*^9}, {3.6368263012780857`*^9, 
   3.636826364675284*^9}, {3.6368264267310047`*^9, 3.6368264947634287`*^9}, {
   3.636826531111743*^9, 3.63682660500948*^9}, {3.636826702444479*^9, 
   3.6368268451093693`*^9}, {3.6368268751585407`*^9, 3.636826904629785*^9}, {
   3.636827034870021*^9, 3.6368271504734573`*^9}, {3.636827190623184*^9, 
   3.6368273073870573`*^9}, {3.636827366089241*^9, 3.636827433059642*^9}, {
   3.636827515881052*^9, 3.636827567365572*^9}, {3.6368277089848633`*^9, 
   3.636827757989675*^9}, {3.6368278232147703`*^9, 3.636827893264873*^9}, {
   3.636827931117879*^9, 3.636827957877133*^9}, {3.636828091551635*^9, 
   3.6368281013283777`*^9}, {3.636828163324367*^9, 3.6368282224262*^9}, {
   3.6368378271018143`*^9, 3.6368378627008963`*^9}, {3.636839560606872*^9, 
   3.636839604927449*^9}, {3.6368396603117313`*^9, 3.6368396822483807`*^9}, {
   3.6368397316635447`*^9, 3.636839733234552*^9}, {3.639249543835474*^9, 
   3.639249546888184*^9}, {3.640546913910905*^9, 3.640546921662313*^9}, {
   3.640547014574976*^9, 3.640547029402238*^9}, {3.640547350417115*^9, 
   3.640547469414557*^9}, {3.640547536244162*^9, 3.640547560090693*^9}, {
   3.640547618064444*^9, 3.640547630407094*^9}, {3.640548217895125*^9, 
   3.640548251587823*^9}, {3.6405500455178127`*^9, 3.640550112771137*^9}, {
   3.6406306710203037`*^9, 3.64063067430367*^9}, {3.640723372062933*^9, 
   3.640723373875227*^9}, {3.644060032535729*^9, 3.644060034702166*^9}, {
   3.6447745124854*^9, 3.644774519591234*^9}, {3.644774581168722*^9, 
   3.64477458439707*^9}, {3.644784241081068*^9, 3.644784243508803*^9}, {
   3.6455348077685537`*^9, 3.645534808673678*^9}, {3.64668878813245*^9, 
   3.646688815148231*^9}, 3.646688880287272*^9, {3.646828286781784*^9, 
   3.646828319372479*^9}, {3.646831081356455*^9, 3.646831100925976*^9}, 
   3.64684138082593*^9, {3.6469269868619623`*^9, 3.646927094562632*^9}, 
   3.6469271698697243`*^9, 3.646927373586319*^9, {3.646927789683218*^9, 
   3.646927809512117*^9}, {3.6469279419171553`*^9, 3.646927986158071*^9}, {
   3.64692803425886*^9, 3.646928208450973*^9}, {3.646928253846024*^9, 
   3.646928262430031*^9}, {3.646928329883277*^9, 3.646928445534926*^9}, {
   3.646928886953891*^9, 3.646928890099304*^9}, {3.646928947986927*^9, 
   3.646928996482917*^9}, {3.646929165279113*^9, 3.64692921598007*^9}, {
   3.646929330828567*^9, 3.646929386401052*^9}, {3.64692942683084*^9, 
   3.6469294364598007`*^9}, {3.6469300800357037`*^9, 
   3.6469300925152903`*^9}, {3.646930160148964*^9, 3.6469302697380333`*^9}, {
   3.646930476951395*^9, 3.646930540617856*^9}, {3.646930651612152*^9, 
   3.646930756718132*^9}, {3.6469308576857023`*^9, 3.646930931460834*^9}, {
   3.646932920327426*^9, 3.6469329468397827`*^9}, {3.646933226982009*^9, 
   3.646933227181548*^9}, {3.646933374996044*^9, 3.646933399217259*^9}, 
   3.646933496701923*^9, {3.646933653521002*^9, 3.6469337056575212`*^9}, {
   3.6469337385674973`*^9, 3.646933804774871*^9}, {3.646933837181982*^9, 
   3.6469340136183558`*^9}, {3.6469361285106792`*^9, 
   3.6469362031438017`*^9}, {3.646936913783252*^9, 3.646936924145179*^9}, {
   3.646937111571632*^9, 3.646937140511098*^9}, 3.646937177933271*^9, {
   3.646937393619607*^9, 3.646937469010128*^9}, 3.646937540638337*^9, {
   3.646937579220335*^9, 3.646937581929244*^9}, {3.6469378965886908`*^9, 
   3.646937989921692*^9}, {3.646938050117381*^9, 3.6469380847616243`*^9}, {
   3.64695192344102*^9, 3.6469519313892403`*^9}, {3.646952210610395*^9, 
   3.6469522271326323`*^9}, {3.646952960459034*^9, 3.6469529859449244`*^9}, {
   3.646953448787321*^9, 3.6469535761665087`*^9}, 3.6469545431304617`*^9, {
   3.6469561030092297`*^9, 3.64695614463562*^9}, {3.646956233808343*^9, 
   3.646956342933041*^9}, {3.646956448152452*^9, 3.64695645753481*^9}, {
   3.6469566660532207`*^9, 3.646956682992021*^9}, {3.646957090804202*^9, 
   3.646957094626549*^9}, {3.6469573769758377`*^9, 3.6469573830886602`*^9}, {
   3.646957512115486*^9, 3.646957555538341*^9}, {3.646957606428266*^9, 
   3.646957620662409*^9}, {3.646957667940771*^9, 3.646957682799142*^9}, {
   3.646958045785584*^9, 3.646958133854312*^9}, {3.646958284119708*^9, 
   3.646958284906848*^9}, {3.646958326609564*^9, 3.64695833054138*^9}, {
   3.6469583910863533`*^9, 3.6469583976152287`*^9}, 3.646958438452568*^9, {
   3.6470028384476213`*^9, 3.6470028873046083`*^9}, {3.647002921170038*^9, 
   3.647002980764964*^9}, {3.647003562293024*^9, 3.647003578849465*^9}, {
   3.647003931997603*^9, 3.647004007429946*^9}, {3.647004389491384*^9, 
   3.647004431477708*^9}, {3.647004778986994*^9, 3.647004791006732*^9}, {
   3.647005213421001*^9, 3.647005238364732*^9}, {3.647091669263315*^9, 
   3.647091674496355*^9}, {3.647091708970935*^9, 3.647091709500039*^9}, {
   3.647092515728177*^9, 3.647092552051559*^9}, 3.647092584455378*^9, {
   3.647092621271785*^9, 3.647092625224937*^9}, {3.647110121531452*^9, 
   3.6471101281132917`*^9}, {3.647110280379587*^9, 3.647110292040597*^9}, {
   3.647110901059575*^9, 3.647110979306102*^9}, {3.647111090419787*^9, 
   3.647111099286851*^9}, {3.647111169728384*^9, 3.647111230324794*^9}, {
   3.64711126043288*^9, 3.6471113096476927`*^9}, {3.647111372239253*^9, 
   3.647111384867584*^9}, {3.647111415468191*^9, 3.647111485320079*^9}, 
   3.647111517306451*^9, {3.6471116057222548`*^9, 3.6471116966943398`*^9}, {
   3.647111874743808*^9, 3.6471118972632236`*^9}, {3.647111966019405*^9, 
   3.647112026574815*^9}, {3.647113017943057*^9, 3.647113027898951*^9}, {
   3.647113728679325*^9, 3.6471137319259233`*^9}, {3.647114208742609*^9, 
   3.647114278727631*^9}, {3.647116074653425*^9, 3.647116093261483*^9}, {
   3.6471161773659773`*^9, 3.647116223181361*^9}, {3.647116286853033*^9, 
   3.647116484266144*^9}, {3.647116514749199*^9, 3.647116709021228*^9}, {
   3.647116776003405*^9, 3.6471168294571133`*^9}, 3.647116909352034*^9, {
   3.647116946681406*^9, 3.647117094536517*^9}, {3.647117157994371*^9, 
   3.647117180186585*^9}, {3.6471172296442432`*^9, 3.647117261424753*^9}, {
   3.6471173405470257`*^9, 3.6471174954501762`*^9}, {3.6471895149410763`*^9, 
   3.6471895310556173`*^9}, {3.647189565956272*^9, 3.64718959563727*^9}, {
   3.647190147193921*^9, 3.647190218973125*^9}, {3.647190280972335*^9, 
   3.647190283043282*^9}, {3.647253371670865*^9, 3.6472533718451147`*^9}, {
   3.6472592191906033`*^9, 3.6472593802561073`*^9}, {3.647259445185854*^9, 
   3.6472594748459272`*^9}, {3.6472595288356323`*^9, 3.647259610744625*^9}, 
   3.647427725650196*^9, {3.6474277755227737`*^9, 3.647427775594058*^9}, {
   3.647427806650683*^9, 3.647427856642898*^9}, {3.647427998796989*^9, 
   3.647428054297473*^9}, {3.6474280958299923`*^9, 3.647428111429206*^9}, {
   3.647428307646617*^9, 3.647428317972471*^9}, {3.647428434123967*^9, 
   3.647428506194467*^9}, {3.647428560758977*^9, 3.647428789438905*^9}, {
   3.6474288340046043`*^9, 3.647428857960557*^9}, {3.6474289375923367`*^9, 
   3.647429156469315*^9}, {3.647429212930285*^9, 3.6474292157173367`*^9}, {
   3.647429247010582*^9, 3.647429476188119*^9}, {3.6474295067703867`*^9, 
   3.647429710745482*^9}, {3.647429776903535*^9, 3.647429788227277*^9}, {
   3.64742982527632*^9, 3.6474298264823503`*^9}, {3.6474298642590847`*^9, 
   3.6474300636887503`*^9}, {3.647430146438861*^9, 3.647430216835338*^9}, {
   3.6474314025418053`*^9, 3.6474314118178463`*^9}, {3.647431607675192*^9, 
   3.6474316174439917`*^9}, 3.647431651680571*^9, {3.647431743392681*^9, 
   3.647431753009235*^9}, {3.6474317960219927`*^9, 3.647431799687408*^9}, {
   3.6474328928350487`*^9, 3.647432898150421*^9}, {3.647432930545411*^9, 
   3.6474331418922443`*^9}, {3.647540467060669*^9, 3.647540549939712*^9}, {
   3.6475406184911537`*^9, 3.647540667692193*^9}, {3.64754465055068*^9, 
   3.64754465099676*^9}, {3.647544732073354*^9, 3.6475447526160192`*^9}, {
   3.647544862252317*^9, 3.6475449175663767`*^9}, {3.6475449773888407`*^9, 
   3.647545321743246*^9}, {3.6475453737750998`*^9, 3.647545416153365*^9}, {
   3.647545576326866*^9, 3.647545639563817*^9}, {3.6475460680334663`*^9, 
   3.647546124966793*^9}, {3.647547268094705*^9, 3.647547295617413*^9}, {
   3.647547688647135*^9, 3.647547703179*^9}, {3.64754773342667*^9, 
   3.647547832840982*^9}, {3.647547915205903*^9, 3.647547922272946*^9}, {
   3.647549959900105*^9, 3.647549961732003*^9}, {3.647550053717857*^9, 
   3.647550154452428*^9}, {3.64755045501001*^9, 3.647550522856933*^9}, {
   3.64755058767976*^9, 3.647550596769518*^9}, {3.647551489148879*^9, 
   3.647551535660863*^9}, {3.6475517637455378`*^9, 3.647551795949225*^9}, {
   3.647551880862319*^9, 3.6475519132205553`*^9}, {3.6475519479814873`*^9, 
   3.647552042294964*^9}, {3.647552092564794*^9, 3.647552104231327*^9}, {
   3.647552167980081*^9, 3.6475521867019253`*^9}, {3.647552309018169*^9, 
   3.647552324433465*^9}, {3.647562811192028*^9, 3.647562836572487*^9}, {
   3.6475628684695473`*^9, 3.647562915520553*^9}, {3.6475630936250143`*^9, 
   3.647563094723068*^9}, {3.6475631637054367`*^9, 3.647563300851021*^9}, {
   3.647563338694173*^9, 3.647563340125597*^9}, {3.647563373179837*^9, 
   3.6475634988951178`*^9}, {3.647563534209673*^9, 3.647563552709779*^9}, {
   3.6475635895127783`*^9, 3.64756363857697*^9}, {3.647645016972106*^9, 
   3.647645045282898*^9}, {3.647645316361804*^9, 3.6476453869778967`*^9}, {
   3.6476454445850773`*^9, 3.647645450944229*^9}, {3.647645515101006*^9, 
   3.647645520636051*^9}, {3.647645592198472*^9, 3.647645612207095*^9}, 
   3.6476460200800877`*^9, {3.647646062773912*^9, 3.647646106448316*^9}, {
   3.647646213898555*^9, 3.647646359608712*^9}, 3.647646663822505*^9, {
   3.647646711229445*^9, 3.64764671764277*^9}, {3.6476476063397703`*^9, 
   3.647647633680595*^9}, {3.647647762086042*^9, 3.647647778617804*^9}, {
   3.6477789359361057`*^9, 3.6477789384092484`*^9}, 3.6477790719012136`*^9, {
   3.647859432827784*^9, 3.647859434708241*^9}, 3.6481533669301853`*^9, {
   3.6481535103267612`*^9, 3.6481535346113167`*^9}, {3.648154031425189*^9, 
   3.6481540325763407`*^9}, 3.648154211568502*^9, {3.6481544020405493`*^9, 
   3.648154402331666*^9}, {3.6481544521529703`*^9, 3.6481544580191793`*^9}, {
   3.648651925629171*^9, 3.6486519980370293`*^9}, {3.648652053834364*^9, 
   3.648652056976479*^9}, {3.648688558272851*^9, 3.648688564908243*^9}, {
   3.648688609930587*^9, 3.648688622883485*^9}, {3.648688661624877*^9, 
   3.6486887120051603`*^9}, {3.648688745927066*^9, 3.6486887576947193`*^9}, {
   3.6486888942793293`*^9, 3.6486888972549753`*^9}, {3.64868896800574*^9, 
   3.648689035801826*^9}, {3.648689260637097*^9, 3.6486894370359983`*^9}, {
   3.648689554583009*^9, 3.648689574364444*^9}, 3.648690212043215*^9, {
   3.648746495111968*^9, 3.64874651557948*^9}, {3.648747675329166*^9, 
   3.6487477225865107`*^9}, {3.648748053062436*^9, 3.6487480571715393`*^9}, {
   3.649250305205122*^9, 3.6492503251007137`*^9}, {3.649250746850357*^9, 
   3.649250840902532*^9}, {3.651068748720728*^9, 3.651068920678331*^9}, {
   3.656086405783825*^9, 3.6560865399126043`*^9}, {3.656086610980901*^9, 
   3.6560866543386707`*^9}, {3.6560867646088142`*^9, 
   3.6560867654721622`*^9}, {3.656086795962528*^9, 3.656086796033245*^9}, {
   3.656086900555956*^9, 3.656086968405588*^9}, {3.656270752871285*^9, 
   3.656270756775475*^9}, {3.658774135452011*^9, 3.658774135948032*^9}, {
   3.658776292033875*^9, 3.658776292345495*^9}, {3.6587763242468567`*^9, 
   3.658776368190695*^9}, {3.6587774700485*^9, 3.658777470255044*^9}, {
   3.658777647852536*^9, 3.658777663283939*^9}, {3.658777705631735*^9, 
   3.658777737184719*^9}, {3.6587852937006197`*^9, 3.658785320769628*^9}, {
   3.658785387637596*^9, 3.658785412148788*^9}, {3.658785446769615*^9, 
   3.6587854567949*^9}, {3.658934713187829*^9, 3.6589347169293337`*^9}, {
   3.658950272779272*^9, 3.658950284341617*^9}, {3.658953752764288*^9, 
   3.658953801555398*^9}, {3.658953903497713*^9, 3.658953923570505*^9}, {
   3.658953985895879*^9, 3.658953992433827*^9}, 3.6589556720960712`*^9, {
   3.661443905762418*^9, 3.66144391392104*^9}, {3.6614658206493883`*^9, 
   3.6614658875053062`*^9}, {3.661466016293942*^9, 3.6614660321132317`*^9}, {
   3.662391808010387*^9, 3.662391894784786*^9}, {3.662581512206511*^9, 
   3.6625815147114162`*^9}, {3.664027991890279*^9, 3.664028011868258*^9}, {
   3.665574872034944*^9, 3.665574890425261*^9}, {3.665575363184278*^9, 
   3.6655753725683613`*^9}, {3.665575469678722*^9, 3.665575473893443*^9}, {
   3.665575611763761*^9, 3.6655756157995777`*^9}, {3.665575670790104*^9, 
   3.6655756911672173`*^9}, {3.665602986794681*^9, 3.6656029873138227`*^9}, {
   3.666032096995812*^9, 3.666032330602936*^9}, 3.6666526844270678`*^9, {
   3.666652777477083*^9, 3.666652850978115*^9}, {3.666653263127891*^9, 
   3.666653294964045*^9}, {3.6666538398853397`*^9, 3.666653842338188*^9}, {
   3.666798717743843*^9, 3.6667987180441513`*^9}, {3.666798752320765*^9, 
   3.66679877876889*^9}, {3.6667988777442904`*^9, 3.666798883190852*^9}, {
   3.666798964586698*^9, 3.66679898553594*^9}, {3.6667991383307953`*^9, 
   3.6667991669868107`*^9}, {3.666799204623953*^9, 3.6667992326105967`*^9}, {
   3.666799923246207*^9, 3.6668000689829884`*^9}, {3.666800154368194*^9, 
   3.666800182698544*^9}, {3.6668002439744873`*^9, 3.666800260293375*^9}, {
   3.6668004656146183`*^9, 3.666800982323132*^9}, {3.666801268704705*^9, 
   3.666801299945167*^9}, {3.6668017562780323`*^9, 3.6668018496109953`*^9}, {
   3.6668019007777367`*^9, 3.666801959763154*^9}, {3.666802054666614*^9, 
   3.6668020583144627`*^9}, {3.666802176033155*^9, 3.6668021869478083`*^9}, {
   3.666802226403668*^9, 3.666802226874378*^9}, {3.666802382565813*^9, 
   3.6668023935109158`*^9}, {3.666802438321352*^9, 3.666802498395961*^9}, {
   3.6668030201982*^9, 3.666803040437845*^9}, {3.666803095489303*^9, 
   3.666803096647477*^9}, {3.666886632505954*^9, 3.666886636552556*^9}, {
   3.6739631986283693`*^9, 3.673963208968261*^9}, {3.675540346124057*^9, 
   3.675540346656767*^9}, {3.680716263639192*^9, 3.680716286100314*^9}, 
   3.6845227471949787`*^9, {3.6864324980422173`*^9, 3.686432558702239*^9}, {
   3.686432611203672*^9, 3.6864326247628307`*^9}, {3.686432775360314*^9, 
   3.686432887715177*^9}, {3.686433487538309*^9, 3.686433489944882*^9}, 
   3.686433781941831*^9, {3.6864339630498323`*^9, 3.68643396444788*^9}, {
   3.6864340026590357`*^9, 3.686434019326812*^9}, {3.686434058623933*^9, 
   3.6864340952788677`*^9}, {3.68643414218609*^9, 3.6864341763233843`*^9}, {
   3.68643421919879*^9, 3.686434321093628*^9}, {3.686434356412579*^9, 
   3.6864343839921722`*^9}, {3.686434454240263*^9, 3.686434463677474*^9}, {
   3.686434568248191*^9, 3.686434618909924*^9}, {3.686434659779912*^9, 
   3.6864347191875553`*^9}, {3.686434754542431*^9, 3.6864348200397882`*^9}, {
   3.686434853575674*^9, 3.6864349466788063`*^9}, {3.6864349815047007`*^9, 
   3.686434984975112*^9}, {3.686435038034881*^9, 3.686435112231256*^9}, {
   3.686435884123226*^9, 3.686435937530644*^9}, {3.686436601648877*^9, 
   3.686436784772708*^9}, {3.686436895069803*^9, 3.6864370814722757`*^9}, {
   3.6864371705208073`*^9, 3.686437171705038*^9}, {3.686437259487859*^9, 
   3.6864372703959293`*^9}, {3.68643730471774*^9, 3.686437364735602*^9}, {
   3.686437460470735*^9, 3.68643748282955*^9}, 3.686605840947475*^9, {
   3.686605885807687*^9, 3.686605961430913*^9}, {3.6866060768199177`*^9, 
   3.686606076931095*^9}, {3.6866062716217747`*^9, 3.686606275291697*^9}, {
   3.686606390780284*^9, 3.6866064304111013`*^9}, {3.686606483932026*^9, 
   3.686606566590115*^9}, 3.686606684424745*^9, {3.688664418528369*^9, 
   3.688664422104074*^9}, {3.6886645525803432`*^9, 3.6886646010889463`*^9}, {
   3.688665285893591*^9, 3.688665296997513*^9}, {3.688665376964065*^9, 
   3.688665400905344*^9}, {3.688665434021874*^9, 3.688665441018618*^9}, {
   3.6886654820524197`*^9, 3.688665495823051*^9}, {3.688665743657402*^9, 
   3.6886657811910257`*^9}, {3.6886658150866833`*^9, 3.688665846403812*^9}, {
   3.688683062072727*^9, 3.688683066847327*^9}, {3.6886843689299917`*^9, 
   3.688684379536722*^9}, {3.689438639482272*^9, 3.689438680702725*^9}, {
   3.6894389294750147`*^9, 3.689439033761043*^9}, 3.689439116382195*^9, {
   3.689458669067068*^9, 3.689458761141049*^9}, {3.689459249221559*^9, 
   3.689459259108015*^9}, 3.6894594738713284`*^9, {3.689459567741651*^9, 
   3.689459785285276*^9}, {3.68945981750928*^9, 3.6894599860087233`*^9}, {
   3.689460036324376*^9, 3.689460074338949*^9}, {3.689460116262796*^9, 
   3.68946015537356*^9}, {3.689460188505836*^9, 3.689460191945468*^9}, 
   3.68946022446621*^9, {3.6894603765081472`*^9, 3.6894603777711287`*^9}, {
   3.68946047113553*^9, 3.689460513751659*^9}, {3.6909963139709272`*^9, 
   3.6909963809162197`*^9}, 3.6909965871119547`*^9, {3.6982463161533623`*^9, 
   3.698246408670261*^9}, {3.6982464588792543`*^9, 3.6982464916439238`*^9}, {
   3.698246525653762*^9, 3.698246527817037*^9}, {3.69824950158394*^9, 
   3.69824952375025*^9}, {3.698250152649551*^9, 3.6982501649772463`*^9}, {
   3.698250207963829*^9, 3.6982502309544*^9}, {3.6982503153039618`*^9, 
   3.698250344446702*^9}, {3.698250383724596*^9, 3.6982504355993443`*^9}, {
   3.698250488836215*^9, 3.698250495519273*^9}, {3.698256142512025*^9, 
   3.698256226134163*^9}, {3.6982562741291113`*^9, 3.6982562835252037`*^9}, {
   3.6982564412527103`*^9, 3.6982565002900057`*^9}, 3.698256532955679*^9, {
   3.698275649486136*^9, 3.698275717928232*^9}, {3.6982768272701263`*^9, 
   3.69827688217234*^9}, {3.698276949401909*^9, 3.698276949840972*^9}, {
   3.698277179003044*^9, 3.698277343601083*^9}, {3.698277517627473*^9, 
   3.698277541341415*^9}, {3.69827841537086*^9, 3.6982784695806017`*^9}, {
   3.698596167903042*^9, 3.6985961731496353`*^9}, {3.698777373087232*^9, 
   3.6987774431092043`*^9}, {3.698777779171844*^9, 3.6987778071461983`*^9}, {
   3.698777841921472*^9, 3.6987778662908373`*^9}, {3.6987779673723173`*^9, 
   3.6987779680723886`*^9}, {3.6988660871745577`*^9, 3.698866133404525*^9}, {
   3.698866171744869*^9, 3.698866191807139*^9}, {3.699307113195531*^9, 
   3.6993071224008417`*^9}, {3.700137939520795*^9, 3.700137987855175*^9}, {
   3.700138045096847*^9, 3.700138239699375*^9}, {3.700138271927738*^9, 
   3.700138372967095*^9}, {3.700138451890555*^9, 3.700138568129408*^9}, {
   3.700138618700453*^9, 3.7001386998956614`*^9}, {3.70014042891115*^9, 
   3.700140445109111*^9}, 3.7001404836255617`*^9, {3.700140527426918*^9, 
   3.7001405813740177`*^9}, {3.700140630931878*^9, 3.700140803209387*^9}, {
   3.700140854023127*^9, 3.7001409486876707`*^9}, 3.7001410242182207`*^9, {
   3.7001411606140347`*^9, 3.700141200759112*^9}, {3.70014124109699*^9, 
   3.7001412827330303`*^9}, {3.7001413127422037`*^9, 3.700141374111369*^9}, 
   3.700141500202248*^9, 3.700141593689271*^9, {3.700141642837822*^9, 
   3.700141647979692*^9}, {3.700141782261531*^9, 3.700141825478682*^9}, {
   3.7001419172987328`*^9, 3.700141936793914*^9}, {3.7001663469658203`*^9, 
   3.7001666382272797`*^9}, {3.700166672812871*^9, 3.70016669962*^9}, {
   3.700166747585367*^9, 3.700166819805101*^9}, {3.700166941212631*^9, 
   3.700166947867036*^9}, {3.700166984565524*^9, 3.700167032931856*^9}, {
   3.70016711162211*^9, 3.700167214385828*^9}, {3.700246243307035*^9, 
   3.700246251925769*^9}, {3.700246291629525*^9, 3.700246397117177*^9}, {
   3.70024646511292*^9, 3.7002465424907227`*^9}, {3.700246586785922*^9, 
   3.700246683369087*^9}, {3.7002467138821993`*^9, 3.700246753407619*^9}, {
   3.7072444759456778`*^9, 3.707244486531063*^9}, {3.707244597783947*^9, 
   3.707244639456579*^9}, {3.707244913266087*^9, 3.707244979244947*^9}, {
   3.710785815502865*^9, 3.7107858500525846`*^9}, {3.710785899624588*^9, 
   3.71078595915345*^9}, {3.710795630407483*^9, 3.710795656365343*^9}, {
   3.710795797963152*^9, 3.71079580950889*^9}, {3.710946256758107*^9, 
   3.710946275812305*^9}, {3.710948964970993*^9, 3.710949093373005*^9}, {
   3.7109498107898293`*^9, 3.710949915812436*^9}, {3.710951923947506*^9, 
   3.710951981234345*^9}, {3.711067367001589*^9, 3.711067368378138*^9}, {
   3.711067411565419*^9, 3.711067450520088*^9}, {3.711067565416286*^9, 
   3.711067605873493*^9}, {3.711067638537149*^9, 3.711067849865591*^9}, {
   3.7110679850164843`*^9, 3.71106816848158*^9}, {3.7110692744113207`*^9, 
   3.7110693432538652`*^9}, {3.711069455400312*^9, 3.711069495460194*^9}, 
   3.7110695943910503`*^9, {3.711136661622875*^9, 3.711136668786284*^9}, 
   3.711136737170669*^9, {3.711141218892654*^9, 3.711141241760017*^9}, 
   3.711141304673155*^9, {3.711141411364294*^9, 3.71114146129389*^9}, {
   3.7111416537265987`*^9, 3.7111416880744*^9}, {3.71114189741295*^9, 
   3.711141922039381*^9}, {3.711143733249198*^9, 3.711143767532529*^9}, {
   3.711144517127152*^9, 3.711144517897893*^9}, {3.711144603430395*^9, 
   3.711144624990157*^9}, {3.7111451623778877`*^9, 3.711145217076247*^9}, {
   3.7111452530092173`*^9, 3.7111453932350683`*^9}, {3.711145508829146*^9, 
   3.711145534699543*^9}, {3.711145751577136*^9, 3.7111457540193453`*^9}, {
   3.711146028340173*^9, 3.7111460503126507`*^9}, {3.711146147618288*^9, 
   3.7111461667042027`*^9}, {3.71114620807019*^9, 3.711146246614057*^9}, 
   3.7111463310215282`*^9, {3.7111463715663958`*^9, 3.711146391713657*^9}, {
   3.7111464530081453`*^9, 3.7111464554840183`*^9}, {3.711146485909009*^9, 
   3.711146516810855*^9}, {3.711146555951947*^9, 3.7111466333531847`*^9}, {
   3.711146738256851*^9, 3.711146765100473*^9}, {3.7111471067516623`*^9, 
   3.711147304480526*^9}, {3.711147354307208*^9, 3.711147445054443*^9}, {
   3.711147476589491*^9, 3.711147500344638*^9}, {3.711147572166933*^9, 
   3.711147608682951*^9}, {3.7111476486235228`*^9, 3.711147673885779*^9}, {
   3.71114781195885*^9, 3.711147834861569*^9}, {3.711147895355027*^9, 
   3.711147950164565*^9}, {3.7111480411060333`*^9, 3.711148106355452*^9}, 
   3.71114815408843*^9, 3.711148238476404*^9, {3.711148467008593*^9, 
   3.7111484678335543`*^9}, {3.711148505434676*^9, 3.711148515756406*^9}, {
   3.711148581486491*^9, 3.711148604373765*^9}, {3.7111486791315823`*^9, 
   3.711148688148584*^9}, 3.711149252466288*^9, {3.7111494467088346`*^9, 
   3.711149481983567*^9}, 3.711149541151888*^9, {3.711149594054429*^9, 
   3.7111496071771593`*^9}, {3.7111557171208897`*^9, 
   3.7111558617198257`*^9}, {3.711155893259488*^9, 3.71115595048067*^9}, {
   3.711155988244014*^9, 3.71115608289509*^9}, {3.711156114191462*^9, 
   3.7111561775661488`*^9}, {3.711156981020918*^9, 3.7111570305409727`*^9}, {
   3.711157080477833*^9, 3.711157241354589*^9}, {3.711157327614049*^9, 
   3.7111573825147133`*^9}, {3.7111577718167267`*^9, 3.7111578359746637`*^9}, 
   3.7121735030812883`*^9, {3.712173558114215*^9, 3.712173749454954*^9}, {
   3.7127702223895893`*^9, 3.712770231824122*^9}, {3.717802335118267*^9, 
   3.7178023353465548`*^9}, {3.7178023932365932`*^9, 3.717802410848549*^9}, {
   3.717802454285768*^9, 3.7178024737510653`*^9}, {3.7178025780829887`*^9, 
   3.717802598332735*^9}, {3.717804632730402*^9, 3.717804647121771*^9}, 
   3.717804683895566*^9, {3.717948691696813*^9, 3.717948780069772*^9}, {
   3.718671364264975*^9, 3.718671438448379*^9}, {3.720713227158246*^9, 
   3.72071327036115*^9}, {3.72071333213806*^9, 3.7207133665538797`*^9}, {
   3.720713401793983*^9, 3.720713417245487*^9}, {3.720713449898755*^9, 
   3.720713481486476*^9}, {3.722719000659493*^9, 3.722719001641356*^9}, {
   3.7227190471320047`*^9, 3.722719047478587*^9}, {3.722793151835286*^9, 
   3.722793161744238*^9}, {3.722793354350943*^9, 3.7227933786298237`*^9}, {
   3.722793459624061*^9, 3.722793459736582*^9}, {3.7239242090502987`*^9, 
   3.723924221278307*^9}, {3.7239258089684877`*^9, 3.723925838166554*^9}, {
   3.730328037341836*^9, 3.730328161917243*^9}, {3.73032846630313*^9, 
   3.730328577254239*^9}, {3.730328682941832*^9, 3.730328875975326*^9}, {
   3.730328932432932*^9, 3.730328958703053*^9}, {3.730329002643774*^9, 
   3.730329002817883*^9}, {3.730329040548071*^9, 3.730329094393099*^9}, {
   3.7316153199959927`*^9, 3.7316153231955357`*^9}, {3.733856046145897*^9, 
   3.733856059875455*^9}, {3.733945029481977*^9, 3.733945032116962*^9}, {
   3.73394506919317*^9, 3.733945083899452*^9}, 3.7376406707800283`*^9, {
   3.7376586945178547`*^9, 3.737658694840666*^9}, {3.7482012733121643`*^9, 
   3.74820129057796*^9}, {3.748296591980579*^9, 3.748296639653224*^9}, {
   3.748296670184667*^9, 3.748296779297348*^9}, {3.748300803386281*^9, 
   3.748300858735113*^9}, {3.748300916308832*^9, 3.748300927946546*^9}, {
   3.748301010755085*^9, 3.748301050824943*^9}, {3.748301138352221*^9, 
   3.7483012191816*^9}, {3.7483013021980543`*^9, 3.748301459769315*^9}, 
   3.748301808035934*^9, {3.748301898261485*^9, 3.748302141764303*^9}, {
   3.748302219470442*^9, 3.748302346967808*^9}, {3.7483024010246553`*^9, 
   3.7483024484193707`*^9}, {3.7483024874673147`*^9, 3.748302520422494*^9}, {
   3.748305303904388*^9, 3.748305333415559*^9}, {3.74830724447075*^9, 
   3.74830725738638*^9}, 3.7483072998412313`*^9, {3.748307373627742*^9, 
   3.748307410572607*^9}, {3.7483074467113934`*^9, 3.748307481096156*^9}, {
   3.748307746796543*^9, 3.748307887205052*^9}, {3.748307926229179*^9, 
   3.7483080899288*^9}, {3.748308333051219*^9, 3.748308402251769*^9}, {
   3.748308821505938*^9, 3.7483089027565737`*^9}, {3.748366009963358*^9, 
   3.7483660719650383`*^9}, {3.7505311187988033`*^9, 
   3.7505311211015997`*^9}, {3.75053417410205*^9, 3.750534208318326*^9}, {
   3.7509863371509447`*^9, 3.750986348470487*^9}, {3.75098639888052*^9, 
   3.750986566398492*^9}, {3.750986598248444*^9, 3.750986631129628*^9}, {
   3.750986940288115*^9, 3.750986972201474*^9}, 3.750987121835129*^9, {
   3.750987204844202*^9, 3.750987237190631*^9}, {3.750987305369467*^9, 
   3.750987324412531*^9}, {3.750987393395629*^9, 3.750987403008588*^9}, {
   3.7509875951837482`*^9, 3.7509876104200583`*^9}, 3.750987675196347*^9, {
   3.7509877964736643`*^9, 3.750987796691793*^9}, {3.750987836781686*^9, 
   3.7509878388173656`*^9}, {3.7509878911060467`*^9, 3.750987901253282*^9}, {
   3.750987941820127*^9, 3.750987948404121*^9}, {3.750988105401462*^9, 
   3.750988107890407*^9}, {3.7509881387956657`*^9, 3.750988157136806*^9}, {
   3.7509882205321913`*^9, 3.750988261638736*^9}, {3.7509883106450377`*^9, 
   3.750988318425201*^9}, {3.750988413500388*^9, 3.7509884347019987`*^9}, {
   3.750988510293085*^9, 3.750988519834614*^9}, {3.750988747332222*^9, 
   3.750988760557296*^9}, {3.750988837275793*^9, 3.7509888397882147`*^9}, {
   3.750988887559161*^9, 3.750988890132676*^9}, {3.750988938969751*^9, 
   3.750988976489933*^9}, {3.750989036095022*^9, 3.7509890414293127`*^9}, {
   3.750989193099743*^9, 3.750989197025639*^9}, {3.7509894097966003`*^9, 
   3.750989412631135*^9}, {3.750989563332952*^9, 3.7509895666096973`*^9}, {
   3.751002206027031*^9, 3.7510022218471193`*^9}, {3.751002513319625*^9, 
   3.7510025183154507`*^9}, {3.7510741195508003`*^9, 3.75107412080956*^9}, {
   3.7512420367220984`*^9, 3.751242039486867*^9}, {3.7512420739213047`*^9, 
   3.751242077441186*^9}, {3.751413317545713*^9, 3.75141335230991*^9}, {
   3.7514134118952093`*^9, 3.7514136522713137`*^9}, {3.751413807673563*^9, 
   3.751413810242857*^9}, {3.7514138698930264`*^9, 3.7514138740098352`*^9}, {
   3.751413965497212*^9, 3.751413966096328*^9}, {3.751414007609618*^9, 
   3.751414214402087*^9}, 3.751414250983345*^9, {3.751414358045498*^9, 
   3.751414385096579*^9}, {3.751416423698215*^9, 3.751416501738441*^9}, {
   3.751416628265674*^9, 3.751416894695197*^9}, {3.751416983517816*^9, 
   3.751417017717716*^9}, {3.751417538836617*^9, 3.751417542377041*^9}, {
   3.751417587606748*^9, 3.751417625091744*^9}, {3.751670960701975*^9, 
   3.75167100697543*^9}, {3.751671078811822*^9, 3.7516710839827547`*^9}, {
   3.751671124013714*^9, 3.751671221993462*^9}, {3.75167128573066*^9, 
   3.75167137177876*^9}, {3.751671523041614*^9, 3.751671585646452*^9}, {
   3.751671948257986*^9, 3.7516719487744837`*^9}, {3.7516720238374968`*^9, 
   3.75167202921523*^9}, {3.751672066393506*^9, 3.7516720722147303`*^9}, {
   3.7516721309317093`*^9, 3.751672131132874*^9}, {3.751672167535076*^9, 
   3.751672183907811*^9}, {3.751672386483238*^9, 3.7516725229386387`*^9}, {
   3.75167255828528*^9, 3.751672756652326*^9}, {3.7516729147220173`*^9, 
   3.75167297735522*^9}, {3.7516730094369173`*^9, 3.751673034428632*^9}, 
   3.751673278792552*^9, {3.751673726807932*^9, 3.751673743471038*^9}, {
   3.751673895000526*^9, 3.751673951893365*^9}, {3.751680195948288*^9, 
   3.751680300303191*^9}, {3.754416779646405*^9, 3.754416819592441*^9}, {
   3.7544168764262342`*^9, 3.754416899898033*^9}, {3.754417217083907*^9, 
   3.754417295462281*^9}, 3.7544173768348417`*^9, {3.75442373359975*^9, 
   3.754423735365638*^9}, 3.756082800140575*^9, {3.7560828540458603`*^9, 
   3.756082886159089*^9}, 3.756082923019643*^9, 3.756083041660903*^9, 
   3.7560832013660917`*^9, {3.756084358170827*^9, 3.756084374906972*^9}, {
   3.7560863169884577`*^9, 3.7560863984698668`*^9}, 3.7560866001380177`*^9, {
   3.756141992654344*^9, 3.756141996339676*^9}, {3.76531604699683*^9, 
   3.7653161232524757`*^9}, {3.765318865871304*^9, 3.765318971860113*^9}, {
   3.7653198264825573`*^9, 3.765319826870948*^9}, {3.7657312488568497`*^9, 
   3.7657312506551847`*^9}, {3.765743640968829*^9, 3.765743653886136*^9}, {
   3.765743694208816*^9, 3.765743929366746*^9}, {3.765744027608453*^9, 
   3.765744027796363*^9}, {3.7657442835590467`*^9, 3.765744308736146*^9}, {
   3.765744462421267*^9, 3.765744534988533*^9}, {3.766676880861274*^9, 
   3.7666768812594147`*^9}, {3.7668466531884403`*^9, 3.76684665545928*^9}, {
   3.766848753409254*^9, 3.766848776200111*^9}, {3.766848834217746*^9, 
   3.76684897815672*^9}, {3.766849029131793*^9, 3.766849035957163*^9}, {
   3.766849150936618*^9, 3.766849164683557*^9}, {3.766849393236923*^9, 
   3.7668493996485558`*^9}, {3.767042707557588*^9, 3.767042729257827*^9}, {
   3.7670428791321774`*^9, 3.767042945368285*^9}, {3.767270281025557*^9, 
   3.767270281347744*^9}, {3.767270659916499*^9, 3.76727068360186*^9}, {
   3.7672708297998533`*^9, 3.767270889675551*^9}, {3.767270952782757*^9, 
   3.767270992225526*^9}, {3.767271025327422*^9, 3.767271065072003*^9}, {
   3.7672713770647087`*^9, 3.767271378597631*^9}, {3.767293432001664*^9, 
   3.7672935010602617`*^9}, {3.767294650300383*^9, 3.767294657756057*^9}, {
   3.767461732093425*^9, 3.767461741272293*^9}, {3.767630675966898*^9, 
   3.767630679262038*^9}, {3.767791112370523*^9, 3.7677911269165163`*^9}, {
   3.767791169070813*^9, 3.767791189983553*^9}, {3.76779179031782*^9, 
   3.767791821787806*^9}, {3.767791905758218*^9, 3.767791926563957*^9}, {
   3.767791986198489*^9, 3.767792043929922*^9}, {3.767797500110011*^9, 
   3.7677975361663103`*^9}, {3.767797572281805*^9, 3.767797629734682*^9}, {
   3.767797714777142*^9, 3.767797757907741*^9}, {3.767797804182097*^9, 
   3.76779780835674*^9}, 3.76806416205721*^9, {3.7680642017116623`*^9, 
   3.76806425233241*^9}, {3.768064325648287*^9, 3.7680645010818768`*^9}, {
   3.7680645323056183`*^9, 3.768064555050713*^9}, {3.768064741130108*^9, 
   3.768064749343873*^9}, {3.768064814230565*^9, 3.768064862546459*^9}, {
   3.7680649089537992`*^9, 3.768065025730089*^9}, {3.7680651448275013`*^9, 
   3.768065212828494*^9}, 3.768065321624289*^9, {3.7680653647432413`*^9, 
   3.768065533162911*^9}, {3.768065596806121*^9, 3.768065624432728*^9}, {
   3.769717276855661*^9, 3.769717277336823*^9}, {3.771354761192349*^9, 
   3.7713548092699633`*^9}, {3.7713548455627337`*^9, 
   3.7713548495791187`*^9}, {3.771354945116493*^9, 3.771354946789592*^9}, {
   3.771355258049922*^9, 3.7713553619934807`*^9}, 3.771355404409684*^9, {
   3.771356547683703*^9, 3.771356654252893*^9}, {3.771356706096509*^9, 
   3.771356807557547*^9}, {3.7713570446966667`*^9, 3.771357086939458*^9}, {
   3.771429634225999*^9, 3.77142964262776*^9}, {3.7714337019549417`*^9, 
   3.7714337042149477`*^9}, {3.771435120253098*^9, 3.771435177864339*^9}, 
   3.771435623645247*^9, {3.771437139066568*^9, 3.7714371804511137`*^9}, {
   3.771437717417762*^9, 3.771437771290943*^9}, {3.7714382422277317`*^9, 
   3.771438332058523*^9}, {3.771438399138462*^9, 3.7714384330147753`*^9}, {
   3.7716867608462687`*^9, 3.771686794251047*^9}, {3.771686875017096*^9, 
   3.771686924309917*^9}, {3.771687079965927*^9, 3.77168715896561*^9}, {
   3.771687207596562*^9, 3.771687375636566*^9}, 3.7716876137467213`*^9, {
   3.771687775832095*^9, 3.771687794415629*^9}, {3.77168782465256*^9, 
   3.771687959819206*^9}, 3.772393155237863*^9, {3.778008231384789*^9, 
   3.778008249046542*^9}, {3.7783494510334587`*^9, 3.778349465327458*^9}, {
   3.778429726465087*^9, 3.778429733091866*^9}, {3.7784298390860653`*^9, 
   3.7784298479283743`*^9}, {3.778429918997477*^9, 3.778429935825375*^9}, {
   3.7784299669429913`*^9, 3.7784301118329563`*^9}, {3.778605280015946*^9, 
   3.7786053195964413`*^9}, {3.7786054425110893`*^9, 
   3.7786054448650084`*^9}, {3.778605712243547*^9, 3.778605755938092*^9}, {
   3.77860579036241*^9, 3.778605889733244*^9}, {3.778605970266086*^9, 
   3.77860598303246*^9}, {3.784563193160153*^9, 3.7845632692383842`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"a9c360a9-843d-4043-9466-d09f6488a94e"],

Cell[BoxData[
 RowBox[{"(*", "\n", "\n", "\n", "\n", 
  StyleBox["\n",
   FontSize->168], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["other",
      FontSize->168], "\n", "\n", "\n", "\n", "\n", "\n", "\n", "\n", "\n", 
     "\n", "\n", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
     "\n", "\n", "\[IndentingNewLine]", "\n", "\n", "\[IndentingNewLine]", 
     "\n", 
     RowBox[{"vicinity", "[", 
      RowBox[{"arr_", ",", 
       RowBox[{"w_", "?", "AssociationQ"}]}], "]"}]}], ":=", " ", 
    RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arra", "=", 
         RowBox[{
          RowBox[{"arr", "//", "toalist"}], "//", "Normal"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"arraR", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"arr", "//", "toalist"}], ")"}], "//", "Reverse"}], "//", 
          "Normal"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"le", "=", " ", 
         RowBox[{"arr", "//", "Length"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"from", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<from\>\"", ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"to", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<to\>\"", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[Rule]", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arra", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ">", "x"}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arraR", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<", 
                 RowBox[{"x", "+", 
                  RowBox[{"w", "[", "\"\<win\>\"", "]"}]}]}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"w", "[", "\"\<from\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<to\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<step\>\"", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wins", "[", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"wins", "[", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<averageY\>\""}], "}"}], 
          "]"}], "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"wins", "[", "  ", 
      RowBox[{
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "w"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"interp", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"`", "\n", "Partition", "\n", 
     RowBox[{
      StyleBox["(*", "Subsection"], 
      StyleBox[
       RowBox[{"interp", "[", 
        RowBox[{"<|", " ", 
         RowBox[{
          RowBox[{"\"\<from\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<to\>\"", "\[Rule]", "80"}], ",", " ", 
          RowBox[{"\"\<step\>\"", "\[Rule]", "1"}], ",", " ", 
          RowBox[{"\"\<win\>\"", "\[Rule]", "1"}]}], "|>"}], "]"}], 
       "Subsection"], 
      StyleBox["\[IndentingNewLine]", "Subsection"], 
      StyleBox["*)", "Subsection"]}], "\n", "\n", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"adaptive", " ", "window"}], " ", "*)"}], "Subsection"], 
     "\[IndentingNewLine]", 
     RowBox[{"adaptivewins", "[", 
      RowBox[{"arr_", ",", 
       RowBox[{"w_", "?", "AssociationQ"}]}], "]"}]}], ":=", " ", 
    RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"from", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<from\>\"", ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"to", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<to\>\"", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"arra", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], "//",
           "Normal"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"arraR", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], 
            ")"}], "//", "Reverse"}], "//", "Normal"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"le", "=", " ", 
         RowBox[{"arr", "//", "Length"}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aaa", ",", "win", ",", " ", "tarra", ",", " ", "tarraR"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"win", "=", 
            RowBox[{"w", "[", "\"\<win\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"aaa", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"arra", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"x", "-", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"arraR", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"x", "+", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tarra", "=", " ", 
            RowBox[{"arra", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"aaa", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ";;", 
               RowBox[{"aaa", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tarraR", " ", "=", " ", 
            RowBox[{"tarra", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"While", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ";;", 
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "All"}], 
                    "]"}], "]"}], "//", "ilinear"}], ")"}], "[", 
                "\"\<delta\>\"", "]"}], ">", 
               RowBox[{"w", "[", "\"\<delta\>\"", "]"}]}], " ", 
              "\[IndentingNewLine]", "&&", " ", 
              RowBox[{"win", ">", 
               RowBox[{"w", "[", "\"\<minwin\>\"", "]"}]}], 
              "\[IndentingNewLine]", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ">", "5"}]}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"win", "=", 
               RowBox[{"0.8", "win"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"aaa", "=", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SelectFirst", "[", 
                    RowBox[{"tarra", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"x", "-", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SelectFirst", "[", 
                    RowBox[{"tarraR", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"x", "+", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], 
                  "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"win", "\[Rule]", "aaa"}]}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "from", ",", " ", "to", ",", " ", 
          RowBox[{"w", "[", "\"\<step\>\"", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"adaptivewins", "[", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"adaptivewins", "[", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"awins", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", "\"\<averageX\>\"", "]"}], ",", " ", 
        RowBox[{"Keys", "[", "#", "]"}]}], "}"}], " ", "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"awins", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"awins", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ainterp", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<averageY\>\""}], "}"}], 
          "]"}], "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ainterp", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ainterp", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arunningslope", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<slope\>\""}], "}"}], "]"}], 
         "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arunningslope", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"arunningslope", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "simple", " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"wins", "[", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arra", "=", 
         RowBox[{
          RowBox[{"arr", "//", "toalist"}], "//", "Normal"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"arraR", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"arr", "//", "toalist"}], ")"}], "//", "Reverse"}], "//", 
          "Normal"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"le", "=", " ", 
         RowBox[{"arr", "//", "Length"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"from", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<from\>\"", ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"to", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<to\>\"", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[Rule]", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arra", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ">", "x"}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arraR", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<", 
                 RowBox[{"x", "+", 
                  RowBox[{"w", "[", "\"\<win\>\"", "]"}]}]}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"w", "[", "\"\<from\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<to\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<step\>\"", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wins", "[", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"wins", "[", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<averageY\>\""}], "}"}], 
          "]"}], "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"wins", "[", "  ", 
      RowBox[{
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "w"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"interp", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"adaptive", " ", "window"}], " ", "*)"}], "Subsection"], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"adaptivewins", "[", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"from", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<from\>\"", ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"to", "=", 
         RowBox[{"Lookup", "[", " ", 
          RowBox[{"w", ",", "\"\<to\>\"", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"arr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"arra", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"arr", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], "//",
           "Normal"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"arraR", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "toalist"}], 
            ")"}], "//", "Reverse"}], "//", "Normal"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"le", "=", " ", 
         RowBox[{"arr", "//", "Length"}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aaa", ",", "win", ",", " ", "tarra", ",", " ", "tarraR"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"win", "=", 
            RowBox[{"w", "[", "\"\<win\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"aaa", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"arra", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"x", "-", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"arraR", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"x", "+", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tarra", "=", " ", 
            RowBox[{"arra", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"aaa", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ";;", 
               RowBox[{"aaa", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tarraR", " ", "=", " ", 
            RowBox[{"tarra", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"While", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"arr", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ";;", 
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", "All"}], 
                    "]"}], "]"}], "//", "ilinear"}], ")"}], "[", 
                "\"\<delta\>\"", "]"}], ">", 
               RowBox[{"w", "[", "\"\<delta\>\"", "]"}]}], " ", 
              "\[IndentingNewLine]", "&&", " ", 
              RowBox[{"win", ">", 
               RowBox[{"w", "[", "\"\<minwin\>\"", "]"}]}], 
              "\[IndentingNewLine]", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"aaa", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ">", "5"}]}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"win", "=", 
               RowBox[{"0.8", "win"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"aaa", "=", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SelectFirst", "[", 
                    RowBox[{"tarra", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"x", "-", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SelectFirst", "[", 
                    RowBox[{"tarraR", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", 
                    RowBox[{"x", "+", 
                    RowBox[{"win", "/", "2"}]}]}], "&"}], " ", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], 
                  "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"win", "\[Rule]", "aaa"}]}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "from", ",", " ", "to", ",", " ", 
          RowBox[{"w", "[", "\"\<step\>\"", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"adaptivewins", "[", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"adaptivewins", "[", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"awins", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", "\"\<averageX\>\"", "]"}], ",", " ", 
        RowBox[{"Keys", "[", "#", "]"}]}], "}"}], " ", "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"awins", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"awins", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ainterp", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<averageY\>\""}], "}"}], 
          "]"}], "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ainterp", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ainterp", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arunningslope", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<slope\>\""}], "}"}], "]"}], 
         "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"adaptivewins", "[", "  ", 
      RowBox[{"arr", ",", "w"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arunningslope", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"arunningslope", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", "simple", " ", "*)"}], "Subsection"], 
   StyleBox[" ", "Subsection"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"wins", "[", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arra", "=", 
         RowBox[{
          RowBox[{"arr", "//", "toalist"}], "//", "Normal"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"arraR", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"arr", "//", "toalist"}], ")"}], "//", "Reverse"}], "//", 
          "Normal"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"le", "=", " ", 
         RowBox[{"arr", "//", "Length"}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[Rule]", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arra", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ">", "x"}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SelectFirst", "[", 
              RowBox[{"arraR", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<", 
                 RowBox[{"x", "+", 
                  RowBox[{"w", "[", "\"\<win\>\"", "]"}]}]}], "&"}], " ", ",",
                " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"w", "[", "\"\<from\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<to\>\"", "]"}], ",", " ", 
          RowBox[{"w", "[", "\"\<step\>\"", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wins", "[", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"wins", "[", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"arr_", ",", 
      RowBox[{"w_", "?", "AssociationQ"}]}], "]"}], ":=", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ilinear", "[", 
          RowBox[{"arr", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"Values", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "All"}], "]"}], "]"}], 
          " ", "]"}], "[", 
         RowBox[{"[", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<averageX\>\"", ",", "\"\<averageY\>\""}], "}"}], 
          "]"}], "]"}], "//", "Values"}], " ", ")"}], "&"}], "/@", "  ", 
     RowBox[{"wins", "[", "  ", 
      RowBox[{
       RowBox[{"arr", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "w"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interp", "[", " ", 
     RowBox[{"w_", "?", "AssociationQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"interp", "[", " ", 
      RowBox[{"#", ",", "w"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sort", "[", 
     RowBox[{
      RowBox[{"arr_", "?", "ArrayQ"}], ",", "f_"}], "]"}], ":=", " ", 
    RowBox[{"Sort", "[", 
     RowBox[{"arr", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sort", "[", "f_", "]"}], ":=", 
    RowBox[{
     RowBox[{"sort", "[", 
      RowBox[{"#", ",", "f"}], "]"}], "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\n", "*)"}]], "Input",
 CellChangeTimes->{{3.765743619538844*^9, 3.7657436197516003`*^9}, {
  3.7657436703051357`*^9, 
  3.7657436786408377`*^9}},ExpressionUUID->"701e225e-a28b-46bf-ba97-\
ae5b98f3eb23"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.7657436819465*^9},ExpressionUUID->"cded6635-2d4c-4735-a2f9-e8cb2415d09b"]
},
WindowSize->{1088, 927},
WindowMargins->{{Automatic, 121}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 607076, 15062, 45879, "Input",ExpressionUUID->"a9c360a9-843d-4043-9466-d09f6488a94e"],
Cell[607637, 15084, 37971, 965, 4714, "Input",ExpressionUUID->"701e225e-a28b-46bf-ba97-ae5b98f3eb23"],
Cell[645611, 16051, 125, 2, 30, "Input",ExpressionUUID->"cded6635-2d4c-4735-a2f9-e8cb2415d09b"]
}
]
*)

